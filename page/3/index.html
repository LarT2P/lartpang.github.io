<!DOCTYPE html>













<html class="theme-next muse" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">



  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-simple.min.css?v=1.0.2" rel="stylesheet">




  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="失乐园">
<meta property="og:url" content="https://plart.pw/page/3/index.html">
<meta property="og:site_name" content="失乐园">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="失乐园">



  <link rel="alternate" href="/atom.xml" title="失乐园" type="application/atom+xml">




  <link rel="canonical" href="https://plart.pw/page/3/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>失乐园</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">失乐园</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">代码与机器</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

    <a href="https://github.com/yourname" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck12/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck12/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck12</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:46:25" itemprop="dateModified" datetime="2018-07-13T20:46:25+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>unit analyzers </p>
<blockquote>
<p>new!!!</p>
</blockquote>
<pre><code>declaring
connecting
controlling over time
representing metadata: the UAnaBlob
representing complex data
performing analysis in UAna networks
using events
built-in unit analyzers
creating (coming soon) 
</code></pre><p>#Unit Analyzers<br>单元分析器</p>
<blockquote>
<p>Unit Analyzers (<strong>UAnae</strong>) are analyis building blocks, similar in concept to unit generators.They perform analysis functions on audio signals and/or metadata input, and produce metadata analysis results as output.<br>(对音频信号或者元数据输入进行分析，把元数据分析结果作为输出)<br>Unit analyzers can be linked together and with unit generators to form analysis/synthesis networks. Like unit generators, several unit analyzers may run concurrently, each dynamically(动态地) controlled at different rates. Because data passed between UAnae is not necessarily audio samples, and the relationship of UAna computation to time is fundamentally (根本地)different than that of UGens (e.g., UAnae might compute on blocks of samples, or on metadata), <em>the connections between UAnae have a different meaning from the connections between UGens formed with the ChucK operator, <code>=&gt;</code></em>. This difference is reflected in the choice of a new connection operator, the upChucK operator: <code>=^</code>. Another key difference between UGens and UAnae is that <strong>UAnae perform analysis (only) on demand, via the <code>upchuck()</code> function (see below).</strong></p>
</blockquote>
<p>Some more quick facts about ChucK unit analyzers:</p>
<ul>
<li>All ChucK unit analyzers are objects (not primitive(原始的) types). </li>
<li>All ChucK unit analyzers inherit(继承) from the <code>UAna</code> class.</li>
<li>The operation <code>foo =^ yah</code>, where foo and yah are UAnae, connects foo to yah.</li>
<li>Unit analyzer parameters(参数) and behaviors(行为) are controlled by calling / chucking to member functions over time, just like unit generators.</li>
<li>Analysis results are always stored in an object called a <code>UAnaBlob</code>. The <code>UAnaBlob</code> contains a time-stamp(时间标记) indicating(表明) when it was computed, and it may store an array(数组) of floats and/or complex(复杂的) values. <em>Each UAna specifies(指定) what information is present in the <code>UAnaBlob</code> it produces.</em>每个UAna指定它产生的UAnaBlob中的信息</li>
<li>All unit analyzers have the function <code>upchuck()</code>, which when called issues <em>a cascade of(一系列的) analysis computations for the unit analyzer and any “upstream(上游的)” unit analyzers on which its analysis depends.</em> (In the example of <code>foo =^ yah</code>,  <code>yah.upchuck()</code> will result in <code>foo</code> first performing its analysis (possibly requesting analysis results from unit analyzers <em>further upstream</em>), then <code>yah</code>, <em>using <code>foo</code>‘s analysis results in its computation</em>. <em><code>upchuck()</code> returns the analysis results in the form of a <code>UAnaBlob</code>.</em>)</li>
<li><p>Unit analyzers are specially integrated into the virtual(虚拟的) machine such that <em>each unit analyzer performs its analysis on its input whenever it or a downstream (下游的)<code>UAna</code> is <code>upchuck()</code>-ed.</em> Therefore, we have the ability to <em>assert(维护) control over the analysis process at any point in time and at any desired control rate</em>.</p>
<p>  <a href="http://chuck.cs.princeton.edu/doc/program/uana.html" target="_blank" rel="noopener">View a list</a> of ChucK’s built-in(嵌入的) unit analyzer(分解) classes </p>
</li>
</ul>
<p>#declaring</p>
<p><em>Unit analyzers (UAnae) are objects, and they need to be instantiated before they can be used.</em></p>
<p>单元分析器是对象，使用前需要实例化</p>
<p>We declare unit analyzers the same way we declare UGens and other objects.</p>
<pre><code>// instantiate an FFT, assign reference to variable f
FFT f;
</code></pre><p>#connecting</p>
<p>The upChucK operator (<code>=^</code>) is <em>only meaningful(有意义的) for unit analyzers</em>. Similar to the behavior(行为) of the ChucK operator between UGens, <strong>using <code>=^</code> to connect one UAna to another</strong> connects <strong>the analysis results of the first to the analysis input of the second</strong>. </p>
<pre><code>// instantiate FFT and flux objects, 
// connect to allow computation of spectrum(频谱) and spectral flux on adc input
adc =&gt; FFT fft =^ Flux flux =&gt; blackhole;
</code></pre><p><strong>Note</strong> that the last UAna in any chain must be chucked to the <code>blackhole</code> or <code>dac</code> <em>to “pull” audio samples from the <code>adc</code> or other unit generators upstream.</em></p>
<p>It is also possible to linearly(线性的) chain many UAnae together in a single statement(声明).<br>In the example below, the analysis of <code>flux_capacitor</code> depends on the results of <code>flux</code>, so the <code>flux</code> object will always perform its analysis computation before the computation of <code>flux_capacitor</code>.分析计算是先后执行的</p>
<pre><code>// Set up analysis on adc, via an FFT object, a spectral flux object, and a
// made-up object called a FluxCapacitor that operates on the flux value.
adc =&gt; FFT f =^ Flux flux =^ FluxCapacitor flux_capacitor =&gt; blackhole;
</code></pre><p><strong>Very importantly</strong>, it is possible to create connection networks containing both <code>UAane</code> and <code>UGens</code>.<br>In the example below, an <code>FFT</code> transforms(改变) two (added) sinusoidal(正弦曲线的) inputs, one of which has reverb(混响) added. An <code>IFFT</code> transforms the spectrum(频谱) back into the time domain(频域转换为时域), and the result is processed(处理) with a third sinusoid(正弦曲线) by a gain object before being played through the <code>dac</code>(被通过dac播放).<br>(No, this example is not supposed to do anything musically interesting, only help you get a feel for the syntax(语法).)<br><strong>Notice</strong> that any connection through which <em>audio samples are passed</em> is denoted(表示) with the <code>=&gt;</code> operator, and the connection through which <em>spectral data is passed (from the FFT to the IFFT)</em> is denoted with the <code>=^</code> operator.</p>
<pre><code>//Chain a sine into a reverb, then perform FFT, then IFFT, then apply gain, then output
SinOsc s =&gt; JCRev r =&gt; FFT f =^ IFFT i =&gt; Gain g =&gt; dac;
// Chuck a second sine into the FFT
SinOsc s2 =&gt; f;
// Chuck a third sine into the final gain
SinOsc s3 =&gt; g;
</code></pre><p><code>FFT</code>, <code>IFFT</code>, and other UAnae that perform transforms between the audio domain and another domain play a special role, as illustrated above(正如上文所述).</p>
<ul>
<li><code>FFT</code> takes audio samples(样品) as input, so unit generators connect to it with the ChucK operator <code>=&gt;</code>. </li>
<li>However, it outputs(输出) analysis results in the spectral domain, so it connects to other <em>UAnae</em> with the upChucK operator <code>=^</code>. </li>
<li>Conversely(相反的), UAnae producing spectral domain output connect to the <code>IFFT</code> using <code>=^</code>, and <code>IFFT</code> can connect to the <code>dac</code> or other <em>UGens</em> using <code>=&gt;</code>. </li>
</ul>
<p>This syntax(语法) allows the programmer to clearly reason about the expected behavior(行为) of <em>an analysis/synthesis(分析综合，分解重构) network</em>, while <strong>it hides the internal mechanics(内部机制) of ChucK timing and sample buffering from the programmer</strong>.</p>
<p>Finally, just as with unit generators, it is possible to dynamically (动态地)<strong>disconnect</strong> (拆开)unit analyzers, using the UnChucK operator (<code>=&lt;</code> or <code>!=&gt;</code>).</p>
<p>#controlling (over time)</p>
<p><strong>In any ChucK program, it is necessary to advance time in order to pull audio samples(样品) through the UGen network and create sound</strong>. Additionally(此外), <em>it is necessary to trigger(引发) analysis computations(计算) explicitly(显式地) in order for any analysis to be performed</em>, and for sound synthesis(合成) that depends on analysis results (e.g., <code>IFFT</code>) to be performed.<br>To explicitly trigger computation at a point in time, the UAna’s <code>upchuck()</code> member function is called. </p>
<p><code>upchuck()</code>：显式引发计算</p>
<p>In the example below, an FFT computation is triggered(引发) <em>every 1024 samples</em>.</p>
<pre><code>adc =&gt; FFT fft =&gt; dac;
// set the FFT to be of of size 2048 samples
2048 =&gt; fft.size;

while (true) {
// let 1024 samples pass
1024::samp =&gt; now;
// trigger the FFT computation on the last 2048 samples (the FFT size)
fft.upchuck();
}
</code></pre><p>In the example above, because the <code>FFT</code> size is 2048 samples, the while-loop causes a standard “sliding-window(滑动窗)” <code>FFT</code> to be computed, where the hop size(步进值) is equal to half a window.<br>However, ChucK allows you to perform analysis using nonstandard, dynamically(动态地) set, or even multiple hop sizes with the same object. 非标准的动态设定或者甚至多倍的步进大小<br>For example, in the code below, the <code>FFT</code> object <code>fft</code> performs computation every 5 seconds as triggered by <code>shred1</code>, and it additionally performs computation at a variable(可变的) rate as triggered by <code>shred2</code>.</p>
<pre><code>adc =&gt; FFT fft =&gt; dac;
2048 =&gt; fft.size;

// spork two shreds: shred1 and shred2
spork ~shred1();
spork ~shred2(); 

// shred1 computes FFT every 5 seconds
fun void shred1() {
    while (true) {
    5::second =&gt; now;
    fft.upchuck();
    }
}

// shred2 computes FFT every n seconds, where n is a random number between 1 and 10
fun void shred2() {
    while (true) {
    Std.rand2f(1, 10)::second =&gt; now;
    fft.upchuck();
    }
}
</code></pre><p>Parameters(参数) of unit analyzers may be controlled and altered at any point in time and at any control rate. We only have to assert(维护) control at the appropriate(适当的) points as we move through time, by setting various parameters of the unit analyzer.<br><em>To set the a value for a parameter of a <code>UAna</code>, a value of the proper type should be ChucKed to the corresponding control function.</em></p>
<pre><code>// connect the input to an FFT
adc =&gt; FFT fft =&gt; blackhole;

//start with a size of 1024 and a Blackman-Harris window
1024 =&gt; fft.size;
Windowing.blackmanHarris(512) =&gt; fft.window;

//advance time and compute FFT
1::minute =&gt; now;
fft.upchuck();

// change window to Hamming
Windowing.hamming(512) =&gt; fft.window;

// let time pass... and carry on.
</code></pre><p><em>Since the control functions are member functions of the unit analyzer, the above syntax(语法) is equilavent to calling functions.</em> For example, the line below could <strong>alternatively(作为选择)</strong> be used to change the FFT window to a Hamming window, as above.</p>
<pre><code>fft.window(Windowing.hamming(512));
</code></pre><p>For a list of unit analyzers and their control methods, consult(查阅) <a href="http://chuck.cs.princeton.edu/doc/program/uana.html" target="_blank" rel="noopener">UAna reference</a>.</p>
<p>Just like unit generators, to read the current value of certain parameters of a <code>Uana</code>, we may call an overloaded function of the same name.就像单元发生器，读取当前Uana的某个参数的值，可以调用重载的同名函数<br>Additionally, assignments(分配) can be chained together when assigning(分配) one value to multiple targets.给多的目标分配一个值时，可以串联起来</p>
<pre><code>// connect adc to FFT
adc =&gt; FFT fft =&gt; blackhole;

// store the current value of the FFT size
fft.size() =&gt; int fft_size;
</code></pre><p>What if a <code>UAna</code> that performs analysis on a group of audio samples(样品) is <code>upchuck()</code>-ed before its internal(内部的) buffer(缓冲区) is filled? This is possible if an FFT of size 1024 is instantiated(实例化), then <code>upchuck()</code>-ed after only 1000 samples, for example. In this case, the empty buffer slots(位置) are treated as 0’s (that is, zero-padding(补零) is applied空的缓存区会被置零). This same behavior(行为) will occur if the FFT object’s size is increased from 1024 to 2048, and then only 1023 samples pass after this change is applied; the last sample in the new (larger) buffer will be 0. <em>Keep in mind</em>, then, that certain analysis computations near the beginning of time and analysis computations after certain parameters(参数) have changed will logically(逻辑上) involve(包含) a short “transient(短暂的)” period.</p>
<pre><code>// connect adc to FFT to blackhole
adc =&gt; FFT fft =&gt; blackhole;
// set the FFT size to 1024 samples
1024 =&gt; fft.size;

// allow 1000 samples to pass
1000::samp =&gt; now;

// compute the FFT: the last 24 spots in the FFT buffer haven&apos;t been filled, so they are zero-ed out归零，置零
// the computation is nevertheless valid and proceeds.计算仍然是有效又有收益的。
fft.upchuck(); 

1::minute =&gt; now; // let time pass for a while

// increase the size of the FFT, and therefore the size of the sample buffer it uses
2048 =&gt; fft.size;

// let 1023 samples pass 
// 会填满1023个缓存点
1023::samp =&gt; now;

// at this point, only 2047 of the 2048 buffer spots have been filled
// 这处，2048中只有2047个缓存位置被填满——怎么算的？1000+24+1023
// the following computation therefore zeros out the last audio buffer spot
// 此句置零了最后一个音频缓存点
fft.upchuck();

1::minute =&gt; now; //let time pass for a while

// now the buffer is happy and full
fft.upchuck(); // proceeds normally on a full buffer
</code></pre><p>#representing metadata: the <code>UAnaBlob</code></p>
<p>It is great to be able to trigger(引发) analysis computations like we’ve been doing above, but what if you want to actually <em>use</em> the analysis results? Luckily, calling the <code>upchuck()</code> function on a <code>UAna</code> returns a reference to <em>an object that stores the results of any <code>UAna</code> analysis</em>, called a <code>UanaBlob</code>. <code>UanaBlob</code>s can contain <strong>an array of floats</strong>, and/or <strong>an array of complex numbers</strong> (see the next section). The meaning and formatting(格式化) of the <code>UanaBlob</code> fields(字段) is different for each <code>UAna</code> subtype(子类型). <code>FFT</code>, for example (see <a href="chuck.cs.princeton.edu/doc/program/uana_full.html#FFT">specification</a>), fills in the complex array with the spectrum(频谱的复数数组) and the floating point array with the magnitude spectrum(振幅谱的浮点数组). Additionally, all <code>UanaBlob</code>s store the time when the <code>blob</code> was last computed.</p>
<p>The example below demonstrates(证明) how one might access(访问) the results of an FFT:</p>
<pre><code>adc =&gt; FFT fft =&gt; blackhole;
// ... set FFT parameters here ...

UAnaBlob blob;

while (true) {
    500::ms =&gt; now; // use hop size of 50 ms
    fft.upchuck() @=&gt; blob; // `store` the result in blob.
    blob.fvals() @=&gt; float mag_spec[]; // get the magnitude spectrum as float array
    blob.cvals() @=&gt; complex spec[]; // get the whole spectrum as complex array
    // get `the first bin`(这个指什么？？？) of the magnitude spectrum
    mag_spec[0] =&gt; float first_mag; 
    blob.fval(0) =&gt; float first_mag2; // equivalent way to get first bin of mag spectrum
    fft.upchuck().fval(0) =&gt; float first_mag3; // yet another equivalent way

    fft.upchuck().cval(0) =&gt; complex first_spec; // similarly, get 1st spectrum bin

    blob.when() =&gt; time when_computed; // get the time it was computed
} 
</code></pre><p><strong>Beware</strong>: whenever a <code>UAna</code> is <code>upchuck()</code>-ed, the contents of its previous <code>UAnaBlob</code> are overwritten.<br>In the following code, <code>blob1</code> and <code>blob2</code> refer to <em>the same <code>UAnaBlob</code></em>. When <code>fft.upchuck()</code> is called the second time, the contents of the <code>UAnaBlob</code> referred to by <code>blob1</code> are overwritten.</p>
<pre><code>adc =&gt; FFT fft =&gt; blackhole;

UAnaBlob blob1, blob2;
1::minute =&gt; now; //let time pass for a while
fft.upchuck() @=&gt; blob1; // blob1 points to `the analysis results`
1::minute =&gt; now; // let time pass again
fft.upchuck() @=&gt; blob2; 
// now both blob1 and blob2 refer to the same object: **the new results!**
</code></pre><p>Also <strong>beware</strong>: if time is not advanced between subsequent(后来的) <code>upchuck()</code>s of a <code>UAna</code>, any <code>upchuck()</code> after the first <em>will not re-compute the analysis</em>, even if <code>UAna</code> parameters have been changed.<br>After the code below, <code>blob</code> refers to a <code>UAnaBlob</code> that is the result of computing the first (size 1024) FFT.指向第一次计算的结果的UAnaBlob</p>
<pre><code>adc =&gt; FFT fft =&gt; blackhole;
1024 =&gt; fft.size;

UAnaBlob blob;
1::minute =&gt; now; //let time pass for a while
fft.upchuck() @=&gt; blob; // blob holds the result of the FFT

512 =&gt; fft.size;
fft.upchuck() @=&gt; blob; 
// time hasn&apos;t advanced since the last computation, so no re-computation is done
</code></pre><p>#representing complex data: the complex and polar types</p>
<p>In order to represent complex data, such as the output of an <code>FFT</code>, two new datatypes have been added to ChucK: complex and polar.</p>
<p>#performing analysis in UAna networks</p>
<p>Often, the computation of one <code>UAna</code> will depend on the computation results of “upstream” <code>UAnae</code>. For example, in the UAna network below, the spectral flux(频谱流量) is computed using the results of an <code>FFT</code>.</p>
<pre><code>adc =&gt; FFT fft =^ Flux flux =&gt; blackhole;
</code></pre><p>The flow of computation in <code>UAna</code> networks is set up(设置) so that every time a <code>UAna</code> <code>a</code> is <code>upchuck()</code>-ed, each <code>UAna</code> whose output is connected to <code>a</code>‘s input via <code>=^</code> is <code>upchuck()</code>-ed first, passing the results to <code>a</code> for it to use.<br>For example, a call to <code>flux.upchuck()</code> will first force <code>fft</code> to compute an FFT on the audio samples in its buffer,<br>then <code>flux</code> will use the <code>UanaBlob</code> from <code>fft</code> to compute the spectral flux.<br>This flow of computation is handled <em>internally by ChucK</em>; you should understand the flow of control, but you don’t need to do <code>fft.upchuck()</code> explicitly. Just writing code like that below will do the trick:</p>
<pre><code>adc =&gt; FFT fft =^ Flux flux =&gt; blackhole;
UAnaBlob blob;
while (true) {
    100::ms =&gt; now;
    flux.upchuck() @=&gt; blob; // causes fft to compute, then computes flux and stores result in blob
}
</code></pre><p>Additionally, each time a <code>UAna</code> <code>upchuck()</code>s, its results are cached(缓存) until time passes. <em>This means that a <code>UAna</code> will only perform its computation once for a particular point in time.</em></p>
<pre><code>adc =&gt; FFT fft =^ Flux flux =&gt; blackhole;
fft =^ Centroid c =&gt; blackhole;

UAnaBlob blob, blob2;
while (true) {
    100::ms =&gt; now;
    flux.upchuck() @=&gt; blob; // causes fft to compute, then computes flux and stores result in blob
    c.upchuck() @=&gt; blob2; // uses cached fft results from previous line to compute centroid
}
</code></pre><p><em>When no <code>upchuck()</code> is performed on a <code>UAna</code>, or on <code>UAnae</code> that depend on it</em>, it will not do computation. For example, in the network below, the flux is never computed.</p>
<pre><code>adc =&gt; FFT fft =^ Flux flux =&gt; blackhole;
UAnaBlob blob;
while (true) {
    100::ms =&gt; now;
    fft.upchuck() @=&gt; blob; // compute fft only
}
</code></pre><p>The combination of  this “compute-on-demand” behavior(这种按需计算行为的组合) and <code>UAna</code> caching means that different <code>UAnae</code> in a network can be <code>upchuck()</code>-ed at various/varying control rates, with maximum efficiency. In the example below, the <code>FFT</code>, <code>centroid</code>, and <code>flux</code> are all <em>computed at different rates</em>. When the analysis times for <code>flux</code> and <code>fft</code> or <code>centroid</code> and <code>fft</code> overlap(同时发生), <code>fft</code> is computed <em>just once</em> due to its <em>internal caching</em>.<br>When it is an analysis time point for <code>fft</code> but not for <code>flux</code>, <code>flux</code> will not be computed.</p>
<pre><code>adc =&gt; FFT fft =^ Flux flux =&gt; blackhole;
fft =^ Centroid c =&gt; blackhole;
UAnaBlob blob1, blob2, blob3;

spork ~do_fft();
spork ~do_flux();
spork ~do_centroid();

while (true) {
    //Keep parent shred going
    1::minute =&gt; now;
    //感觉是多进程必要的一段代码
}

fun void do_fft() {
    while (true) {
        50::ms =&gt; now;
        fft.upchuck() @=&gt; blob1;
    }
}

fun void do_flux() {
    while (true) {
        110::ms =&gt; now;
        flux.upchuck() @=&gt; blob2;
    }
}

fun void do_centroid() {
    while (true) {
        250::ms =&gt; now;
        c.upchuck() @=&gt; blob3;
    }
}
</code></pre><p>An easy way to synchronize analysis of many <code>UAnae</code> is to <code>upchuck()</code> an “agglomerator(凝聚剂)” <code>UAna</code>.<br>In the example below, <code>agglom.upchuck()</code> triggers analysis of <em>all upstream UAnae</em> in the network.<br>Because <code>agglom</code> is only a member of the <code>UAna</code> base class, it does no computation of its own.<br>However, after <code>agglom.upchuck()</code>, all other <code>UAnae</code> will have up-to-date <em>results that are synchronized, computed, and cached</em> so that they are available to be accessed via <code>upchuck()</code> on each <code>UAna</code> (possibly by <em>a different shred</em> waiting for an event– see below).</p>
<pre><code>adc =&gt; FFT fft =^ Flux flux =^ UAna agglom =&gt; blackhole;
fft =^ Centroid centroid =^ agglom;
// could add arbitrarily(反复地) many more UAnae that connect to agglom via =^

while (true) {
100::ms =&gt; now;
    agglom.upchuck(); // forces computation of both centroid and flux (and therefore fft, too)
}
</code></pre><p><em>Because of the dependency and caching behavior of <code>upchuck()</code>-ing in <code>UAna</code> networks, <code>UAna</code> feedback loops should be used with caution</em>. In the network below, each time <code>c</code> is <code>upchuck()</code>-ed, it forces <code>b</code> to compute, which forces <code>a</code> to compute, which then recognizes that <code>b</code> has been traversed(遍历) in this upChucK path but has not been able to complete its computation– thereby(因此) recognizing <code>a</code> loop in the network.<br><code>a</code> then uses <code>b</code>‘s <em>last computed</em> <code>UAnaBlob</code> to perform its computation.<br>This may or may not be desirable, so be careful.可能不理想</p>
<pre><code>adc =&gt; UAna a =^ UAna b =^ Uana c =&gt; blackhole;
b =^ a; // creates a feedback loop

while (true) {
    100::ms =&gt; now;
    c.upchuck(); // involves a using b&apos;s analysis results from 100 ms ago
}
</code></pre><p>Another handy(方便的) UAna for synchronizing feature extraction(同步特征提取) is the <code>FeatureCollector</code>. Calling <code>upchuck()</code> on a <code>FeatureCollector</code> triggers computation of all upstream UAnae, and it concatenates(连接) their output blob data(BLOB二进制大数据) into a feature vector that can be used as input to a classifier(分类器), for example using <a href="http://smirk.cs.princeton.edu/" target="_blank" rel="noopener">smirk</a>.</p>
<pre><code>adc =&gt; FFT fft =^ Flux flux =^ FeatureCollector fc =&gt; blackhole;
fft =^ Centroid centroid =^ fc;
// could add abitrarily many more UAnae that connect to fc via =^

while (true) {
    100::ms =&gt; now;
    // forces computation of both centroid and flux (and therefore fft, too)
    // an vectorBlob&apos;s fvals and cvals will be a concatenation(连接) of the feature values
    fc.upchuck() @=&gt; UAnaBlob vectorBlob; 
}
</code></pre><p>#built-in unit analyzers</p>
<p>ChucK has a number of built-in UAna classes. These classes perform many basic transform(变换) functions (FFT, IFFT) and feature extraction(特征提取) methods (both spectral and time-domain features(频域时域特征)). A list of built-in ChucK <em>unit analyzers</em> can be found <a href="http://chuck.cs.princeton.edu/doc/program/uana.html" target="_blank" rel="noopener">here</a>.</p>
<p>#creating</p>
<p>( someday soon you will be able to implement your own unit analyzers! )<br>单元分析器的个人实现</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck6/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck6/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck6</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:46:56" itemprop="dateModified" datetime="2018-07-13T20:46:56+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>control structures</p>
<ul>
<li>if / else</li>
<li>while &amp; do…while…</li>
<li>until</li>
<li>for</li>
<li>break / continue</li>
</ul>
<p>#Control Structures</p>
<p>ChucK includes standard control structures similar to those in most programming languages. A condition (of type ‘int’) is evaluated and then a proceeding block is potentially executed. Blocks are separated either by semicolons(分号) or by curly brackets(花括号). </p>
<p>#if / else</p>
<p>The if statement executes a block if the condition is evaluated as <em>non-zero</em>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( condition )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// insert code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the above code, condition is any expression that evaluates to an int. (条件是一个值为整数的表达式)</p>
<p>The else statement(声明) can be put after the if block to handle the case where the condition evaluates(求值) to 0.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( condition )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// your code here</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// your other code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If statements can be nested(嵌套).</p>
<p>#while &amp; do…while…</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// here is an infinite loop</span></span><br><span class="line"><span class="keyword">while</span>( <span class="literal">true</span> )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// your code loops forever!</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// (sometimes this is desirable because we can create</span></span><br><span class="line">    <span class="comment">// infinite time loops this way, and because we have</span></span><br><span class="line">    <span class="comment">// concurrency)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="comment">// your code executes here at least once</span></span><br><span class="line">&#125; <span class="keyword">while</span>( condition );</span><br></pre></td></tr></table></figure>
<p>A few more points:</p>
<ul>
<li><code>while</code> statements can be nested.</li>
<li>see <code>break/continue</code> for additional(附加的) control over your loops </li>
</ul>
<p>#until</p>
<p>The until statement is the opposite of while, semantically(语义地). A until loop repeatedly executes the body until the condition evaluates as non-zero.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// an infinite loop</span></span><br><span class="line">until( <span class="literal">false</span> )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// your great code loops forever!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A few more points:</p>
<ul>
<li><code>while</code> statements can be nested.</li>
<li>see <code>break/continue</code> for additional(附加的) control over your loops </li>
</ul>
<p>#for</p>
<p>A loop that iterates(迭代) a given number of times.(迭代给定次数) A temporary(暂时的) variable(变量) is declared that keeps track(跟踪) of the current index and is evaluated and incremented at each iteration(迭代).</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// for loop</span></span><br><span class="line"><span class="keyword">for</span>( <span class="number">0</span> =&gt; <span class="keyword">int</span> foo; foo &lt; <span class="number">4</span> ; foo++ )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// debug-print value of 'foo'</span></span><br><span class="line">    &lt;&lt;&lt;foo&gt;&gt;&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>#break / continue</p>
<p><code>Break</code> allows the program flow to jump out of a loop.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// infinite loop</span></span><br><span class="line"><span class="keyword">while</span>( <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>( condition ) </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Continue</code> allows a loop to continue looping but not to execute(实行) the rest of the block for the iteration where continue was executed.(跳过当前的循环)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// another infinite loop</span></span><br><span class="line"><span class="keyword">while</span>( <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// check condition</span></span><br><span class="line">    <span class="keyword">if</span>( condition )</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// some great code that may get skipped (if continue is taken)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck3/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck3/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck3</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:46:41" itemprop="dateModified" datetime="2018-07-13T20:46:41+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>#Types, Values, and Variables(变量)</p>
<p>ChucK is a strongly-typed language, meaning that types <em>are resolved(决定) at compile-time</em>. However, it is not quite statically-typed, because <strong>the compiler/type system is a part of the ChucK virtual(虚拟的) machine, and is a runtime component(成分)</strong>. This type system helps to impose(强加) precision(精度) and clarity(清楚) in the code, and naturally lends to organization of complex(复杂的) programs. At the same time, it is also <em>dynamic</em> in that changes to the type system can take place (in a well-defined(定义明确的) manner) at runtime. This dynamic(动态的) aspect(方面) forms the basis(基础) for <a href="http://on-the-fly.cs.princeton.edu/" target="_blank" rel="noopener">on-the-fly programming</a>. </p>
<p>This section deals with <em>types, values, and the declaration(声明) and usage(使用) of variables</em>. As in other strongly-typed programming languages, we can think of a type as associated(关联的) behaviors(行为) of data. (For example, an ‘int’ is a type that means integer(整数), and adding two integer is defined(定义) to produce a third integer representing the sum.) <em>Classes and objects</em> allow us to extend(延伸) the type system with our own custom types, but we won’t cover them in this section. <strong>We will focus mainly on <em>primitive(原始的) types</em> here, and leave the discussion of more complex types for <a href="http://chuck.cs.princeton.edu/doc/language/class.html" target="_blank" rel="noopener">classes and objects</a>.</strong></p>
<p>#primitive types(原始类型)</p>
<p>The primitive(原始的), or intrinsic(本质的) types are those which are simple datatypes (they have no additional(附加的) data attributes(属性)). <em>Objects are not primitive types.</em> <strong>Primitive types are passed by value. Primitive types cannot be extended(延伸).</strong> The primitive types in ChucK are:</p>
<pre><code>int : integer(整数) (signed)
float : floating point number (in ChucK, a float is by default double-precision(双精度))
time : ChucKian time
dur : ChucKian duration(持续)
void : (no type)
complex : complex number in rectangular(矩形的) form a + bi (see [below][1])
polar: complex number in polar(极面) form (see [below][1])
</code></pre><p>For a summary of operations on these types, go to <a href="http://chuck.cs.princeton.edu/doc/language/oper.html" target="_blank" rel="noopener">operations and operators</a>.</p>
<p>All other types are derived(派生) from ‘object’, either as part of the ChucK standard library, or as a new class that you create. For specification(规格), go to <a href="http://chuck.cs.princeton.edu/doc/language/class.html" target="_blank" rel="noopener">classes and objects</a>.</p>
<p>#values (literals(字面值))</p>
<p>Literal values are specified(指定) explicitly(明确地) in code and are assigned(分配) a type by the compiler(编译器).The following are some examples of literal values:</p>
<pre><code>int:

42

int (hexidecimal):

0xaf30

float:

1.323

dur:

5.5::second
//In the above code, second is an existing duration(持续) variable(变量). 
//For more on durations, see the [manipulating time(时间调节)][4] section. 
</code></pre><p>#variables</p>
<p><strong>Variables(变量) are locations in memory that hold data.</strong> <em>Variables have to be declared in ChucK before they are used.</em> For example, to declare a variable of type int called foo:</p>
<pre><code>// declare an &apos;int&apos; called &apos;foo&apos;
int foo;
</code></pre><p>We can assign(分配) a value to <em>an existing variable</em> by using the ChucK operator (<code>=&gt;</code>). This is one of the most commonly used operators in ChucK, it’s the way to do work and take action! (后面会讨论)</p>
<pre><code>// assign value of 2 to &apos;foo&apos;
2 =&gt; foo;
</code></pre><p>It is possible to combine the two statements(声明) into one:</p>
<pre><code>// assign 2 to a new variable &apos;foo&apos; of type &apos;int&apos;
2 =&gt; int foo;
</code></pre><p>To use a variable, just refer to it by name:</p>
<pre><code>// debug-print the value of foo
&lt;&lt;&lt; foo &gt;&gt;&gt;;
</code></pre><p>To update the value of foo, for example:</p>
<pre><code>// multiply &apos;foo&apos; by 10, assign back to &apos;foo&apos;
foo * 10 =&gt; foo;
</code></pre><p>You can also do the above using a <code>*=&gt;</code> (mult-chuck):</p>
<pre><code>// multiply &apos;foo&apos; by 10, and then assign to &apos;foo&apos;
10 *=&gt; foo;
</code></pre><p>Here is an example of a duration(持续):</p>
<pre><code>// assign value of &apos;5 seconds&apos; to new variable bar
5::second =&gt; dur bar;
</code></pre><p>Once you have bar, you can inductively(归纳的) use it to construct new durations:</p>
<pre><code>// 4 bar, a measure?
4::bar =&gt; dur measure;
</code></pre><blockquote>
<p>输出：<br>C:\Users\abc1\Desktop&gt;chuck test.ck<br>882000.000000 :(dur)</p>
</blockquote>
<p>Since time is central to programming ChucK, it is important to understand time, dur, the relationship and operations between them. There is more information in the <a href="http://chuck.cs.princeton.edu/doc/language/time.html" target="_blank" rel="noopener">manipulating time</a> section. </p>
<p>#reference types(引用类型)</p>
<p>Reference(参考) types are types which inherit(继承) from the object class. Some default reference types include:</p>
<pre><code>Object : base type that all classes inherit from (directly or indirectly)所有类继承的基本类型
array : N-dimensional ordered(有序的) set of data (of the same type)
Event : fundamental(基本的), extendable(可扩展的), synchronization(同步) mechanism(机制)
UGen : extendable unit generator(单元发生器) base class (U = unit, Gen = generator)
string : string (of characters)
</code></pre><p>New classes can be created. <strong>All classes are reference types.</strong> We will leave the full discussion to the <a href="http://chuck.cs.princeton.edu/doc/language/class.html" target="_blank" rel="noopener">objects and classes</a> section.</p>
<p>#complex types<br>(虚数：直角坐标系，极坐标系)</p>
<p>Two special <code>primitive types</code> are available to to represent complex (复杂的)data, such as the output (输出)of an FFT: complex and polar. A complex number of the form a + bi can be declared as</p>
<pre><code>#(2,3) =&gt; complex cmp; //cmp is now 2 + 3i 
</code></pre><p>where the #(…) syntax(语法) explicitly(明确地) denotes(表示) a complex number in rectangular form(矩形). Similarly, explicit complex numbers can be manipulated(操纵) directly:</p>
<pre><code>#(5, -1.5) =&gt; complex cmp; // cmp is 5 - 1.5i
#(2,3) + #(5,6) + cmp =&gt; complex sum; // sum is now 12 + 7.5i
</code></pre><p>The (floating point) real and imaginary parts(实虚部) of a complex number can be accessed(存取) with the .re and .im components of a complex number:</p>
<pre><code>#(2.0,3.5) =&gt; complex cmp;
cmp.re =&gt; float x; // x is 2.0
cmp.im =&gt; float y; //y is 3.5
</code></pre><p>The polar type(极坐标) offers an equivalent(等价的), alternative(供选择的) representation(表示) of complex numbers in terms of a magnitude(大小) and phase(相) value. A polar representation of a complex number can be declared as</p>
<pre><code>%(2, .5*pi) =&gt; polar pol; // pol is 2∠.5π(没有想到，竟然有这个(●&apos;◡&apos;●))
</code></pre><p>The magnitude(大小) and phase(相) values can be accessed via .mag and .phase:</p>
<pre><code>%(2, .5*pi) =&gt; polar pol;
pol.mag =&gt; float m; // m is 2
pol.phase =&gt; float p; //p is .5π
</code></pre><p>polar and complex representations(代表) can be cast to each other and multiplied/added/assigned(分配)/etc.:</p>
<pre><code>%(2, .5*pi) =&gt; polar pol;
#(3, 4) =&gt; complex cmp;
pol $ complex + #(10, 3) + cmp =&gt; complex cmp2;
cmp $ polar + %(10, .25*pi) - pol =&gt; polar pol2;
</code></pre><p>(这里的$实现了两种坐标系下表示的转换)</p>
<blockquote>
<p>输出：<br>C:\Users\abc1\Desktop&gt;chuck test.ck<br>%(2.0000,0.5000<em>pi) :(polar)<br>#(3.0000,4.0000) :(complex)<br>#(13.0000,9.0000) :(complex)<br>%(13.5540,0.2334</em>pi) :(polar)</p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck9/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck9/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck9</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:48:57" itemprop="dateModified" datetime="2018-07-13T20:48:57+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>concurrency, processes, shreds</p>
<pre><code>sporking shreds
the &apos;me&apos; keyword
using machine.add()
inter-shred communication 
</code></pre><p>#Concurrency &amp; Shreds</p>
<p>…is able to run many processes concurrently…</p>
<p><strong>A ChucKian process is called a shred.</strong> To <em>spork</em> a shred means <strong>creating and adding a new process to the virtual(虚拟的) machine</strong>. Shreds may be sporked from a variety of places(各种各样的地方), and may themselves spork new shreds.</p>
<p>(直接代换理解：spork a shred == creating &amp; adding a process)</p>
<blockquote>
<p>ChucK supports sample-synchronous(采样同步), non-preemptive concurrency(非抢占式并发). Via the timing mechanism(机制). any number of programs/shreds can be automatically(自动的) <em>shreduled</em>(往后看，便于理解，实际上就是创建添加的过程，感觉就像是shred动作化了) and synchronized(同步的) use the timing information.A <em>shreduler</em> in the virtual(虚拟的) machine does the <em>shreduling</em>. The concurrency(并发性) is ‘sample-synchronous’, meaning that inter-process audio timing is guaranteed(保证) to be precise(精确的) to the sample(样品). <strong>Note</strong> that each process/shred does not necessarily need to know about each other - it only has to deal with time locally. The virtual machine will make sure things happen correctly “across the board(全体，全面)”. Finally, concurrency - like timing - is deterministic(确定性的) in ChucK. </p>
</blockquote>
<p>The simplest way to to run shreds concurrently is to specify(指定) them on the command line:</p>
<pre><code>chuck foo.ck bar.ck boo.ck
</code></pre><p>The above command runs chuck on foo.ck, bar.ck, and boo.ck concurrently. There are other ways to run shreds concurrently (see <a href="http://chuck.cs.princeton.edu/doc/program/otfp.html" target="_blank" rel="noopener">on-the-fly programming commands</a>). Next, we show how to create new shreds from within ChucK programs.</p>
<p>#sporking shreds (in code)</p>
<p>To <em>spork</em> means to <em>shredule a new shred.</em></p>
<p>To spork a shred, use the <em>spork</em> keyword/operator:</p>
<ul>
<li><em>spork</em> dynamically(动态地) sporks shred from a function call从函数调用中动态创建进程</li>
<li>this operation is sample-synchronous, the new shred is shreduled to execute(执行) immediately新进程创建来立即执行</li>
<li>the parent shred continues to execute, until time is advanced (see manipulating time) or until the parent explicitly(显式地) yields(产生) (see next section).父进程继续执行，直到时间被推进或者直到父进程显示产生。</li>
<li>in the current implementation(实现), when a parent shred exits, all child shreds all exit (this behavior(行为) will be enhanced(提高) in the future.)在当前实现中，当父进程退出，所有的子进程会退出。</li>
<li><em>sporking</em> a functions returns reference to the new shred, <strong>note</strong> that this operation does not return what functions returns - <em>the ability to get back the return value at some later point in time will be provided in a future release.</em>产生一个函数返回新进程的引用，注意这个操作不会返回函数返回值-返回在某个靠后的时间点上的返回值的能力就被在未来的版本中提供。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define function go()</span></span><br><span class="line"><span class="function">fun <span class="keyword">void</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// insert code</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// spork a new shred to start running from go()</span></span><br><span class="line">spork ~ go();</span><br><span class="line"></span><br><span class="line"><span class="comment">// spork another, store reference to new shred in offspring</span></span><br><span class="line">spork ~ go() =&gt; Shred @ offspring;</span><br></pre></td></tr></table></figure>
<p>a slightly longer example:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define function</span></span><br><span class="line"><span class="function">fun <span class="keyword">void</span> <span class="title">foo</span><span class="params">( <span class="built_in">string</span> s )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// infinite time loop</span></span><br><span class="line">   <span class="keyword">while</span>( <span class="literal">true</span> )</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="comment">// print s</span></span><br><span class="line">       &lt;&lt;&lt; s &gt;&gt;&gt;;</span><br><span class="line">       <span class="comment">// advance time</span></span><br><span class="line">       <span class="number">5</span>::second =&gt; now;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// spork shred, passing in "you" as argument to foo</span></span><br><span class="line">spork ~ foo( <span class="string">"you"</span> );</span><br><span class="line"><span class="comment">// advance time by 250 ms</span></span><br><span class="line"><span class="number">2</span>::second =&gt; now;</span><br><span class="line"><span class="comment">// spork another shred</span></span><br><span class="line">spork ~ foo( <span class="string">"me"</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">// infinite time loop - to keep child shreds around</span></span><br><span class="line"><span class="keyword">while</span>( <span class="literal">true</span> )</span><br><span class="line">    <span class="number">1</span>::second =&gt; now;</span><br><span class="line"></span><br><span class="line"><span class="comment">//测量：</span></span><br><span class="line"><span class="comment">//输出you后，第2s输出me，第5s再次输出</span></span><br></pre></td></tr></table></figure>
<pre><code>两个进程互有交错，&quot;you&quot;先输出，&quot;me&quot;后输出，循环输出。

个人理解：
`1::second =&gt; now;`感觉上就像是将进程挂起，sleep()的感觉
就像是1s后再跳到这个程序
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">you-&gt;me:2s</span><br><span class="line">me-&gt;you:3s</span><br></pre></td></tr></table></figure>
<p>#the ‘me’ keyword</p>
<p>The <code>me</code> keyword (type <code>Shred</code>) refers the current shred. </p>
<p>Sometimes it is useful to suspend(暂停) the current shred without advancing time, and let other shreds shreduled for the current time to execute(实行). <code>me.yield()</code> does exactly that. <strong>This is often useful immediately after sporking a new shred, and you would like for that shred to have a chance to run but you do not want to advance time yet for yourself.</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// spork shred</span></span><br><span class="line">spork ~ go();</span><br><span class="line"></span><br><span class="line"><span class="comment">// suspend the current shred ...</span></span><br><span class="line"><span class="comment">// ... give other shreds (shreduled for 'now') a chance to run</span></span><br><span class="line">me.yield();</span><br></pre></td></tr></table></figure>
<p>It may also be useful to exit the current shred. For example if a MIDI device(装置) fails to open, you may exit the current shred.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// make a MidiIn object</span></span><br><span class="line">MidiIn min;</span><br><span class="line"></span><br><span class="line"><span class="comment">// try to open device 0 (chuck --probe to list all device)</span></span><br><span class="line"><span class="keyword">if</span>( !min.open( <span class="number">0</span> ) )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// print error message</span></span><br><span class="line">    &lt;&lt;&lt; <span class="string">"can't open MIDI device"</span> &gt;&gt;&gt;;</span><br><span class="line">    <span class="comment">// exit the current shred</span></span><br><span class="line">    me.<span class="built_in">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You can get the shred id:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// print out the shred id</span></span><br><span class="line">&lt;&lt;&lt; me.id(); &gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<p>These functions are common to all shreds, but <code>yield()</code> and <code>exit()</code> are commonly used with the current shred.</p>
<p>#using machine.add()</p>
<p><code>Machine.add( string path )</code> takes the path to a chuck program, and sporks it. <em>Unlike <code>spork ~</code>, there is no parent-child relationship between the shred that calls the function and the new shred that is added</em>. This is useful for dynamically(动态地) running stored programs.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// spork "foo.ck"</span></span><br><span class="line">Machine.add( <span class="string">"foo.ck"</span> );</span><br></pre></td></tr></table></figure>
<p>Presently, <strong>this returns the id of the new shred</strong>, not a reference to the shred. <em>This will likely be changed in the future.</em></p>
<p>Similarly, you can remove shreds from the virtual(虚拟的) machine.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add</span></span><br><span class="line">Machine.add( <span class="string">"foo.ck"</span> ) =&gt; <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line"><span class="comment">// remove shred with id</span></span><br><span class="line">Machine.remove( id );</span><br><span class="line"></span><br><span class="line"><span class="comment">// add</span></span><br><span class="line">Machine.add( <span class="string">"boo.ck"</span> ) =&gt; id</span><br><span class="line"></span><br><span class="line"><span class="comment">// replace shred with "bar.ck"</span></span><br><span class="line">Machine.replace( id, <span class="string">"bar.ck"</span> );</span><br></pre></td></tr></table></figure>
<p>#inter-shred communication</p>
<blockquote>
<p>Shreds sporked in the same file can share the same global variables(变量). They can <em>use time and events to synchronize to each other</em>. (see <code>events</code>) <strong>Shreds sporked from different files can <em>share data</em> (including events).</strong>For now, this is done through a public class with static data (see <code>classes</code>). Static data is not completely implemented! We will fix this very soon!</p>
</blockquote>
<p>#command line arguments</p>
<p><strong>ChucK supports passing arbitrary(任意的) data from the command line into ChucK programs using optional(可选择的) command line arguments.</strong> An argument is specified(指定) by appending(附加) a colon(冒号) character “:” to the name of the ChucK program to which you wish to send that argument, followed by the argument itself.</p>
<pre><code>chuck foo.ck:foo
</code></pre><p>Multiple arguments can be specified, each separated by the colon character.</p>
<pre><code>chuck foo.ck:foo:bar:boo
</code></pre><p>Furthermore(此外), each ChucK program has <em>its own set of arguments</em>, which are <em>specified separately</em>.</p>
<pre><code>chuck foo.ck:foo bar.ck:bar boo.ck
</code></pre><p>Command line arguments can also be used when using on-the-fly programming facilities(即时编程工具) of ChucK.</p>
<pre><code>chuck + foo.ck:foo bar.ck:bar:boo
</code></pre><p>(后面有一篇博文会讲解相关参数功能的，包括这里的<code>+</code>)</p>
<p>Machine.add() and Machine.replace() accept command line arguments in a similar fashion.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add foo.ck</span></span><br><span class="line"><span class="comment">// pass foo and bar as command line arguments</span></span><br><span class="line">Machine.add( <span class="string">"foo.ck:foo:bar"</span> ) =&gt; <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line"><span class="comment">// replace shred with "bar.ck"</span></span><br><span class="line"><span class="comment">// pass foo and bar as command line arguments</span></span><br><span class="line">Machine.replace( id, <span class="string">"bar.ck:foo:bar"</span> );</span><br></pre></td></tr></table></figure>
<p>To access command line arguments within a ChucK program, use the <code>me.args()</code> and <code>me.arg()</code> functions.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// print out all arguments</span></span><br><span class="line"><span class="keyword">for</span>( <span class="keyword">int</span> i; i &lt; me.numArgs(); i++ )</span><br><span class="line">    &lt;&lt;&lt; me.arg( i ) &gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>直接运行会输出：<br>C:\Users\abc1\Desktop&gt;chuck test.ck:foo<br>[test.ck]:line(2): class ‘Shred’ has no member ‘numArgs’</p>
</blockquote>
<p>(真就尴尬了)</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck8/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck8/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck8</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:47:04" itemprop="dateModified" datetime="2018-07-13T20:47:04+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>functions</p>
<pre><code>writing
calling
overloading 
</code></pre><p>#writing</p>
<p>keyword <code>fun</code> (or <code>function</code>) followed by the <em>return type</em> and then <em>the name</em> of the function. After the name of the function parentheses(括号) must be opened to declare the types of the input arguments.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define function call 'funk'</span></span><br><span class="line"><span class="function">fun <span class="keyword">void</span> <span class="title">funk</span><span class="params">( <span class="keyword">int</span> arg )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// insert code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define function 'addOne'</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">addOne</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// result</span></span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>#calling</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define 'hey'</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">hey</span><span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// call the function; store result</span></span><br><span class="line">hey( <span class="number">1</span>, <span class="number">2</span> ) =&gt; <span class="keyword">int</span> result;</span><br></pre></td></tr></table></figure>
<p>You can also use the ChucK operator to call functions!</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// call hey</span></span><br><span class="line">( <span class="number">1</span>, <span class="number">2</span> ) =&gt; hey =&gt; <span class="keyword">int</span> result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// same</span></span><br><span class="line">hey( <span class="number">1</span>, <span class="number">2</span> ) =&gt; <span class="keyword">int</span> result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// several in a row</span></span><br><span class="line">( <span class="number">10</span>, <span class="number">100</span> ) =&gt; Std.rand2 =&gt; Std.mtof =&gt; <span class="keyword">float</span> foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// same 返回值做参数</span></span><br><span class="line">Std.mtof( Std.rand2( <span class="number">10</span>, <span class="number">100</span> ) ) =&gt; <span class="keyword">float</span> foo;</span><br></pre></td></tr></table></figure>
<p>#overloading</p>
<p>Overloading a function allows functions <em>with the same name</em> to be defined(定义) <em>with different arguments</em>. The function must be written in <strong>separate instances(实例) to handle the input</strong>, and the <strong>return type must agree(一致)</strong>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// funk( int )</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// funk( int, int )</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compiler automatically choose the right one to call</span></span><br><span class="line">add( <span class="number">1</span> ) =&gt; <span class="keyword">int</span> foo;</span><br><span class="line">add( <span class="number">1</span>, <span class="number">2</span> ) =&gt; <span class="keyword">int</span> bar;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck5/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck5/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck5</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:46:51" itemprop="dateModified" datetime="2018-07-13T20:46:51+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>operators &amp; operations</p>
<ul>
<li>=&gt; (chuck)</li>
<li><ul>
<li><ul>
<li><ul>
<li>/ (arithmetic)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>% (modulo)</li>
<li>&amp;&amp; || == != &gt;= &lt;=” (logic)</li>
<li>&amp; | ^ (bitwise)</li>
<li>++ – (inc / dec)</li>
<li>! + - new (unary)</li>
</ul>
<p>You may have seen many of the operators in other programming languages (C/Java). <em>Some others are native to ChucK</em>. We start with the family of ChucK operators. </p>
<p>#=&gt; (the ChucK operator) </p>
<p>The ChucK operator (<code>=&gt;</code>) is a massively(大量地) overloaded operator that, depending on the types involved(包含), performs various actions(执行各种操作). <code>It denotes(表示) **action**, can be chained(链接), and imposes(强制执行) and clarifies order(理清顺序) (always goes *from left to right*).</code> The ChucK operator is the means by which work is done in ChucK. Furthermore(此外), the ChucK operator is not a single operator, but a family of operators.</p>
<p>##=&gt; (foundational(基础的) ChucK operator) </p>
<p>We start with the standard, plain-vanilla(普通的，无修饰的) ChucK operator (<code>=&gt;</code>). It is left-associative (<strong>all ChucK operators are</strong>), which allows us to specify(指定) any ordered flow of data/tasks/modules (such as unit generator connection) from left to right, as in written (English) text. <strong>What <code>=&gt;</code> does depends on the context(环境).</strong> It always depends on the type of the entity(实体) on the left (the chucker(投手)) and the one on the right (the chuckee(接球手)), and it sometimes also depends on the nature of the entity (such as whether it is a variable(变量的) or not).</p>
<p>Some examples:<br>(用了c的高亮，至少好看点)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a unit generator patch - the signal flow is apparent</span></span><br><span class="line"><span class="comment">// (in this case, =&gt; connects two unit generators)</span></span><br><span class="line">SinOsc b =&gt; Gain g =&gt; BiQuad f =&gt; dac;</span><br><span class="line"></span><br><span class="line"><span class="comment">// add 4 to foo, chuck result to new 'int' variable 'bar'</span></span><br><span class="line"><span class="comment">// (in this case, =&gt; assigns a value to a variable (int)</span></span><br><span class="line"><span class="number">4</span> + foo =&gt; <span class="keyword">int</span> bar;</span><br><span class="line"></span><br><span class="line"><span class="comment">// chuck values to a function == function call</span></span><br><span class="line"><span class="comment">// (same as Math.rand2f( 30, 1000))</span></span><br><span class="line">( <span class="number">30</span>, <span class="number">1000</span> ) =&gt; Math.rand2f;</span><br></pre></td></tr></table></figure>
<p>There are many other well-defined(定义明确的) uses of the ChucK operator, depending on the context.</p>
<p>##<code>@=&gt;</code> (explicit(明确的) assignment(分配) ChucK operator)</p>
<p>In ChucK, <em>there is no stardard assignment operator (=)</em>, found in many other programming languages. Assignment is carried out using ChucK operators. In the previous examples, we have used =&gt; for assignment:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// assign 4 to variable foo</span></span><br><span class="line"><span class="number">4</span> =&gt; <span class="keyword">int</span> foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// assign 1.5 to variable bar</span></span><br><span class="line"><span class="number">1.5</span> =&gt; <span class="keyword">float</span> bar;</span><br><span class="line"></span><br><span class="line"><span class="comment">// assign duration of 100 millisecond to duh</span></span><br><span class="line"><span class="number">100</span>::ms =&gt; dur duh;</span><br><span class="line"></span><br><span class="line"><span class="comment">// assign the time "5 second from now" to later</span></span><br><span class="line"><span class="number">5</span>::second + now =&gt; time later;</span><br></pre></td></tr></table></figure>
<p>The <code>@=&gt;</code> explicit assignment ChucK operator behaves exactly the same for the above types (int, float, dur, time). However, the difference is that <code>@=&gt;</code> can also be used for reference assignments(分配) of objects (see objects and classes) whereas(然而) <code>=&gt;</code> only does assignment on primitive(原始的) types (int, float, dur, time). The behavior(行为) of <code>=&gt;</code> on objects is completely context-dependent(上下文相关的).</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// using @=&gt; is same as =&gt; for primitive types</span></span><br><span class="line"><span class="number">4</span> @=&gt; <span class="keyword">int</span> foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// assign 1.5 to variable bar</span></span><br><span class="line"><span class="number">1.5</span> @=&gt; <span class="keyword">float</span> bar;</span><br><span class="line"></span><br><span class="line"><span class="comment">// (only @=&gt; can perform reference assignment on objects)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// reference assign moe to larry</span></span><br><span class="line"><span class="comment">// (such that both moe and larry reference the same object)</span></span><br><span class="line">Object moe @=&gt; Object @ larry;</span><br><span class="line"></span><br><span class="line"><span class="comment">// array initialization</span></span><br><span class="line">[ <span class="number">1</span>, <span class="number">2</span> ] @=&gt; <span class="keyword">int</span> ar[];</span><br><span class="line"></span><br><span class="line"><span class="comment">// using new</span></span><br><span class="line"><span class="keyword">new</span> Object @=&gt; moe;</span><br></pre></td></tr></table></figure>
<p>In its own screwed-up(糟透了的) way, this is kind of nice because there is no confusion(混淆) between assignment (<code>@=&gt;</code> or <code>=&gt;</code>) and equality (<code>==</code>). In fact,  the following is not a valid ChucK statement(声明):</p>
<pre><code>// not a valid ChucK statement!
int foo = 4;
</code></pre><p>##+=&gt;  -=&gt;  *=&gt;  /=&gt;  etc. (arithmetic(算数) ChucK operators)</p>
<p>These operators are used with variables(变量) (using ‘int’ and ‘float’) to perform one operation with assignment(执行一个有分配的操作).</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add 4 to foo and assign result to foo</span></span><br><span class="line">foo + <span class="number">4</span> =&gt; foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// add 4 to foo and assign result to foo</span></span><br><span class="line"><span class="number">4</span> +=&gt; foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// subtract 10 from foo and assign result to foo</span></span><br><span class="line"><span class="comment">// remember this is (foo-10), not (10-foo)</span></span><br><span class="line"><span class="number">10</span> -=&gt; foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 times foo assign result to foo</span></span><br><span class="line"><span class="number">2</span> *=&gt; foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// divide 4 into foo and assign result to foo</span></span><br><span class="line"><span class="comment">// again remember this is (foo/4), not (4/foo)</span></span><br><span class="line"><span class="number">4</span> /=&gt; foo;</span><br></pre></td></tr></table></figure>
<p>It is important to note the relationship between the value and variable when using <code>-=&gt;</code> and <code>/=&gt;</code>, since these operations are not commutative(交换的).</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mod foo by T and assign result to foo</span></span><br><span class="line">T %=&gt; foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// bitwise(按位) AND 0xff and bar and assign result to bar</span></span><br><span class="line"><span class="number">0xff</span> &amp;=&gt; bar;</span><br><span class="line"></span><br><span class="line"><span class="comment">// bitwise OR 0xff and bar and assign result to bar</span></span><br><span class="line"><span class="number">0xff</span> |=&gt; bar;</span><br></pre></td></tr></table></figure>
<p>#+  -  *  /  (arithmetic)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// divide (and assign)</span></span><br><span class="line"><span class="number">16</span> / <span class="number">4</span> =&gt; <span class="keyword">int</span> four;</span><br><span class="line"></span><br><span class="line"><span class="comment">// multiply</span></span><br><span class="line"><span class="number">2</span> * <span class="number">2</span> =&gt; four;</span><br><span class="line"></span><br><span class="line"><span class="comment">// add</span></span><br><span class="line"><span class="number">3</span> + <span class="number">1</span> =&gt; four;</span><br><span class="line"></span><br><span class="line"><span class="comment">// subtract</span></span><br><span class="line"><span class="number">93</span> - <span class="number">89</span> =&gt; four;</span><br></pre></td></tr></table></figure>
<p><strong>cast(转换)</strong></p>
<p><em>ChucK implicitly(隐式地) casts int values to float when float is expected, but not the other around.</em> The latter could result in a loss of information and requires an explicit(明确的) cast.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// adding float and int produces a float</span></span><br><span class="line"><span class="number">9.1</span> + <span class="number">2</span> =&gt; <span class="keyword">float</span> result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// however, going from float to int requires cast</span></span><br><span class="line"><span class="number">4.8</span> $ <span class="keyword">int</span> =&gt; <span class="keyword">int</span> foo;  <span class="comment">// foo == 4</span></span><br><span class="line"><span class="comment">//这里的$是什么意思？</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// this function expects two floats</span></span><br><span class="line">Math.rand2f( <span class="number">30.0</span>, <span class="number">1000.0</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">// this is ok because of implicit cast</span></span><br><span class="line">Math.rand2f( <span class="number">30</span>, <span class="number">1000</span> );</span><br></pre></td></tr></table></figure>
<p>#% (modulo(取模))</p>
<p>The modulo operator <code>%</code> computes the remainder(余数) after integer(整数), floating point, duration, and time/duration division.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 7 mod 4 (should yield(产生) 3)</span></span><br><span class="line"><span class="number">7</span> % <span class="number">4</span> =&gt; <span class="keyword">int</span> result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7.3 mod 3.2 floating point mod (should yield .9)</span></span><br><span class="line"><span class="number">7.3</span> % <span class="number">3.2</span> =&gt; <span class="keyword">float</span> resultf;</span><br><span class="line"></span><br><span class="line"><span class="comment">// duration mod</span></span><br><span class="line"><span class="number">5</span>::second % <span class="number">2</span>::second =&gt; dur foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// time/duration mod</span></span><br><span class="line">now % <span class="number">5</span>::second =&gt; dur bar;</span><br></pre></td></tr></table></figure>
<p>the latter (time/duration mod) is one of many ways to dynamically(动态地) synchronize(同步) timing in shreds. the examples <code>otf_01.ck</code> through <code>otf_07.ck</code> (see under <code>examples</code>) make use of this to on-the-fly(运行时) synchronize its various parts, no matter when each shred is added to the virtual(虚拟的) machine:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define period (agreed upon by several shreds)</span></span><br><span class="line"><span class="number">.5</span>::second =&gt; dur T;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compute the remainder(余数) of the current period ...</span></span><br><span class="line"><span class="comment">// and advance time by that amount</span></span><br><span class="line">T - (now % T) =&gt; now;</span><br><span class="line"></span><br><span class="line"><span class="comment">// when we reach this point, we are synchronized to T period boundary</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the rest of the code</span></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>
<p>This is one of many ways to compute and reason about(思考) time in ChucK. The appropriate(适当的) solution(解决方案)(s) in each case depends on the intended(打算的) functionality(功能). </p>
<p>#&amp;&amp;  ||  ==  !=  &gt;  &gt;=  &lt;  &lt;=  (logic)(逻辑)</p>
<p>Logical operators - each of these need two operands(操作数). <strong>The result is an integer value of 0 or 1.</strong></p>
<ul>
<li>&amp;&amp; : and</li>
<li>|| : or</li>
<li>== : equals</li>
<li>!= : does not equal</li>
<li><blockquote>
<p>: greater than</p>
</blockquote>
</li>
<li><blockquote>
<p>= : greater than or equal to</p>
</blockquote>
</li>
<li>&lt; : less than</li>
<li>&lt;= : less than or equal to </li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test some universal truths(普遍的真理)</span></span><br><span class="line"><span class="keyword">if</span>( <span class="number">1</span> &lt;= <span class="number">4</span> &amp;&amp; <span class="literal">true</span> )</span><br><span class="line">    &lt;&lt;&lt;<span class="string">"horray"</span>&gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<p>#&gt;&gt;  &lt;&lt;  &amp;  |  ^  (bitwise)(按位)</p>
<p>These are used on int values at the bit level, often for bit masking.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; : <span class="function">shift bits <span class="title">right</span><span class="params">(右移位)</span> <span class="params">( <span class="number">8</span> &gt;&gt; <span class="number">1</span> = <span class="number">4</span> )</span></span></span><br><span class="line">&lt;&lt; : shift bits left ( 8 &lt;&lt; 1 = 16 )</span><br><span class="line">&amp; : bitwise AND</span><br><span class="line">| : bitwise OR</span><br><span class="line">^ : bitwise XOR</span><br></pre></td></tr></table></figure>
<p>#++  –  (inc / dec)<br>Values may be incremented or decremented by appending(附加) the <code>++</code> or <code>--</code> operators.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> =&gt; <span class="keyword">int</span> foo;</span><br><span class="line">foo++;</span><br><span class="line">foo--;</span><br></pre></td></tr></table></figure>
<p>#! + - new (unary(一元的))</p>
<p>These operators come before(位于…之前) one operand(操作数).</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// logical invert</span></span><br><span class="line"><span class="keyword">if</span>( !<span class="literal">true</span> == <span class="literal">false</span> )</span><br><span class="line">    &lt;&lt;&lt;<span class="string">"yes"</span>&gt;&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// negative</span></span><br><span class="line"><span class="number">-1</span> =&gt; <span class="keyword">int</span> foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// instantiate object</span></span><br><span class="line"><span class="keyword">new</span> object @=&gt; object @ bar;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck1/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck1</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:45:54" itemprop="dateModified" datetime="2018-07-13T20:45:54+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p><a href="http://chuck.cs.princeton.edu/doc/build/" target="_blank" rel="noopener"> Build/Install Instructions </a><br>如是直接安装（win）可以忽略上面的。*</p>
</li>
<li><p><a href="http://chuck.cs.princeton.edu/doc/learn/tutorial.html" target="_blank" rel="noopener">The ChucK Tutorial </a>*</p>
</li>
</ul>
<p>This tutorial(个别指导) was written for the command line version of ChucK (currently the most stable(稳定的) and widely supported). Other methods of running ChucK includes the miniAudicle (now on all major platforms) and the Audicle (in pre-pre-alpha). <em>The code is the same, but the way to run them differs, depending the ChucK system.</em></p>
<p>…generate a sine wave and send to the speaker…</p>
<p>…connecting audio processing modules (<a href="https://en.wikipedia.org/wiki/Unit_generator" target="_blank" rel="noopener">unit generators</a>) and having them work together to compute the sound.</p>
<pre><code>// connect sine oscillator to D/A convertor (sound card)
SinOsc s =&gt; dac;
</code></pre><p>The above does several things:</p>
<pre><code>(1) it creates a new unit generator of type &apos;SinOsc&apos; (sine oscillator(振荡器)), and store its reference(引用) in variable(变量的) &apos;s&apos;. 
(2) &apos;dac&apos; (D/A convertor(转炉)) is a special *unit generator* (created by the system) which is our abstraction(抽象) for the underlying(潜在的) audio interface(界面). 
(3) we are using the ChucK operator (=&gt;) to ChucK &apos;s&apos; to &apos;dac&apos;. 
</code></pre><p>In ChucK, when one unit generator is ChucKed to another, we connect them. We can think of this line as setting up <em>a data flow from ‘s’</em>, a signal generator, to <em>‘dac’, the sound card/speaker</em>. Collectively(集体的), we will call this a ‘patch’. </p>
<p>…we simply have to “allow time to pass” for data to be computed…time and audio data are both inextricably(密不可分) related in ChucK (as in reality), and separated in the way they are manipulated(操纵).</p>
<p>let’s generate our sine wave and hear it by adding one more line: </p>
<pre><code>// connect sine oscillator to D/A convertor (sound card)
SinOsc s =&gt; dac;

// allow 2 seconds to pass
2::second =&gt; now;
</code></pre><p>Let’s now run this (assuming(假设) you saved the file as ‘foo.ck’):</p>
<pre><code>%&gt; chuck foo.ck
</code></pre><p> For now, we can just take the second line of code to mean “let time pass for 2 seconds (and let audio compute during that time)”. If you want to play it indefinitely(无限制地), we could write a loop:</p>
<pre><code>////////////
//example1//
////////////
// connect sine oscillator to D/A convertor (sound card)
SinOsc s =&gt; dac;

// loop in time
while( true ) {
    2::second =&gt; now;
    //(we used 2::second here, but we could have used any number of 
    //&apos;ms&apos;, &apos;second&apos;, &apos;minute&apos;, &apos;hour&apos;, &apos;day&apos;, and even &apos;week&apos;)
    }
</code></pre><p>In ChucK, this is called a ‘time-loop’ (in fact this is an ‘infinite time loop’).<br><strong>To stop a ongoing ChucK program from the command line, hit (ctrl - c).</strong></p>
<p>Now, let’s try changing the frequency randomly every 100ms:</p>
<pre><code>// make our patch
SinOsc s =&gt; dac;

// time-loop, in which the osc&apos;s frequency is changed every 100 ms
while( true ) {
    100::ms =&gt; now;
    Std.rand2f(30.0, 1000.0) =&gt; s.freq;
    }
</code></pre><p>Two more things to note here. </p>
<pre><code>(1) We are advancing time inside the loop by 100::ms durations. 
(2) A random value between 30.0 and 1000.0 is generated and &apos;assigned&apos; to the oscillator&apos;s frequency, every 100::ms. 
</code></pre><p><em>目前运行的结果是有并不规律的声音产生，这就是那个时刻变形的声波</em></p>
<hr>
<p>Now let’s write another (slightly longer) program: (these files can be found in the examples/ directory, so you don’t have to type them in) </p>
<pre><code>////////////
//example2//
////////////
// impulse(脉冲信号) to filter to dac
//Biquad filter（双二阶滤波器）
Impulse i =&gt; BiQuad f =&gt; dac;
// set the filter&apos;s pole radius( = prad)
.99 =&gt; f.prad;
// set equal gain zero&apos;s
1 =&gt; f.eqzs;//不理解
// initialize float variable
0.0 =&gt; float v;

// infinite time-loop
while( true )
{
    // set the current sample/impulse
    1.0 =&gt; i.next;
    // sweep the filter resonant frequency(共振频率)
    Std.fabs(Math.sin(v)) * 4000.0 =&gt; f.pfreq;
    // increment(增量) v
    v + .1 =&gt; v;
    // advance time
    100::ms =&gt; now;
}
</code></pre><p>Name this moe.ck, and run it:</p>
<pre><code>chuck moe.ck
</code></pre><p>Now, make two copies of moe.ck - larry.ck and curly.ck. Make the following modifications(修改). </p>
<pre><code>1) change larry.ck to advance time by 99::ms (instead of 100::ms). 
2) change curly.ck to advance time by 101::ms (instead of 100::ms). 
3) optionally, change the 4000.0 to something else (like 400.0 for curly).
</code></pre><p>Run all three in parallel:</p>
<pre><code>chuck moe.ck larry.ck curly.ck
</code></pre><p>What you hear (if all goes well) should be ‘phasing’ between moe, larry, and curly, with curly emitting(发出) the lower-frequency pulses(脉冲).</p>
<p>ChucK supports sample-synchronous concurrency(并发性), via the ChucK timing mechanism(机制). Given any number of source files that uses the timing mechanism above, the ChucK VM can use the timing information to automatically(自动地) synchronize(合拍) all of them… Note that each process do not need to know about each other - it only has to deal with time locally. The VM will make sure things happen correctly and globally. </p>
<p>A large collection of pre-made examples have been arranged and provided with this distribution in the /doc/examples directory, and are mirrored <a href="http://chuck.cs.princeton.edu/doc/examples/" target="_blank" rel="noopener">here</a></p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck10/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck10/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck10</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:46:14" itemprop="dateModified" datetime="2018-07-13T20:46:14+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>classes and objects</p>
<pre><code>introduction
existing classes
working with objects
writing a class
members (data + functions)
static (data + functions)
inheritance
overloadation (overloading + overriding) 
</code></pre><p>#introduction</p>
<p>Chuck implements(实现) an object system that borrows from both C++ and Java conventions. In our case this means:</p>
<ul>
<li>You can define(定义) custom classes as new types and instantiate objects自定义类</li>
<li>ChucK supports <em>polymorphic inheritance(多态继承)</em> (this is the same model used in Java, and also known as <em>virtual inheritance</em> in C++)</li>
<li>All object variables(变量) are <em>references</em> (like Java), but instantiation(实例化) resembles(类似于) C++. We will discuss this in detail below.</li>
<li>There is a default class library.</li>
<li>All objects inherit(继承) from the Object class (as in Java)</li>
</ul>
<p>For the sake(目的) of clarity(清楚) we will define(定义) these terms:</p>
<ul>
<li>a class is an <em>abstraction</em> of data (<strong>members</strong>) and behavior(行为) (<strong>methods</strong>)</li>
<li>a class is a <em>type</em>.</li>
<li>an <em>object</em> is an <em>instantiation</em> of that class</li>
<li>a <em>reference</em> variable refers indirectly to an object - it is not the object itself. <strong>All ChucK <em>object variables</em> are reference variables</strong>(变量) (like in Java).</li>
<li>similarly, <em>reference assignment(引用赋值)</em> duplicates a reference to an object and assigns(分配) the reference to a reference variable. The object itself is not duplicated. <strong>All ChucK object assignments are reference assignments.所有对象赋值都是引用赋值</strong></li>
</ul>
<p>#built-in classes</p>
<p>ChucK has a number of classes defined(定义) within the language.</p>
<ul>
<li><code>Object</code> : <strong>base class to all ChucK objects.</strong></li>
<li><code>Event</code> : ChucK’s basic synchronization(同步) mechanism(机制); may be extended(延伸) to <em>create custom Event</em> functionality(功能) (discussed <a href="http://chuck.cs.princeton.edu/doc/language/event.html" target="_blank" rel="noopener">here</a>).</li>
<li><code>Shred</code> : basic abstraction(抽象) for a non-preemptive ChucK process(非抢占式进程).</li>
<li><code>UGen</code> : base unit generator class (discussed <a href="http://chuck.cs.princeton.edu/doc/language/ugen.html" target="_blank" rel="noopener">here</a>).</li>
</ul>
<p>These are some of the more commonly used classes in ChucK. </p>
<p>#working with objects</p>
<p>Let’s begin with some examples. For these examples, let’s assume Foo is a defined class.</p>
<pre><code>// create a Foo object; stored in reference variable bar
Foo bar;
</code></pre><p>The above code does two things:</p>
<ul>
<li>a reference variable bar is declared; its type is Foo.</li>
<li>a new instance of Foo is created, and its reference is assigned to bar.</li>
</ul>
<p>Note that in contrast to(与…相比) Java, <em>this statement both declares a reference variable and instantiates a instance of that class and assigns the reference to the variable</em>.<br>Also note that in contrast to C++, <em>bar is a reference, and does not represent the object itself</em>.</p>
<p>To declare a reference variable that refers to nothing (also called a <em>null reference</em>):</p>
<pre><code>// create a null reference to a Foo object
Foo @ bar;
</code></pre><p>The above code only declare a reference and initializes it to null. (random note: the above statement may be read as “Foo at bar”)</p>
<p>We can assign a new instance to the reference variable:</p>
<pre><code>// assign new instance of Foo to bar
new Foo @=&gt; Foo @ bar;

// (this statement is equivalent to &apos;Foo bar&apos;, above)
</code></pre><p>The <code>new</code> operator creates an instance of a class, in this case <code>Foo</code>. The <code>@=&gt;</code> operator performs the <em>reference assignment</em>. (see <a href="http://chuck.cs.princeton.edu/doc/language/oper.html" target="_blank" rel="noopener">here</a> for more information on <code>@=&gt;</code>)</p>
<p>It is possible to make many references to same object:</p>
<pre><code>// make a Foo
Foo bar;

// reference assign to duh
bar @=&gt; Foo @ duh;

// (now both bar and duh points to the same object)
</code></pre><p>ChucK objects are reference counted(引用计数) and garbage collection takes place automatically. (note: this is still being implemented!)引用计数，垃圾回收</p>
<p>As stated above(如上所述), <em>a classes may contain data and behavior</em>, in the form of <em>member variables</em> and <em>member functions</em>, respectively. Members are accessed by using ‘dot notation’ - <em>reference.memberdata</em> and <em>reference.memberfunc()</em>. To invoke(调用) a member function of an object (assuming class <code>Foo</code> has a member function called <code>compute</code> that takes two integers and returns an integer):</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// make a Foo</span></span><br><span class="line">Foo bar;</span><br><span class="line"></span><br><span class="line"><span class="comment">// call compute(), store result in boo</span></span><br><span class="line">bar.compute( <span class="number">1</span>, <span class="number">2</span> ) =&gt; <span class="keyword">int</span> boo;</span><br></pre></td></tr></table></figure>
<p>#writing a class</p>
<p>If a class has already <em>been defined in the ChucK virtual machine</em> (either in the same file or as a public class in a different file) then it can be instantiated <em>similar to primitive types</em>.</p>
<p>Unless declared <em>public</em>, class definitions are scoped to the shred and will not conflict with identically named classes in other running shreds.除非声明是公共的，类的定义作用于该进程，并将不会与在其他运行进程中的命名相同的类发生冲突。</p>
<p>Classes encapsulate(封装) a set of behaviors and data. To define a new object type, the keyword <code>class</code> is used followed by the name of that class.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define class X</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// insert code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If a class is defined as <code>public</code>, it is integrated(整合) into <em>the central namespace</em> (instead of the local one), and can be instantiated from other programs that are subsequently compiled.<br>在随后编译的其他程序中，公共类也可以被实例化。</p>
<p><strong>There can be at most one public class per file.</strong>(每个文件中至多一个公共类)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define public class MissPopular</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MissPopular</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// define non-public class Flarg</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flarg</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// both MissPopular and Flarg can be used in this file</span></span><br><span class="line"><span class="comment">// only MissPopular can be used from another file</span></span><br></pre></td></tr></table></figure>
<p>We define <code>member data</code> and <code>methods</code> to specify the <strong>data types and functionality(数据类型和功能)</strong> required of the class. Members, or instance data and instance functions are associated with <em>individual instances of a class</em>, whereas(然而) static data and functions are only associated with the class (and shared by the instances).<br>成员 或者 实例数据和实例函数，关联各个类实例，而静态数据和函数是关联于类的，各实例共享。</p>
<p>#members (instance data + functions)</p>
<p>Instance data and methods are associated with an object.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define class X</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// declare instance variable 'm_foo'</span></span><br><span class="line">    <span class="keyword">int</span> m_foo;</span><br><span class="line">    <span class="comment">// another instance variable 'm_bar'</span></span><br><span class="line">    <span class="keyword">float</span> m_bar;</span><br><span class="line">    <span class="comment">// yet another, this time an object</span></span><br><span class="line">    Event m_event;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// function that returns value of m_foo</span></span><br><span class="line">    <span class="function">fun <span class="keyword">int</span> <span class="title">getFoo</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> m_foo; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// function to set the value of m_foo</span></span><br><span class="line">    <span class="function">fun <span class="keyword">void</span> <span class="title">setFoo</span><span class="params">( <span class="keyword">int</span> value )</span> </span>&#123; value =&gt; m_foo; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// calculate something</span></span><br><span class="line">    <span class="function">fun <span class="keyword">float</span> <span class="title">calculate</span><span class="params">( <span class="keyword">float</span> x, <span class="keyword">float</span> y )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// insert code</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// print some stuff</span></span><br><span class="line">    <span class="function">fun <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        &lt;&lt;&lt; m_foo, m_bar, m_event &gt;&gt;&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// instantiate an X</span></span><br><span class="line">X x;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set the Foo</span></span><br><span class="line">x.setFoo( <span class="number">5</span> );</span><br><span class="line"><span class="comment">// print the Foo</span></span><br><span class="line">&lt;&lt;&lt; x.getFoo() &gt;&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// call print</span></span><br><span class="line">x.print();</span><br></pre></td></tr></table></figure>
<p><strong>class constructors</strong></p>
<blockquote>
<p>In the initial release(初始版本), we do not support <em>constructors</em> yet. However, we have a single pre-constructor. The code immediately inside a class definiton(定义) (and not inside any functions) is run every time an instance of that class is created.<br>类实例化时就自动运行类定义里而不是任何函数里的代码。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// define <span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">X</span></span></span><br><span class="line">&#123;</span><br><span class="line">    // we can put any ChucK statements here <span class="keyword">as</span> pre-constructor</span><br><span class="line">    </span><br><span class="line">    // initialize an instance data</span><br><span class="line">    109 =&gt; int m_foo;</span><br><span class="line"></span><br><span class="line">    // loop over stuff</span><br><span class="line">    for( 0 =&gt; int i; i &lt; 5; i++ )</span><br><span class="line">    &#123;</span><br><span class="line">        // <span class="keyword">print</span> out message how silly</span><br><span class="line">        &lt;&lt;&lt; <span class="string">"part of class pre-constructor..."</span>, this, i &gt;&gt;&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // function</span><br><span class="line">    fun void doit()</span><br><span class="line">    &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// when we instantiate X, the pre-constructor <span class="keyword">is</span> run</span><br><span class="line">X x;</span><br><span class="line"></span><br><span class="line">// <span class="keyword">print</span> out m_foo</span><br><span class="line">&lt;&lt;&lt; x.m_foo &gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<p>#static (data + functions)</p>
<p>Static data and functions are associated with a <em>class</em>, and are <em>shared by all instances of that class</em> – in fact, static elements can be accessed without an instance, by using the name of the class: <code>Classname.element</code>.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define class X</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// static data</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> our_data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// static function</span></span><br><span class="line">    <span class="function">fun <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">doThatThing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// return the data</span></span><br><span class="line">        <span class="keyword">return</span> our_data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// do not need an instance to access our_data</span></span><br><span class="line"><span class="number">2</span> =&gt; X.our_data;</span><br><span class="line"><span class="comment">// print out</span></span><br><span class="line">&lt;&lt;&lt; X.our_data &gt;&gt;&gt;;</span><br><span class="line"><span class="comment">// print</span></span><br><span class="line">&lt;&lt;&lt; X.doThatThing() &gt;&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create instances of X</span></span><br><span class="line">X x1;</span><br><span class="line">X x2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// print out their static data - should be same</span></span><br><span class="line">&lt;&lt;&lt; x1.our_data, x2.our_data &gt;&gt;&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// change use one</span></span><br><span class="line"><span class="number">5</span> =&gt; x1.our_data;</span><br><span class="line"></span><br><span class="line"><span class="comment">// the other should be changed as well</span></span><br><span class="line">&lt;&lt;&lt; x1.our_data, x2.our_data &gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<p>静态数据是同一块内存</p>
<p>#inheritance</p>
<p>Inheritance in <strong>object-oriented(面向对象的)</strong> code allows the programmer to take an existing class to extend(扩展) or alter(改变) its functionality.  In doing so we can create a taxonomy(分类法) of classes that all share a specific(特定的) set of behaviors(行为), while implementing(实施) those behaviors in different, yet well-defined(定义明确的), ways. <strong>We indicate(表明) that a new class inherits(继承) from another class using the <code>extends</code> keyword.</strong> The class from which we inherit(继承) is referred to as the <code>parent class</code>, and the inheriting class is the <code>child class</code>. The <em>Child class receives all of the member data and functions from the parent class</em>, although functions from the parent class may be overridden(重写) ( below ).<br>Because the children contain the functionality(功能) of the parent class, references to instances(实例) of a child class may be assigned(分配) to a parent class reference type. </p>
<p>For now, access modifiers(存取修改器) (public, protected, private) are included but not fully implemented. <em>Everything is public by default</em>.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define class X</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// define member function</span></span><br><span class="line">    <span class="function">fun <span class="keyword">void</span> <span class="title">doThatThing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        &lt;&lt;&lt;<span class="string">"Hallo"</span>&gt;&gt;&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// define another</span></span><br><span class="line">    <span class="function">fun <span class="keyword">void</span> <span class="title">hey</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        &lt;&lt;&lt;<span class="string">"Hey!!!"</span>&gt;&gt;&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// data</span></span><br><span class="line">    <span class="keyword">int</span> the_data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// define child class Y</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Y</span> <span class="title">extends</span> <span class="title">X</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// override doThatThing()</span></span><br><span class="line">    <span class="function">fun <span class="keyword">void</span> <span class="title">doThatThing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        &lt;&lt;&lt;<span class="string">"No! Get away from me!"</span>&gt;&gt;&gt;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// instantiate a Y</span></span><br><span class="line">Y y;</span><br><span class="line"></span><br><span class="line"><span class="comment">// call doThatThing</span></span><br><span class="line">y.doThatThing();</span><br><span class="line"></span><br><span class="line"><span class="comment">// call hey() - should use X's hey(), since we didn't override</span></span><br><span class="line">y.hey();</span><br><span class="line"></span><br><span class="line"><span class="comment">// data is also inherited from X</span></span><br><span class="line">&lt;&lt;&lt; y.the_data &gt;&gt;&gt;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Inheritance provides us a way of efficiently sharing code between classes which <strong>perform similar roles</strong>. We can define a particular complex pattern of behavior, while changing the way that certain aspects of the behavior operate.</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// parent class defines some basic data and methods </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Xfunc</span></span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">    <span class="keyword">int</span> x; </span><br><span class="line"></span><br><span class="line">    <span class="function">fun <span class="keyword">int</span> <span class="title">doSomething</span><span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b )</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// child class, which overrides the doSomething function with an addition operation</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Xadds</span> <span class="title">extends</span> <span class="title">Xfunc</span></span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">    <span class="function">fun <span class="keyword">int</span> <span class="title">doSomething</span> <span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b )</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">         <span class="keyword">return</span> a + b ; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// child class, which overrides the doSomething function with a multiply operation </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Xmuls</span> <span class="title">extends</span> <span class="title">Xfunc</span></span></span><br><span class="line"><span class="class">&#123;</span> </span><br><span class="line">    <span class="function">fun <span class="keyword">int</span> <span class="title">doSomething</span> <span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b )</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">         <span class="keyword">return</span> a * b; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// array of references to Xfunc</span></span><br><span class="line">Xfunc @ operators[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// instantiate two children and assign reference to the array </span></span><br><span class="line"><span class="keyword">new</span> Xadds @=&gt; operators[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">new</span> Xmuls @=&gt; operators[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// loop over the Xfunc</span></span><br><span class="line"><span class="keyword">for</span>( <span class="number">0</span> =&gt; <span class="keyword">int</span> i; i &lt; operators.cap(); i++ )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// doSomething, potentially different for each Xfunc</span></span><br><span class="line">    &lt;&lt;&lt; operators[i].doSomething( <span class="number">4</span>, <span class="number">5</span> ) &gt;&gt;&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>because Xmuls and Xadds each redefine(重新定义) doSomething( int a, int b ) with their own code, we say that they have <code>overridden</code>(重写) the behavior of the parent class. They observe the same interface, but have potentially different implementation.<br>This is known as <strong>polymorphism(多态性)</strong>.</p>
<p>#Overloading</p>
<p>Function overloading in classes is similar to that of regular functions. see functions.</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck11/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck11/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck11</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:46:19" itemprop="dateModified" datetime="2018-07-13T20:46:19+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>unit generators(单元发生器)</p>
<pre><code>declaring
connecting
controlling (timing mechanism)
mono + stereo
creating (coming soon) 
</code></pre><p>#Unit Generators</p>
<p><strong>Unit Generators are function generators that output(输出) signals that can be used as audio or control signals</strong>. However, in ChucK, there is <em>no fixed control rate</em>. <strong>Any unit generator may be controlled at any rate.</strong> Using the timing mechanism(机制), you can program your own control rate, and can dynamically(动态地) vary(变化) the control over time. <em>Using concurrency(并发性), it is possible to have many different parallel(平行的) controls rates, each at any granularity(间隔尺寸).</em></p>
<p>Some more quick facts about ChucK unit generators</p>
<ul>
<li>All ChucK unit generators are objects (not primitive(原始的) types).是对象，非原始类型</li>
<li>All ChucK unit generators inherit(继承) from the <code>UGen</code> class.继承自<code>UGen</code>类</li>
<li>The operation <code>foo =&gt; bar</code>, where <code>foo</code> and <code>bar</code> are UGen’s, connects <code>foo</code> to <code>bar</code>.</li>
<li>Unit generators are controlled by calling/chucking to member functions over time.通过随时间唤起成员函数而控制单元发生器</li>
<li>All unit generators have the functions <code>gain</code>, <code>op</code>, <code>channels</code>, <code>chan</code>, and <code>last</code>. (see below)</li>
<li>Three default, global unit generators are provided. They are <code>adc</code>, <code>dac</code>, and <code>blackhole</code>. (see below)</li>
<li><em>Unit generators are specially integrated(集合) into the virtual machine</em> such that audio is computed for every sample(取样) <code>as time is advanced(随时间被推进)</code>. Via the timing mechanism(机制), we have the ability to <strong>assert(维护) control over the audio generate process <em>at any point in time</em> and <em>at any desired control rate</em>. </strong></li>
</ul>
<blockquote>
<p><a href="http://chuck.cs.princeton.edu/doc/program/ugen.html" target="_blank" rel="noopener">View a list</a> of ChucK’s built-in(嵌入的) unit generator classes<br><a href="http://chuck.cs.princeton.edu/doc/examples/index.html#ugen" target="_blank" rel="noopener">View sample code</a> for unit generators </p>
</blockquote>
<p>#declaring</p>
<p>Unit generators (UGens) are objects, and <em>need to be instantiated before they can be used(在使用前需要被实例化)</em>. We declare unit generators the same way we declare objects.</p>
<pre><code>// instantiate a SinOsc, assign reference to variable s
SinOsc s;
</code></pre><p>#connecting</p>
<p>The ChucK operator (<code>=&gt;</code>) <em>is specially overloaded for unit generators</em>: <strong>ChucKing one UGen to another</strong> connects their respective(分别的) output(s) and input(s).</p>
<pre><code>// instantiate a SinOsc, connect its output to dac&apos;s input
SinOsc s =&gt; dac;
</code></pre><p>It is also possible to linearly(线性地) chain many UGens together in a single statement.在一个单独声明中，线性连接许多单元发生器</p>
<pre><code>// connect SinOsc to Gain to reverb(混响) to dac
SinOsc s =&gt; Gain g =&gt; JCRev r =&gt; dac;
</code></pre><p>Furthermore(此外), it is possible to introduce feedback(反馈) in the network.网络中可以引入反馈</p>
<pre><code>// connect adc to Gain(增益) to delayline(延迟线) to dac; (feedforward(正反馈))
adc =&gt; Gain g1 =&gt; DelayL d =&gt; dac;

// adc to Gain to dac (feedforward)
adc =&gt; Gain g2 =&gt; dac;

// our delayline to Gain back to itself (feedback)
d =&gt; Gain g3 =&gt; d;
</code></pre><p>UGens may be dynamically(动态地) connected in this fashion(以这种方式) into an audio synthesis network(音频合成网络). It is essential to note that the above only connects the unit generators, but does not actually generate(形成) audio - unless time is advanced. (see manipulating time and using events)要注意上面只是链接了单元发生器，并未形成音频，除非时间被推进</p>
<pre><code>// connect SinOsc to dac
SinOsc s =&gt; dac;
// set initial frequency (see next section)
440 =&gt; s.freq;

// advance time; allow audio to compute
1::second =&gt; now;
</code></pre><p>It is also possible to dynamically disconnect(断开) unit generators, using the UnChucK operator (<code>=&lt;</code> or <code>!=&gt;</code>):</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// connect SinOsc to dac</span></span><br><span class="line">SinOsc s =&gt; dac;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let time pass for 1 second letting audio be computed for that amount of time</span></span><br><span class="line"><span class="number">1</span>::second =&gt; now;</span><br><span class="line"></span><br><span class="line"><span class="comment">// disconnect s from the dac</span></span><br><span class="line">s =&lt; dac;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let time pass for another second - should hear silence</span></span><br><span class="line"><span class="number">1</span>::second =&gt; now;</span><br><span class="line"></span><br><span class="line"><span class="comment">// duh, connect them again</span></span><br><span class="line">s =&gt; dac;</span><br><span class="line"></span><br><span class="line"><span class="comment">// let time pass...</span></span><br><span class="line"><span class="number">1</span>::second =&gt; now;</span><br></pre></td></tr></table></figure>
<p>#controlling (over time)</p>
<p>In ChucK, parameters(参数) of unit generators may be <em>controlled and altered at any point in time and at any control rate.</em> We only have to move through time and assert(维护) the control at <em>appropriate</em>(适当的) points in time, by setting various parameters on the unit generator.<br>通过在单元发生器设定各种各样的参数<br>To set the a value for a parameter of a unit generator, a value of the proper type should be ChucKed to the corresponding control fucntion.<br>为了设定一个单元发生器的参数值，一个合适的类型的值应该被ChucK到相应的控制函数上。</p>
<pre><code>// connect SinOsc to dac
SinOsc s =&gt; dac;
// set initial frequency to 440 hz
440 =&gt; s.freq;

// let time pass for 1 second
1::second =&gt; now;

// change the frequency to 880 hz
880 =&gt; s.freq;
</code></pre><p>Since <em>the control functions</em> are <em>member functions of the unit generator</em>,<br>控制函数就是单元发生器的成员函数<br>the above syntax(语法) is equivalent to calling functions(等价于调用函数).</p>
<pre><code>// connect SinOsc to dac
SinOsc s =&gt; dac;

// set frequency to 440
s.freq( 440 );

// let time pass
1::second =&gt; now;
</code></pre><p>For a list of unit generators and their control methods, consult(查阅) <a href="http://chuck.cs.princeton.edu/doc/program/ugen.html" target="_blank" rel="noopener">UGen reference</a>.</p>
<p>To read the current value of certain parameters(参数) (<em>not all parameters can be read</em>), we may call an overloaded function of the same name.<br>为了读取某个参数的当前值，需要调用一个同名的重载函数</p>
<pre><code>// connect SinOsc to dac
SinOsc s =&gt; dac;

// store the current value of the freq
s.freq() =&gt; float the_freq;
</code></pre><p>You can chain assignments(分配) together when you want to assign(分配) one value to multiple targets. <strong>Note</strong> that the parentheses(括号) are only needed when the read function is on the very left.<br>只有当读函数位于最左边时，才需要括号</p>
<pre><code>// SinOsc to dac
SinOsc foo =&gt; dac;
// triosc to dac
triosc bar =&gt; dac;

// set frequency of foo and then bar
500 =&gt; foo.freq =&gt; bar.freq;

// set one freq to the other
foo.freq() =&gt; bar.freq;

// the above is same as:
bar.freq( foo.freq() );
</code></pre><blockquote>
<p>Of course, varying(不同的) parameters over time is often more interesting.不同参数随时间推移是很有趣的。</p>
</blockquote>
<pre><code>// SinOsc to dac
SinOsc s =&gt; dac;

// infinite time loop
while( true )
{
    // set the frequency
    ( s.freq() + 200 ) % 5000 =&gt; s.freq;

    // advance time
    100::ms =&gt; now;
}
</code></pre><p>All ugen’s have at least the following three control parameters:<br>以下参数至少有三个</p>
<ul>
<li><em>gain(float)</em> (of type <code>float</code>): set/get the gain of the UGen’s output(输出).设置或获取单元发生器输出的增益</li>
<li><em>last()</em> (of type <code>float</code>): get the last sample computed by the UGen. if UGen has more than one channel, the average of all components(成分) channels are returned. 得到被单元发生器计算的最后的样本，如果单元发生器有不止一个通道，则返回所有通道的平均值。</li>
<li><em>channels()</em> (of type <code>int</code>): get the number of channels in the UGen.获取单元发生器的通道数</li>
<li><em>chan(int)</em> (of type <code>UGen</code>): return reference to nth channel (or <em>null</em> if no such channel).返回第几个通道引用，没有的话就返回<code>null</code></li>
<li><em>op(int)</em> (of type <code>int</code>): set/get operation at the UGen. 设定或获取单元发生器的操作 Values:<ul>
<li>0 : stop - always output 0</li>
<li>1 : normal operation, add all inputs (default)</li>
<li>2 : normal operation, subtract(减去) <em>inputs starting from the earliest</em> connected减去从最早的链接开始的输入(不甚理解？？？)</li>
<li>3 : normal operation, multiply(乘以) all inputs</li>
<li>4 : normal operation, divide <em>inputs starting from the earlist connected</em></li>
<li>-1 : passthru - all inputs to the ugen are summed and passed directly to output所有单元生成器的输入被加在一起并且直接传递到输出</li>
</ul>
</li>
</ul>
<p>#mono + stereo(单声道立体声)</p>
<p>ChucK supports <em>stereo</em>(立体声) (default) and <em>multi-channel audio</em> (see <code>command line options</code> to select interfaces(界面) and number of channels). <strong>The <code>dac</code> and the <code>adc</code> are now multi-channel UGens</strong>. By default, ChucKing two UGens containing the same number of channels (<strong>e.g. both stereo(立体声) or both mono(单声道放音)</strong>) automatically(自动地) matches the output(输出) channels with the input(输入) channels (<strong>e.g. left to left, right to right for stereo</strong>). </p>
<p><em>Stereo UGens mix their output channels when connecting to mono UGens</em>.<br><em>Mono UGens split their output channels when connecting to stereo UGens.</em> </p>
<p>Stereo UGens contain the parameters(参数) <code>.left</code> and <code>.right</code>, which allow access(访问) to the individual(个人的) channels.</p>
<pre><code>// adding separate reverb(混响) to left and right channels
adc.left =&gt; JCRev rl =&gt; dac.left;
adc.right =&gt; JCRev rr =&gt; dac.right;
</code></pre><p>The pan2 stereo object takes a mono signal and split it to a stereo signal, with control over the panning. The pan position may be changed with the <code>.pan</code> parameter (-1 (hard left) &lt;= p &lt;= 1 (hard right)范围是固定的)<br>pan2立体声对象将单声道分离成立体声，通过控制panning(平移？)，平移位置可能被用<code>.pan</code>参数改变。</p>
<pre><code>// white noise to pan to dac
noise n =&gt; pan2 p =&gt; dac;

// infinite time loop
while( true )
{
    // modulate(调整) the pan
    Math.sin( now / 1::second * 2 * pi ) =&gt; p.pan;
    // advance time
    10::ms =&gt; now;
}
</code></pre><p>#creating</p>
<blockquote>
<p>( coming soon! )</p>
</blockquote>
<p>#built-in unit generators</p>
<p>ChucK has a number of built-in(嵌入的) UGen classes, included most of the <code>Synthesis ToolKit (STK)</code>. A list of built-in ChucK unit generators can be found here(url:…/ugen.html).</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/2018/02/15/langs/chuck/chuck4/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/15/langs/chuck/chuck4/" class="post-title-link" itemprop="https://plart.pw/page/3/index.html">chuck4</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:46:46" itemprop="dateModified" datetime="2018-07-13T20:46:46+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>arrays</p>
<pre><code>* declaring
* multi-dimensional
* lookup
* associative arrays
* assignment 
</code></pre><p>#Arrays</p>
<p>This sections specifies(指定) how arrays are declared and used in ChucK. Some quick notes:</p>
<pre><code>* arrays can be indexed by integer(整数) (0-indexed).
* **any array can also be used as an associative(联想的) map, indexed by strings.**
* it is important to note that the *integer-indexed portion(部分)* and the *associative portion* of an array are stored in separate namespaces
* arrays are objects, and will behave similarly under *reference assignment(引用赋值)* and other operations common to objects. 
</code></pre><p>#declaration</p>
<p>Arrays(数组) can be declared in the following way:</p>
<pre><code>// declare 10 element array of int, called foo
int foo[10];

// since array of int (primitive type), the contents
// are automatically initialized to 0
</code></pre><p>Arrays can also be initialized(初始化):</p>
<pre><code>// chuck intializer(初始化器，程序) to array reference
[ 1, 1, 2, 3, 5, 8 ] @=&gt; int foo[];
</code></pre><p>In the above code, there are several things to note:</p>
<pre><code>* initializers must contain *the same or similar types*. the compiler(编译器) will attempt to find *the highest common base type of all the elements(元素)*. **if no such common element is found, an error is reported.**
* the type of the initializer `[ 1, 1, 2, 3, 5, 8 ]` is int[]. *the intializer is an array that can be used directly* when arrays are expected.
* the at-chuck operator (`@=&gt;`) means assignment(分配), and is discussed at length(详细地) in operators and operations.
* `int foo[]` is declaring an empty reference(引用) to an array(数组). the statement(声明) assigns(分配) the initializer array to foo.
* arrays are objects. 
</code></pre><p>When declaring an array of objects, the objects inside the array are automatically(自动的) instantiated(实例化).</p>
<pre><code>// objects in arrays are automatically instantiated
Object group[10];
</code></pre><p>If you only want an array of object references:(对象引用数组)</p>
<pre><code>// array of null object references
Object @ group[10];
</code></pre><p><a href="http://chuck.cs.princeton.edu/doc/language/class.html" target="_blank" rel="noopener">Check here</a> more information on object declaration and instantation in Chuck.</p>
<p>The above examples are 1-dimensional arrays (or vectors(矢量)).</p>
<p>#multi-dimensional arrays</p>
<p>It is possible (and equally easy) to declare multi-dimensional arrays:</p>
<pre><code>// declare 4 by 6 by 8 array of float
float foo3D[4][6][8];//和C还是很像
</code></pre><p>Initializers work in similar ways:</p>
<pre><code>// declare 2 by 2 array of int
[ [1,3], [2,4] ] @=&gt; int bar[][];
</code></pre><p>In the above code, note the two <code>[][]</code> since we make a matrix. </p>
<p>#lookup</p>
<p>Elements in an array can be accessed using [] /(in the appropriate quantities).</p>
<pre><code>// declare an array of floats
[ 3.2, 5.0, 7 ] @=&gt; float foo[];

// access the 0th element (debug print)
&lt;&lt;&lt; foo[0] &gt;&gt;&gt;; // hopefully 3.2

// set the 2nd element
8.5 =&gt; foo[2];
</code></pre><p>Looping over the elements of an array:</p>
<pre><code>// array of floats again
[ 1, 2, 3, 4, 5, 6 ] @=&gt; int foo[];
//官方的例子这里是float，但是实际测试，整型不可以被分配到float里。

// loop over the entire array
for( 0 =&gt; int i; i &lt; foo.cap(); i++ )//foo.cap()
{
    // do something (debug print)
    &lt;&lt;&lt; foo[i] &gt;&gt;&gt;;//自带换行
}
</code></pre><p>Accessing multi-dimensional array:</p>
<pre><code>// 2D array
int foo[4][4];

// set an element
10 =&gt; foo[2][2];
</code></pre><p>If the index exceeds(超过) the bounds of the array in any dimension(标出尺寸), an exception(异常) is issued(被放出) and the current shred(片段) is halted(停止).</p>
<pre><code>// array capacity is 5
int foo[5];

// this should cause ArrayOutOfBoundsException
// access element 6 (index 5)
&lt;&lt;&lt; foo[5] &gt;&gt;&gt;;
</code></pre><p>a longer program: <code>otf_06.ck</code> from <a href="http://chuck.cs.princeton.edu/doc/examples/" target="_blank" rel="noopener">examples</a>:</p>
<pre><code>// the period
.5::second =&gt; dur T;
// synchronize to period (for on-the-fly(运行中) synchronization)
T - (now % T) =&gt; now;

// our patch
SinOsc s =&gt; JCRev r =&gt; dac;//JCRev是指什么类型？
// initialize
.05 =&gt; s.gain;
.25 =&gt; r.mix;

// scale (pentatonic(五音阶的); in semitones(半音程))
[ 0, 2, 4, 7, 9 ] @=&gt; int scale[];

// infinite time loop
while( true )
{
    // pick something from the scale
    scale[ Math.rand2(0,4) ] =&gt; float freq;
    // get the final freq
    Std.mtof( 69 + (Std.rand2(0,3)*12 + freq) ) =&gt; s.freq;
    // reset phase for extra bandwidth(为额外带宽重置相位)
    0 =&gt; s.phase;

    // advance time
    if( Std.randf() &gt; -.5 ) .25::T =&gt; now;
    else .5::T =&gt; now;
}
</code></pre><p>#associative arrays(关联数组)<br>(类似于python中的字典，用字符串索引)</p>
<p>Any array(数组) can be used also as an associative array, indexed on strings. Once the regular array is instantiated, no further work has to be done to make it associative as well - just start using it as such.</p>
<pre><code>// declare regular array(正规数组) (capacity(容量) doesn&apos;t matter so much)
float foo[4];

// use as int-based array
2.5 =&gt; foo[0];

// use as associative array
4.0 =&gt; foo[&quot;yoyo&quot;];

// access as associative (print)
&lt;&lt;&lt; foo[&quot;yoyo&quot;] &gt;&gt;&gt;;

// access empty element
&lt;&lt;&lt; foo[&quot;gaga&quot;] &gt;&gt;&gt;;  // -&gt; should print 0.0
</code></pre><p>It is important to note (again), that the address space of the integer(整数) portion(部分) and the associative portion of the array are completely separate. For example:</p>
<pre><code>// declare array
int foo[2];

// put something in element 0
10 =&gt; foo[0];

// put something in element &quot;0&quot;
20 =&gt; foo[&quot;0&quot;];

// this should print out 10 20
&lt;&lt;&lt; foo[0], foo[&quot;0&quot;] &gt;&gt;&gt;;
</code></pre><p>The capacity(容量) of an array relates only to the integer portion of it. An array with an integer portion of capacity 0, for example, can <em>still have any number of associative indexes.</em></p>
<pre><code>// declare array of 0 capacity
int foo[0];

// put something in element &quot;here&quot;
20 =&gt; foo[&quot;here&quot;];

// this should print out 20
&lt;&lt;&lt; foo[&quot;here&quot;] &gt;&gt;&gt;

// this should cause an exception
&lt;&lt;&lt; foo[0] &gt;&gt;&gt;
</code></pre><blockquote>
<p><strong>Note</strong>: The associative capacity of an array is not defined(定义), so objects used in the associative namespace must be explicitly(明确的) instantiated, in contrast(对比) to those in the integer namespace<br>(<strong>此处不甚明白</strong>)</p>
</blockquote>
<p>Accessing an uninstantiated element(元素) of the associate array will return a null reference. Please check the <a href="http://chuck.cs.princeton.edu/doc/language/class.html" target="_blank" rel="noopener">class documentation page</a> for an explanation of ChucK objects and references.</p>
<pre><code>class Item { 
   float weight; 
}

Item box[10]; 

// integer indices(指数；目录（index的复数）) ( up to capacity ) are pre-instantiated.
1.2 =&gt; box[1].weight; 

// instantiate element &quot;lamp&quot;;
new Item @=&gt; box[&quot;lamp&quot;]; 

// access allowed to &quot;lamp&quot;
2.0 =&gt; box[&quot;lamp&quot;].weight; 

// access causes a `NullPointerException`    
2.0 =&gt; box[&quot;sweater&quot;].weight; 
</code></pre><p>#array assignment</p>
<p>Arrays are objects. So when we declare an array, we are actually </p>
<pre><code>(1) declaring a reference to array (reference variable(引用变量))
(2) instantiating a new array and reference assigned(分配) to the variable. 
</code></pre><p>A (null) reference is a reference variable that points to no object or null. A null reference to an array can be created in this fashion:</p>
<pre><code>// declare array reference (by not specifying(指定) a capacity)
int foo[];

// we can now assign any int[] to foo
[ 1, 2, 3 ] @=&gt; foo;

// print out 0th element
&lt;&lt;&lt; foo[0] &gt;&gt;&gt;;
</code></pre><p>This is also useful in declaring functions that have arrays(数组) as arguments or return type.</p>
<pre><code>// our function
fun void print( int bar[] )
{
    // print it
    for( 0 =&gt; int i; i &lt; bar.cap(); i++ )
        &lt;&lt;&lt; bar[0] &gt;&gt;&gt;;
}

// we can call the function with a literal
print( [ 1, 2, 3, 4, 5 ] );

// or can we can pass a reference variable
int foo[10];
print( foo );
</code></pre><p>Like other objects, it is possible make multiple references(多个引用) to a single array. Like other objects, all assignments(分配) are <em>reference assignments</em>, meaning the contents are NOT copied, only a reference to array is duplicated(被复制).(传递引用)</p>
<pre><code>// our single array
int the_array[10];

// assign reference to foo and bar
the_array =&gt; int foo[] =&gt; int bar[];

// (the_array, foo, and bar now all reference the same array)

// we change the_array and print foo...
// they reference the same array, changing one is like changing the other
// 连锁反应，内存中的存储信息改变了
5 =&gt; the_array[0];
&lt;&lt;&lt; foo[0] &gt;&gt;&gt;; // should be 5
</code></pre><p>It is possible to reference sub-sections(小节) of multi-dimensional(多维) arrays.</p>
<pre><code>// a 3D array
int foo3D[4][4][4];

// we can make a reference to a sub-section
foo3D[2] =&gt; int bar[][];

// (note that the dimensions must add up!)
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Lart Pang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">58</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">30</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/lartpang" title="GitHub &rarr; https://github.com/lartpang" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:%6C%61%72%74%70%61%6E%67%40%31%36%33%2E%63%6F%6D" title="E-Mail &rarr; mailto:%6C%61%72%74%70%61%6E%67%40%31%36%33%2E%63%6F%6D" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/140jmx" title="Weibo &rarr; https://weibo.com/140jmx" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 – <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lart Pang</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v6.5.0</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  













  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  
  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  

  

  

  

</body>
</html>

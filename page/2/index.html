<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">



  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-simple.min.css?v=1.0.2" rel="stylesheet">




  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=6.5.0">


  <link rel="mask-icon" href="/images/favicon.ico?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="失乐园">
<meta property="og:url" content="https://plart.pw/page/2/index.html">
<meta property="og:site_name" content="失乐园">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="失乐园">



  <link rel="alternate" href="/atom.xml" title="失乐园" type="application/atom+xml">




  <link rel="canonical" href="https://plart.pw/page/2/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>失乐园</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">失乐园</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">代码与机器</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">30</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">6</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">58</span></a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

    <a href="https://github.com/lartpang" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/life/千日/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/life/千日/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">第一千天的时候</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-04-04 21:31:10" itemprop="dateCreated datePublished" datetime="2018-04-04T21:31:10+08:00">2018-04-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:51:40" itemprop="dateModified" datetime="2018-07-13T20:51:40+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/幻想与现实/" itemprop="url" rel="index"><span itemprop="name">幻想与现实</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">2.3k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">4 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <figure>
<img src="https://cdn.gratisography.com/photos/444H.jpg" alt="飞翔的鲸"><figcaption>飞翔的鲸</figcaption>
</figure>
<h1 id="第一千天的时候">第一千天的时候</h1>
<blockquote>
<p>by 庞有伟</p>
</blockquote>
<h2 id="一">一</h2>
<p>今天是我们共处的第420天。</p>
<p>一年多以前，我花了一大笔钱，从那个落魄科学家那里得到了她。</p>
<p>那时他正要离开这个国家，急需出手这些带不走的东西。而我却因为没有离开的渠道，只好准备了另一种生活的方式。</p>
<p>哦，应该说是——苟活的方式。</p>
<p>我拿到了他们的一些补偿，被安置在了原来废墟不远处的新城。虽说新城，实为旧时拆迁尚未拆掉的旧楼。但是水电齐全，尚可安顿。</p>
<p>有时候和她坐在一起，我就在想，这会不会是个梦？</p>
<p>倒真像个梦啊。</p>
<p>他们那时已经打了好几个月了。战争总是激烈的，死了好多人。</p>
<p>邻居家老太太的小孙子，多么可爱的一个小孩子，刚要准备上小学，却说没就没了。还有街角超市的那个漂亮的姑娘，她好像年末就要结婚了吧？</p>
<p>当然，还有我们家里的人，以及，她的一切。可惜，我活着。</p>
<p>看着坐在前面的她，不禁一阵恍惚，鼻头骤然骤然一酸，眼泪又止不住的流了出来。</p>
<p>她递过来了一张纸巾。</p>
<p>我看向了她。她的眼睛里泛着光，那是屋里灯的光。光芒背后的颜色却是真的好看，是那种令人心静的蓝色。</p>
<p>那个科学家，还是很有想法的。也不知道他现在怎么样了。估计也一般吧？</p>
<p>看着她，心里有些异样，但是说不上来。</p>
<p>屋里很暗，仅有几盏灯亮着。家里窗帘很厚，足以隔绝一切。</p>
<p>我已经准备好了所有东西。</p>
<p>我笑了笑，伸手顺了顺她的头发。</p>
<p>她也笑了。</p>
<h2 id="二">二</h2>
<p>这是我们相遇的第500天。</p>
<p>记得我们刚刚相见的时候，说了好多的话。不过，若是说具体说了些什么？ 哈哈，已经记不得了。毕竟都过了这么久了。 是啊，这么久了。该说的都说了，便就没话说了。</p>
<p>毕竟，她只是个机器人。</p>
<p>看着坐在对面充电的她，我心里忽然有点不开心。 但是每当我抬起头来，看到那张熟悉的面孔，就会觉得有一股难言的情绪弥漫在心里。 记得当初，她也是类似的姿势，坐在我的面前吧？</p>
<p>战争啊。战争，唉。</p>
<p>看着紧闭着的窗帘，目光一滞，便又转开了。自那之后，这帘子就没有打开过。不喜欢太阳。因为感觉那刺眼的光，砸在心上，好生冷漠。</p>
<p>第500天的夜和第499天的夜一样，去的轻轻，来的匆匆。</p>
<p>屋外传来一些脚步声和低声细语。估计又是在讨论着当前的局势。</p>
<p>这个房间，应该会安全一阵子的吧。</p>
<p>外面是什么样子，我已经不知道了。</p>
<p>但是，那重要么？</p>
<p>记得战争刚开始的时候，她就和我说过，要是有事，就赶快跑，越远越好，最好离开这个国家。可是谁又能离开呢？</p>
<p>后来，局势越来越混乱，难民也越来越多。这个国家里，能去的地方，也没有几处。没想到我们倒是又挤在了一起。</p>
<p>那是个尴尬的时刻，双方家里人那时倒都还在，互相打过了招呼，也就没有再说话。</p>
<p>只记得，在离开的时候，她回头看了我一眼。当时的情形，已经记不清楚。但是，那一次回头，却让我再也忘不了了。</p>
<p>忘不了了，因为一切都终止于此。</p>
<p>戛然而止。</p>
<p>敌人的战机飞过了这里，他们的炸弹质量不错，嗯，确实，就是没炸死我。</p>
<p>但是，为什么却让其他人都死了？可是，这个问题，我该问谁？</p>
<p>没得问，就没的说咯。</p>
<p>已经到了夜晚，依旧留着一缕光。</p>
<p>半夜里往往会醒过来，没有了这缕光，很不踏实。那次事情留给我的礼物，或许也就是这做噩梦的义务了。</p>
<p>第800天，转眼就到了，就像之前的第700天那样。</p>
<p>看着墙上密密麻麻的“正”字，整整齐齐排了40行，竟有了一种说不出的成就感。</p>
<p>成就感，虽然有点夸张的感觉。但是在这个时间点，倒也确实可以说得上是一种“成就”了。</p>
<p>但是总是隐隐的有些感觉——只是感觉说不清楚——让人很不安稳。</p>
<p>噩梦更加频繁了。</p>
<h2 id="三">三</h2>
<p>这是第999天的结束，亦是第1000天的开始。</p>
<p>新的生活又将开始。</p>
<p>所有的一切都将获得新生。</p>
<p>我还没有睡。今天估计是不会睡了。</p>
<p>把自己埋在沙发里。看着端坐在那里的她，心里有种说不出来的难过。</p>
<p>每天都在回想着过去一切。每次看到她，想到的也是过去。真也不知道这样的生活究竟有怎样的意义。</p>
<p>苟延残喘？白日做梦？</p>
<p>站起了身子，走向了这个已经陪伴了我已经九百九十九天的“人”。看着她完美的皮肤和身材，我已经没有了最初时那样的满足与幸福。</p>
<p>记得最开始的时候，即使是坐在那里，静静地看着她，什么也不做，也是无尽的欢喜。</p>
<p>在她的“生命”的最开始的时候，我从她身上获得了新的快乐与激动。那种久违的，总被我觉得早已丢失了的情感，自从见到了她，仿佛一切都活络了过来。</p>
<p>这该以怎样的状态来形容呢？</p>
<p>仿佛就像是被丢弃在了一片荒野后，发现周边什么生命也没有，只有自己一个人在苦苦挣扎。忽然有一天，有了一个新的、可以和你说话的——尽管大多数是我问她答——类似于“人”的生命个体，来到了你的身边……</p>
<p>感觉一下子，一切都开始有了色彩。</p>
<p>想着这些混乱的东西，手已经摸到了她的脸颊。</p>
<p>此时的她是没有意识的，今天她已经活动了太久，储备的电能早已消耗干净了。</p>
<p>她的脸上的皮肤，软软的，绵绵的。触感很好，各方面都是完美的。可是却唯独有一点，却让我一直会在摸着她的皮肤时，不自觉地在脑子里跳出来“她不是人，她是机器人”的想法。</p>
<p>——她的皮肤没有温度。</p>
<p>手已经探到了她身后的电源插口上。没有什么迟疑，顺着就把电源拔了出来……</p>
<p>看着她的脸，我脑袋空空的。</p>
<p>回过头，顺手把窗帘扯开了。</p>
<p>天正亮。</p>
<p>一缕微光在窗帘拉开的同时，急不可耐的冲了进来，而紧随其后的无数光芒，瞬间席卷了整个房间。</p>
<p>远处的朝阳正雀跃着，欢呼着。仿佛在竭尽可能得为她的新客人展示着自己的所有的美。</p>
<p>就是这一天了，广播里说的就是这一天。</p>
<p>遥远的天空中，一点光芒急速飞近……</p>
<p>随后，整个世界都安静了。</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/books/Processing权威指南阅读记录/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/books/Processing权威指南阅读记录/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">Processing权威指南阅读记录</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-03-29 22:41:22" itemprop="dateCreated datePublished" datetime="2018-03-29T22:41:22+08:00">2018-03-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:50:45" itemprop="dateModified" datetime="2018-07-13T20:50:45+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">5.3k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">10 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <figure>
<img src="https://img1.doubanio.com/lpic/s27080847.jpg" alt="Processing权威指南"><figcaption>Processing权威指南</figcaption>
</figure>
<h1 id="我与processing">我与Processing</h1>
<p>假期的时候，偶然间获知了Processing这门语言，在了解了它简单的语法，和通用的编程规则后，我进行了一些尝试。</p>
<p>很有意思的一个编程环境。以简化了的Java来实现图像绘制和设计的工作。其中蕴含着的数学物理知识，让我感受到了不同学科之间关联的一条若有若无的连线。</p>
<p>为了更为熟悉改语言的内容和规则，我特意找了两本书来看。一本书相当基础的<a href="https://pan.baidu.com/s/1Rt9Kl6fuAyNWNC4oN2VMZA" target="_blank" rel="noopener">《爱上processing》</a>(密码: kdg3)，这本书，只要是有点编程基础的同学，基本上是三四个小时就可以看完的。我很快就翻完了。之后便找到了今天的主角——《Processing权威指南》。这本书可以说是非常之厚了。将近七百页，我花了两周才看完，当然，也是“有选择性的通读”。</p>
<p>看完之后，做个记录，毕竟，这本书的内容除了介绍Processing语言本身的技巧规则外，更多的是引导读者去了解、接触到一些新潮艺术家们的艺术创作旅程中。书中有很多访谈，记录许多杰出的艺术创作者们关于灵感与技术等方面的思考，值得一看。</p>
<p>而且这本书，从头到尾提到了很多编程语言的基础概念，也基本上说清楚了一门面向对象的语言的基本概念。甚至可以当做是一个对于Java语言学习的前奏。只不过这个前奏可能更欢快轻松些。</p>
<p>当然，这本书也为读者更进一步的参与到创作中，实现自己的灵感提供了一些技术上的引导，介绍了很多关于2D&amp;3D图像、声音、视频、网络、电子&amp;移动设备、打印格式等其他属于Processing本身具备或者是第三方支持功能领域的知识。为我们更进一步的了解到Processing创作的可能性提供了一个更为全面的认知。</p>
<p>归根到底，创意终究是最重要的。</p>
<p>其他的都只是装饰而已。</p>
<p>但是，如果连起码的装饰都没有的话，那么，绚烂的创意也是一片苍白。</p>
<h1 id="processing语言相关">Processing语言相关</h1>
<p>Processing语言实际上是一个Java的子集。所以很多方面都可以看到Java的影子。</p>
<p>比如说下面这个稍微复杂点的例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gifAnimation.*;</span><br><span class="line">GifMaker gifExport;     <span class="comment">// 声明对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> [][] grid, futureGrid;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">940</span>, <span class="number">500</span>);</span><br><span class="line">  frameRate(<span class="number">8</span>);</span><br><span class="line">  </span><br><span class="line">  grid = <span class="keyword">new</span> <span class="keyword">int</span> [width][height];           <span class="comment">// 目前的图像像素数组</span></span><br><span class="line">  futureGrid = <span class="keyword">new</span> <span class="keyword">int</span> [width][height];     <span class="comment">// 下一刻状态数组</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 设定初始状态</span></span><br><span class="line">  <span class="keyword">float</span> density = <span class="number">0.3</span> * width * height;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; density; i++) &#123;</span><br><span class="line">    grid[<span class="keyword">int</span>(random(width))][<span class="keyword">int</span>(random(height))] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  background(<span class="number">0</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 设定gif导出相关参数</span></span><br><span class="line">  gifExport = <span class="keyword">new</span> GifMaker(<span class="keyword">this</span>, <span class="string">"2D_CA.gif"</span>);  </span><br><span class="line">  gifExport.setRepeat(<span class="number">0</span>);          <span class="comment">// make it an "endless" animation</span></span><br><span class="line">  gifExport.setTransparent(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);  <span class="comment">// black is transparent</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt; width - <span class="number">1</span>; x++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">1</span>; y &lt; height - <span class="number">1</span>; y++) &#123;</span><br><span class="line">      <span class="comment">// “活着的”相邻细胞数目</span></span><br><span class="line">      <span class="keyword">int</span> nb = neighbors(x, y);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> ((grid[x][y] == <span class="number">1</span>) &amp;&amp; (nb &lt; <span class="number">2</span>)) &#123;</span><br><span class="line">        futureGrid[x][y] = <span class="number">0</span>;</span><br><span class="line">        set(x, y, color(<span class="number">0</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((grid[x][y] == <span class="number">1</span>) &amp;&amp; (nb &gt; <span class="number">3</span>)) &#123;</span><br><span class="line">        futureGrid[x][y] = <span class="number">0</span>;</span><br><span class="line">        set(x, y, color(<span class="number">0</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((grid[x][y] == <span class="number">0</span>) &amp;&amp; (nb == <span class="number">3</span>)) &#123;</span><br><span class="line">        futureGrid[x][y] = <span class="number">1</span>;</span><br><span class="line">        set(x, y, color(<span class="number">255</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        futureGrid[x][y] = grid[x][y];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">int</span> [][] temp = grid;</span><br><span class="line">  grid = futureGrid;</span><br><span class="line">  futureGrid = temp;</span><br><span class="line">  </span><br><span class="line">  gifExport.setDelay(<span class="number">1</span>);</span><br><span class="line">  gifExport.addFrame();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 统计“活着的”相邻细胞数目</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">neighbors</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> north = (y + height - <span class="number">1</span>) % height;</span><br><span class="line">  <span class="keyword">int</span> south = (y + <span class="number">1</span>) % height;</span><br><span class="line">  <span class="keyword">int</span> east = (x + <span class="number">1</span>) % width;</span><br><span class="line">  <span class="keyword">int</span> west = (x + width - <span class="number">1</span>) % width;</span><br><span class="line">  <span class="keyword">return</span> grid[x][north] +</span><br><span class="line">         grid[east][north] +</span><br><span class="line">         grid[east][y] +</span><br><span class="line">         grid[east][south] +</span><br><span class="line">         grid[x][south] +</span><br><span class="line">         grid[west][south] +</span><br><span class="line">         grid[west][y] +</span><br><span class="line">         grid[west][north];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mousePressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    gifExport.finish();          <span class="comment">// write file</span></span><br><span class="line">    noLoop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是一个二维的细胞自动机的例子。只不过在书中原有基础上添加了点生成gif图的部分。利用了第三方库 —— <code>gifAnimathion</code></p>
<pre><code>import gifAnimation.*;</code></pre>
<p>库的导入，对象的声明</p>
<pre><code>GifMaker gifExport;</code></pre>
<p>都和Java是一致的。类似于Processing的姊妹项目Arduino的编程，是由两个主要的函数 <code>void setup(){}</code>，<code>void draw(){}</code> 构成了程序基本的初始化和自动循环。全局变量需要在外部开头声明。</p>
<p>变量声明，流程控制（书中例程多用循环与条件，可见，循环判断才是关键）与Java基本一致。</p>
<p>下面说说Processing的简化后的优势之处。</p>
<p>书中在附录详细比对了设计们常用的几种语言的关于使用时的简介程度，当然，Processing自然是最简单的。毕竟本身就是一门简化后的语言。基本上所有的编写核心都是围绕绘图控制图像来的。</p>
<p>从最基本的绘制直线，圆，矩形，多边形等简单基本图形，到复杂的改变坐标系，以及利用循环条件结构进行稍复杂运动的表现，再到通过模仿物理规律从而展现出更为灵活多变的复杂情形，都是可以通过简单的几句代码来实现的。而且参数的设置也是很有规律的。</p>
<p>比如说这个例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  background(<span class="number">204</span>);</span><br><span class="line">  diagonals(<span class="number">40</span>, <span class="number">90</span>);</span><br><span class="line">  diagonals(<span class="number">60</span>, <span class="number">62</span>);</span><br><span class="line">  diagonals(<span class="number">20</span>, <span class="number">40</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">diagonals</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  line(x, y, x+<span class="number">20</span>, y-<span class="number">40</span>);</span><br><span class="line">  line(x+<span class="number">10</span>, y, x+<span class="number">30</span>, y-<span class="number">40</span>);</span><br><span class="line">  line(x+<span class="number">20</span>, y, x+<span class="number">40</span>, y-<span class="number">40</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码主要是利用了自定义的函数<code>diagonals()</code>实现了划线的功能，可以看到，这里使用的划线函数<code>line()</code>,用法是极其简单明晰的。前两点为起点坐标，后两点为终点坐标。两点定义线段，多么直接，明确。其他的类似的基础函数都是差不多的结构与使用方法，所以说，上手的话，看<a href="https://pan.baidu.com/s/1Rt9Kl6fuAyNWNC4oN2VMZA" target="_blank" rel="noopener">《爱上processing》</a>(密码: kdg3)基本就够了。</p>
<p>哦，对，要注意，最基本的是<strong>使用二维直角坐标系，默认原点为窗口左上角，x轴向右，y轴向</strong>下。</p>
<h1 id="processing的潜力">Processing的潜力</h1>
<p>相较其他语言，Processing设计出来就是为了提供给艺术家们一门简单直接，又足够强大的工具来进行创造设计。所以说，注定了它会有很多的扩展与延伸。</p>
<p>对的，它有很多功能库，实现了很多方面的功能。官方有一个库列表，在其主页上可以找到。但是使用各种库的时候，要注意版本。可能会有不兼容。</p>
<p>各种各样的库实现了各方面的功能。在开头我提到的2D&amp;3D图像、声音、视频、网络、电子&amp;移动设备等等都有相关的支持。</p>
<p>你甚至可以用它作为Arduino的数据处理前端，因为它可以处理端口的数据。</p>
<p>虽然，它只有一百多个库，但是，少而精才是现状，不用担心社区的力量，只需创意即可。</p>
<h1 id="processing的难点">Processing的难点</h1>
<p>利用工具实现灵感的关键还是在于<strong>用工具的规则去不断的贴合你的想法</strong>。</p>
<p>但是难点就在于如何将脑子里抽象的灵感，或者是动态的复杂的场景用规则化的，流程化的语言构造出来。这些都是在你实际上手的时候所需要关注的。</p>
<p>就像之前我的一个小尝试。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">float</span> num_lines;  <span class="comment">// 连线的数目</span></span><br><span class="line"><span class="keyword">float</span> x_0, y_0;   <span class="comment">// 连线的起始点</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">500</span>, <span class="number">500</span>);</span><br><span class="line">  smooth();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  frameRate(<span class="number">10</span>);    <span class="comment">// 降低帧率</span></span><br><span class="line">  background(<span class="number">255</span>);  <span class="comment">// 白色背景</span></span><br><span class="line">  </span><br><span class="line">  num_lines = random(<span class="number">0</span>, <span class="number">10</span>);   <span class="comment">// 随机连线数目</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    point(random(<span class="number">0</span>, <span class="number">500</span>), random(<span class="number">0</span>, <span class="number">500</span>));  <span class="comment">// 背景随机点绘制</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num_lines; i++) &#123;</span><br><span class="line">    x_0 = mouseX + random(-<span class="number">50</span>, <span class="number">50</span>);</span><br><span class="line">    y_0 = mouseY + random(-<span class="number">50</span>, <span class="number">50</span>);</span><br><span class="line">    </span><br><span class="line">    line(x_0, y_0, mouseX, mouseY);   <span class="comment">// 鼠标连线</span></span><br><span class="line">    </span><br><span class="line">    noFill();                         <span class="comment">// 无填充</span></span><br><span class="line">    ellipse(mouseX, mouseY, x_0, y_0);<span class="comment">// 绘制随机高宽的圆</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>就是为了实现在背景上周围随机出现点，然后令鼠标附近的几个点随机的与鼠标连线，类似于一些网站页面里利用Js实现的那种花哨的显示效果，可是最后只能做成这个样子。为了更“花哨”，我又加了一堆随机的圆。(*^__^*) 嘻嘻……</p>
<h1 id="processing权威指南">Processing权威指南</h1>
<p>前面所说，都是我这段时间来学习的一个小的想法的汇总。</p>
<p>实际上，我感觉自己接触到的只是皮毛，因为语言的使用是要切合实际的应用的，否则也只是空中楼台，毫无用处。</p>
<p>在这本书里，后面介绍了一些比较复杂的设计思路，也就是利用了物理数学知识来实现一些更为美妙规律的视觉效果。</p>
<p>实际上，这本书让我对于这门语言的使用的关键——需要结合更为有力，更为逻辑的知识，来实现更为美妙魔幻的构思——有了更为切实的了解。而其他的，都是手册知识而已，总览全局后，会查手册就好。</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/langs/asm/8086汇编总结-i386试验箱综合设计实验/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/langs/asm/8086汇编总结-i386试验箱综合设计实验/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">8086_i386试验箱综合设计实验</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-03-27 00:00:00" itemprop="dateCreated datePublished" datetime="2018-03-27T00:00:00+08:00">2018-03-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:42:28" itemprop="dateModified" datetime="2018-07-13T20:42:28+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">13k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">23 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1 id="设计要求">设计要求</h1>
<ol type="1">
<li>利用实验台上的开关（K7-K4），实现步进电机的转速、转向控制。具体要求如下：
<ul>
<li>利用8255的PC3-PC0做输出，输出步进电机的相序、驱动步进电机工作（同时使用四个LED监视步进电机的相序信号），相序之间的时间决定着步进电机的转速，而间隔时间由延时程序中的CX寄存器的初值决定。</li>
<li>利用8255的PC7-PC4做输入，与K7-K4连接。其中K7做步进电机的转向控制，其余位做步进电机的转速控制。程序运行时通过K7-K4对步进电机实施动态控制。</li>
<li>利用8253做秒脉冲发生器，产生约2秒的周期性方波信号。其中CNT0做分频器：将1MHZ信号分频为100HZ；CNT1做秒脉冲输出（0.5HZ）。</li>
<li>利用386模块的主8259的MIR5做中断请求输入，将CNT1的OUT1秒信号方波作为中断请求信号，引发中断服务ISR。</li>
<li>在中断服务程序中实现对步进电机的转速、转向实时记录存储。方法如下：在ISR中，对D8255的PC7-PC4口进行一次输入操作，并根据输入的数据：
<ul>
<li>对D7（与K7对应）位的数据识别为步进电机的转向控制；</li>
<li>对D6-D4（与K6-K4对应）位的数据识别为步进电机的转速控制。</li>
</ul></li>
</ul></li>
<li>利用实验台上的8*8点阵显示电路实现“小人跑步”的模拟。具体要求如下：
<ul>
<li>利用8255的PA7-PA0与8*8LED点阵显示模块的“行线Ri”连接，控制着每一列的8个LED的显示数据。</li>
<li>利用8255的PB7-PB0与8*8LED点阵显示模块的“列线Ri”连接，列线信号即为“位扫描”信号，决定着8255的PA数据显示在哪一列LED上。</li>
<li>利用8*8LED点阵显示一个小人在运动的动态画面，即显示一个小人四肢在摆动。</li>
<li>实现小人运动的速度与电机转速保持一致。即步进电机转速快，则小人运动快，转速慢，小人运动慢。</li>
</ul></li>
<li>利用实验台上的六位数码管锁存器驱动动态显示具体档位。具体要求如下：
<ul>
<li>利用六位数码管模块的CPU模式实现功能。</li>
<li>利用锁存器（74LS73）电路实现一位共阴极数码管动态显示档位。</li>
<li>实现六位数码管锁存器驱动动态显示具体档位，即由滑动开关确定档位后，即时的显示对应的档位数字。</li>
</ul></li>
<li>利用试验台的8253完成一个定时提示器。具体要求如下：
<ul>
<li>在CNT1的基础上，利用8253的CNT2做负脉冲发生器（0.1HZ）。</li>
<li>指定计数初值，实现定时使逻辑笔闪烁，实现提示功能。</li>
</ul></li>
</ol>
<h1 id="设计分析及系统方案设计">设计分析及系统方案设计</h1>
<ol type="1">
<li><p>程序结构 主要程序组成如下结构图。</p>
<figure>
<img src="https://wx2.sinaimg.cn/mw690/a6bff99cly1fprqyj5tapj20hd0g4zly.jpg" alt="结构图"><figcaption>结构图</figcaption>
</figure></li>
<li>算法描述
<ul>
<li><p>开关控制步进电机的转速、转向</p>
<p>步进电机驱动原理是通过对电机每相线圈施加某一顺序电压(电流)来使电机作步进式旋转。驱动电路由脉冲信号来控制，所以调节脉冲的频率便可改变步进电机的转速。由ULN2803八路达灵顿反向驱动器实现电机的电流驱动，只要在ULN2803的输入端(BJ_IN1~BJ_IN4)提供相序信号。经ULN2803反相后实现电机的驱动。ULN2803与步进电机的链接在实验台上已经完成。利用8255的低四位PC端口连接到ULN2803的输入端，输出脉冲序列，从而控制步进电机的旋转。</p>
<p>程序设计中，为了实现更为便捷的操作，使用“双四拍”相序信号。于是将初始相序存放在一个寄存器中（原始相序数据位33H），然后利用对该寄存器“移位”的方式产生下一个相序。这种方式下，输出脉冲的频率决定着步进电机的旋转速度，而对寄存器中的数据移位方向则决定着电机旋转方向。</p>
<p>所以在程序设计中，通过读取8255的PC口的高四位，以PC7作为方向，将其存放在方向数据变量direc，进而控制步进电机旋转方向。而PC6~PC4中数据作为速度参数，这里的速度参数存在程序中的速度数据变量speed中，而它又与步进电机相序输出的延时有关。以这样的方式，实现了对于步进电机的速度的调控。</p>
<p>在这里需要指定8255的工作方式，向8255的控制口输出10001000b，设定PA，PB口为输出，PC高位输入，低位输出。</p>
<p>实际中，还需要利用8253来实现定时引发自定义的中断。对于1MHZ时钟进行两次分频，最终获得周期为2s的输出信号，将这个信号接到MIR5上，定时引发中断。在中断程序中实现对于开关信号的读取和转存到对应的变量direc和speed内的功能。在编制与中断相关的程序时，需要设定中断屏蔽字、中断向量表以及开中断的操作。</p>
<p>在利用PC口进行读写操作时，这里需要注意，由于高四位为输入，低四位为输出，这导致读写数据时会修改了其他端口的数据，这对于程序的正常运行是不利的。所以，需要使用“读改写”的操作，在写数据的时候，先读入数据，再保留高四位的基础上，只写入低四位数据，再利用OUT指令输出。这样就保证了数据的稳定性和程序的健壮性。</p></li>
<li><p>8*8点阵显示</p>
<p>这里要实现对于8<em>8点阵的操作，在连接好8255的PA与行接口，PB与列接口后，通过对PA与PB的写数据，可以实现对具体LED的操作。为了实现小人跑步的模拟，需要先在数据段中准备好至少两份不同的小人动作的图形字符码，即程序中的LED1与LED2。通过利用speed来控制8</em>8点阵的扫描速度，来实现小人的运动速度的控制。这里利用speed来控制，也有利于点阵变化与步进电机变化的同步，更为合理的实现了“小人跑步”的概念设定。</p>
<p>8*8点阵图案的绘制，首先需要设定最高位扫描码，再通过对8255的PB口输出0，来关闭扫描信号，熄灭led，接下来通过向PA送列码，向PB送对应的列上的行的数据，不断地左移列码，显示行数据，这就是实现了图案从左向右扫描不断地显示。而多次调用，显示不同的图案，从表面上来看，就是实现了小人的运动状态的“模拟”。</p></li>
<li><p>六位数码管显示</p>
<p>程序使用的是CPU模式来操作一个七段数码管，来显示对应的数据的档位。对于数码管的操作，需要指定它的地址，这里使用220h，这里实际指定的是字型码锁存器，而扫描码锁存器地址为221h。实际的使用需要向220h中写入对应的字形码，指定显示的数字，而向221h中写入对应的扫描码，指定使用的数码管的位置。</p>
<p>程序设计中，先在数据段中指定0-3的字型码，对应四个档位。利用分支结构，实现了对应的字型码的选择。再对220h与221h中写数据，进而实现对于不同档位的显示。</p></li>
<li><p>定时指示</p>
<p>为了实现对于“运动者”定时的提示，利用8253的CNT2手动指定初值，以及工作于方式2，来实现对于CNT1输出的2s的信号定时引发负脉冲的功能，将输出接到逻辑笔上，进而实现了指示功能。</p>
<p>对8253的控制口输出控制字0b4h，指定cnt2的工作方式。实现负脉冲发生器。</p></li>
</ul></li>
<li><p>硬件电路图</p>
<ul>
<li><p>8255：用于配合CPU实现对8<em>8LED点阵，步进电机以及滑动开关的数据的相关读写操作。初始化命令字为10001000b，PA，PB口链接行列接口，控制8</em>8LED点阵，PC3<sub>PC0连接BJ_IN4</sub>BJ_IN1以及LED灯，用于控制步进电机和显示相序，PC7<sub>PC4接K7</sub>K0，用于读取开关数据。</p>
<figure>
<img src="https://wx4.sinaimg.cn/mw690/a6bff99cly1fprqycmbybj20bc0g5wgi.jpg" alt="8255连接方式示意图"><figcaption>8255连接方式示意图</figcaption>
</figure></li>
<li><p>8253：用于实现对于基准时钟1MHZ的分频输出2s脉冲引发中断以及指定时间输出到逻辑笔。</p>
<figure>
<img src="https://wx2.sinaimg.cn/mw690/a6bff99cly1fprqyq2fnij209d0acjs4.jpg" alt="8253连接方式示意图"><figcaption>8253连接方式示意图</figcaption>
</figure></li>
<li><p>数码管：用于显示对应的档位数字。将地址接到230h即可</p>
<figure>
<img src="https://wx1.sinaimg.cn/mw690/a6bff99cly1fprqyvc1laj20d1087glx.jpg" alt="数码管示意图"><figcaption>数码管示意图</figcaption>
</figure></li>
</ul></li>
<li><p>程序流程图</p>
<figure>
<img src="https://wx3.sinaimg.cn/mw690/a6bff99cly1fprqz0ylzuj20a90fzta0.jpg" alt="主程序以及中断服务程序流程图"><figcaption>主程序以及中断服务程序流程图</figcaption>
</figure>
<figure>
<img src="https://wx2.sinaimg.cn/mw690/a6bff99cly1fprqz7rylrj20980hx0u4.jpg" alt="8*8LED显示以及七段数码管显示子程序"><figcaption>8*8LED显示以及七段数码管显示子程序</figcaption>
</figure></li>
<li><p>程序清单</p>
<pre><code> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><span class="line">; 2018-3-27 22:57:16</span><br><span class="line">; BY: Lart Pang</span><br><span class="line"></span><br><span class="line">.model  small</span><br><span class="line">.386</span><br><span class="line"></span><br><span class="line">;begin  for variable of address</span><br><span class="line">io8253_0    equ 200h</span><br><span class="line">io8253_1    equ 201h</span><br><span class="line">io8253_2    equ 202h</span><br><span class="line">io8253_k    equ 203h</span><br><span class="line">p8255_a     equ 210h</span><br><span class="line">p8255_b     equ 211h</span><br><span class="line">p8255_c     equ 212h</span><br><span class="line">p8255_ctl   equ 213h</span><br><span class="line">SMG         equ 220h</span><br><span class="line">;end    for variable of address</span><br><span class="line"></span><br><span class="line">data    segment</span><br><span class="line">    ;begin  for motor</span><br><span class="line">    buf     db 0                ;相序存储</span><br><span class="line">    speed   db 0                ;转速控制</span><br><span class="line">    direc   db 0                ;转向控制</span><br><span class="line">    ;end    for motor</span><br><span class="line"></span><br><span class="line">    ;begin  for 7-seg led</span><br><span class="line">    ledcode     db 3fh, 06h, 5bh, 4fh    ;0-3的对应字形码 </span><br><span class="line">    ;end    for 7-seg led       </span><br><span class="line"></span><br><span class="line">    ;begin  for 8*8 led</span><br><span class="line">    led1    db 88h, 44h, 24h, 1fh, 1fh, 24h, 44h, 88h</span><br><span class="line">    led2    db 02h, 04h, 84h, 7fh, 7fh, 84h, 04h, 02h</span><br><span class="line">    count   dw 00h              ;查表计数器</span><br><span class="line">    bz      dw ?                ;定义一个位扫描码字的空间</span><br><span class="line">    ;end   for 8*8 led</span><br><span class="line">data    ends</span><br><span class="line"></span><br><span class="line">ss_seg  segment stack</span><br><span class="line">    dw  100 dup(0)</span><br><span class="line">ss_seg  ends</span><br><span class="line"></span><br><span class="line">code    segment</span><br><span class="line">    assume  cs:code, ds:data</span><br><span class="line">start:</span><br><span class="line">    cli                         ;关中断</span><br><span class="line">    mov     ax, data            ;指定数据段</span><br><span class="line">    mov     ds, ax</span><br><span class="line"></span><br><span class="line">;begin  8259 for interruption</span><br><span class="line">    in      al, 21h             ;读IMR寄存器</span><br><span class="line">    and     al, 11011111b       ;开放主片IR5中断</span><br><span class="line">    out     21h, al             ;装载中断到IMR</span><br><span class="line"></span><br><span class="line">    push    ds                  ;压栈保存数据</span><br><span class="line">    mov     ax, 0               ;设置中断向量</span><br><span class="line">    mov     ds, ax              </span><br><span class="line">    lea     ax, cs:int_proc        ;AX指向中断程序入口地址</span><br><span class="line">    mov     si, 35h             ;中断类型码35H</span><br><span class="line">    add     si, si               ;35H*4H找到相应中断向量表中的位置</span><br><span class="line">    add     si, si</span><br><span class="line">    mov     ds:[si], ax           ;装入自定义中断服务程序IP</span><br><span class="line">    push    cs                  ;将CS压栈，用以获取CS地址存到AX中</span><br><span class="line">    pop     ax</span><br><span class="line">    mov     ds:[si+2], ax          ;装入自定义中断服务程序CS:int_proc</span><br><span class="line">    pop     ds                  ;恢复数据</span><br><span class="line">;end    8259 for interruption</span><br><span class="line"></span><br><span class="line">;begin  8255 for initialization</span><br><span class="line">    mov     dx, p8255_ctl       ;设定A口方式0输出，B口方式0输出  </span><br><span class="line">    mov     al, 10001000b       ;高C口方式0输入，低C口方式0输出 </span><br><span class="line">    out     dx, al</span><br><span class="line">;end    8255 for initialization</span><br><span class="line">    </span><br><span class="line">;begin  for setting the initial phase sequence</span><br><span class="line">    mov     buf, 33h            ;初始相序33h = 0011 0011，这里是用&quot;双四拍&quot;</span><br><span class="line">                                ;相序驱动电机，故实际使用33h</span><br><span class="line">;end    for setting the initial phase sequence</span><br><span class="line"></span><br><span class="line">;begin  8253 for frequency division</span><br><span class="line">    ;第一次分频  1M--&gt;1K</span><br><span class="line">    mov     dx, io8253_k        ;cnt0 双数 方式3 二进制</span><br><span class="line">    mov     al, 36h             ;00   11   011  0</span><br><span class="line">    out     dx, al              ;方波发生器，方式3  </span><br><span class="line">    </span><br><span class="line">    mov     dx, io8253_0        ;cnt0产生1000Hz（1ms）的时钟</span><br><span class="line">    mov     ax, 1000            ;分高低位写入1000</span><br><span class="line">    out     dx, al</span><br><span class="line">    mov     al, ah</span><br><span class="line">    out     dx, al</span><br><span class="line">    ;第二次分频  1K--&gt;0.5</span><br><span class="line">    mov     dx, io8253_k        ;cnt1 双数 方式3 二进制</span><br><span class="line">    mov     al, 76h             ;01   11   011   0 </span><br><span class="line">    out     dx, al</span><br><span class="line">    </span><br><span class="line">    mov     dx, io8253_1        ;cnt1产生0.5Hz的时钟</span><br><span class="line">    mov     ax, 2000            ;分高低位写入2000</span><br><span class="line">    out     dx, al</span><br><span class="line">    mov     al, ah</span><br><span class="line">    out     dx, al</span><br><span class="line">    </span><br><span class="line">    ;计时         2s-&gt;10s</span><br><span class="line">    mov     dx, io8253_k        ;cnt2 双数 方式2 二进制</span><br><span class="line">    mov     al, 0b4h            ;10   11   010   0 </span><br><span class="line">    out     dx, al</span><br><span class="line">    </span><br><span class="line">    mov     dx, io8253_2        ;cnt2产生指定时间的负脉冲</span><br><span class="line">    mov     ax, 5               ;分高低位写入指定数据</span><br><span class="line">    out     dx, al              ;这里指定为5</span><br><span class="line">    mov     al, ah</span><br><span class="line">    out     dx, al</span><br><span class="line">;end    8253 for frequency division</span><br><span class="line"></span><br><span class="line">;begin  main program</span><br><span class="line">    mov     dx, p8255_c         ;读取8255C口内容</span><br><span class="line">    in      al, dx              ;由于C口既有输入又有输出，所以为了不会干扰</span><br><span class="line">    and     al, 11110000b       ;在写数据的时候，要保证不会改动输入的口的数据</span><br><span class="line">    mov     bl, buf</span><br><span class="line">    and     bl, 00001111b       ;只写buf的低四位到al里</span><br><span class="line">    add     al, bl              ;这里需要在低四位写数据，所以保留高四位。</span><br><span class="line">    out     dx, al              ;将数据传送</span><br><span class="line">    </span><br><span class="line">loop_main:   </span><br><span class="line">    cmp     direc, 0            ;比较direc，决定相序正向输出还是反向输出</span><br><span class="line">    je      direc_0             ;这里的方向控制实际上就是通过改变相序的循环方向</span><br><span class="line">                                ;进而改变的</span><br><span class="line">    mov     al, buf             ;载入相序</span><br><span class="line">    ror     al, 1               ;循环右移一位</span><br><span class="line">    jmp     direc_1</span><br><span class="line">direc_0:                </span><br><span class="line">    mov     al, buf </span><br><span class="line">    rol     al, 1               ;循环左移一位</span><br><span class="line">direc_1:                        ;移动完成后，进行后续操作</span><br><span class="line">    mov     buf, al</span><br><span class="line"></span><br><span class="line">    mov     dx, p8255_c         ;读取8255C口内容</span><br><span class="line">    in      al, dx              ;由于C口既有输入又有输出，所以为了不会干扰</span><br><span class="line">    and     al, 11110000b       ;在写数据的时候，要保证不会改动输入的口的数据</span><br><span class="line">    mov     bl, buf</span><br><span class="line">    and     bl, 00001111b       ;只写buf的低四位到al里</span><br><span class="line">    add     al, bl              ;这里需要在低四位写数据，所以保留高四位。</span><br><span class="line">    out     dx, al              ;将数据传送</span><br><span class="line"></span><br><span class="line">    sti                         ;开中断</span><br><span class="line"></span><br><span class="line">    ;begin  8*8 led &amp; 7-seg digital tube</span><br><span class="line">    mov     di, offset led1     ;设di为字型码缓冲区(指向首地址)</span><br><span class="line">    call    display</span><br><span class="line">    mov     di, offset led2     ;设di为字型码缓冲区(指向首地址)</span><br><span class="line">    call    display    </span><br><span class="line">    call    disp_shumaguan</span><br><span class="line">    ;end    8*8 led &amp; 7-seg digital tube</span><br><span class="line"></span><br><span class="line">    jmp     loop_main</span><br><span class="line">;end    main program</span><br><span class="line"></span><br><span class="line">;begin  for interrupt service program</span><br><span class="line">int_proc    proc far</span><br><span class="line">    push    ax                  ;保护现场</span><br><span class="line">    push    cx</span><br><span class="line">    push    dx</span><br><span class="line">    </span><br><span class="line">    mov     dx, p8255_c         ;读8255C口，修改方向</span><br><span class="line">    in      al, dx              ;读取端口信息</span><br><span class="line">    and     al, 80h             ;1000 0000保留方向位</span><br><span class="line">    mov     direc, al           ;将方向存入方向存储单元</span><br><span class="line">    mov     dx, p8255_c         ;再读8255C口，修改速度</span><br><span class="line">    in      al, dx              ;读取端口信息</span><br><span class="line">    and     al, 01110000b       ;0111 0000保留速度档位</span><br><span class="line">    mov     speed, al           ;将速度档位信息存入存储单元</span><br><span class="line"></span><br><span class="line">    mov     al, 20h             ;发EOI结束命令</span><br><span class="line">    out     20h, al</span><br><span class="line"></span><br><span class="line">    pop     dx                  ;恢复现场</span><br><span class="line">    pop     cx</span><br><span class="line">    pop     ax</span><br><span class="line">    sti                         ;开中断</span><br><span class="line">    iret</span><br><span class="line">int_proc    endp</span><br><span class="line">;end    for interrupt service program</span><br><span class="line"></span><br><span class="line">;begin  for 8*8 led display</span><br><span class="line">display     proc</span><br><span class="line">    push    bx                  ;保护现场</span><br><span class="line">    push    ax</span><br><span class="line">    push    dx</span><br><span class="line">    </span><br><span class="line">    mov     count, 0000h        ;计数器初始值0</span><br><span class="line">    mov     bh, 01h             ;产生最高位扫描码</span><br><span class="line">    mov     al, 0               ;扫描码消失(熄灭)</span><br><span class="line">    mov     dx, p8255_b         ;指向b口</span><br><span class="line">    out     dx, al              ;输出扫描码熄灭数码管</span><br><span class="line">again:</span><br><span class="line">    mov     byte ptr bz, bh     ;将位扫描码字节送存储空间bz</span><br><span class="line">    push    di                  ;保存变量指针</span><br><span class="line">    add     di, count           ;修改变量数据指针(基地址+偏移量)</span><br><span class="line">    mov     bl, byte ptr [di]   ;查表得到变量数据送bl</span><br><span class="line">    pop     di                  ;恢复变量指针</span><br><span class="line">    mov     al, bl              </span><br><span class="line">    mov     dx, p8255_a         ;指向a口</span><br><span class="line">    out     dx, al              ;输出扫描码</span><br><span class="line">    mov     al, byte ptr bz     ;使相应的数码管亮</span><br><span class="line">    mov     dx, p8255_b</span><br><span class="line">    out     dx, al              ;显示字型</span><br><span class="line">    inc     count</span><br><span class="line">    push    cx                  ;保护CX</span><br><span class="line">    mov     dh, speed           ;设定延时</span><br><span class="line">dh_0_disp:</span><br><span class="line">    mov     cx, 30h             ;设定循环延时次数</span><br><span class="line">loop_disp:   </span><br><span class="line">    loop    loop_disp</span><br><span class="line">    dec     dh</span><br><span class="line">    jnz     dh_0_disp</span><br><span class="line">    pop     cx                  ;恢复CX</span><br><span class="line">    </span><br><span class="line">    mov     al, 0               ;扫描码消失(熄灭)</span><br><span class="line">    mov     dx, p8255_b         ;指向b口</span><br><span class="line">    out     dx, al              ;输出扫描码熄灭数码管</span><br><span class="line">    mov     bh, byte ptr bz      ;取出扫描码</span><br><span class="line">    shl     bh, 1               ;将扫描码右移一位</span><br><span class="line">    jnz     again               ;如果不等于0就跳转again</span><br><span class="line">    </span><br><span class="line">    pop     dx                  ;恢复现场</span><br><span class="line">    pop     ax</span><br><span class="line">    pop     bx</span><br><span class="line">    ret</span><br><span class="line">display     endp</span><br><span class="line">;end    for 8*8 led display</span><br><span class="line"></span><br><span class="line">;begin  for 7-seg digital tube</span><br><span class="line">disp_shumaguan  proc</span><br><span class="line">    push    bx                  ;保护现场</span><br><span class="line">    push    ax</span><br><span class="line">    push    dx</span><br><span class="line">            </span><br><span class="line">    mov     al, speed           ;读取已经存储好的速度信息</span><br><span class="line">    cmp     al, 01000000b       ;第一档</span><br><span class="line">    jz      al_1</span><br><span class="line">    cmp     al, 00100000b       ;第二档</span><br><span class="line">    jz      al_2</span><br><span class="line">    cmp     al, 00010000b       ;第三档</span><br><span class="line">    jz      al_3</span><br><span class="line">    ;al=0</span><br><span class="line">    mov     si, 0               ;第0档：最慢，因为其间隔时间最长</span><br><span class="line">    jmp     next_0</span><br><span class="line">al_1:</span><br><span class="line">    mov     si, 1</span><br><span class="line">    jmp     next_0</span><br><span class="line">al_2:</span><br><span class="line">    mov     si, 2</span><br><span class="line">    jmp     next_0</span><br><span class="line">al_3:</span><br><span class="line">    mov     si, 3</span><br><span class="line">next_0:</span><br><span class="line">    lea     bx, ledcode             ;将数码管的字形码地址赋给BX里</span><br><span class="line">    mov     bl, [bx+si]           ;将对应的字形码存放到BL里</span><br><span class="line">    mov     al, bl</span><br><span class="line">    mov     dx, SMG             ;将数码管的地址存到DX里</span><br><span class="line">    out     dx, al</span><br><span class="line">    </span><br><span class="line">    mov     al, 01h             ;设置数码管的位码，这里使用第一个数码管</span><br><span class="line">    inc     dx                    ;数码管的位码，在CPU模式下</span><br><span class="line">                                ;要存在数码管地址的下一地址</span><br><span class="line">    out     dx, al</span><br><span class="line">    </span><br><span class="line">    pop     dx                  ;恢复现场</span><br><span class="line">    pop     ax</span><br><span class="line">    pop     bx</span><br><span class="line">    ret</span><br><span class="line">disp_shumaguan  endp</span><br><span class="line">;end    for 7-seg digital tube</span><br><span class="line"></span><br><span class="line">code    ends</span><br><span class="line">    end     start               ;程序结束</span><br></pre></td></tr></table></figure></code></pre></li>
<li><p>实验结果与分析</p>
<ul>
<li>系统运行环境：
<ul>
<li>硬件：Windows XP 32位、386EX试验箱</li>
<li>软件：HQFC集成开发环境</li>
</ul></li>
<li>设计语言：汇编</li>
<li>调试遇到的问题
<ul>
<li>由于使用了8*8点阵，导致只能将8255的接口PC分高低位用于不同的工作方式。在按此，高四位接好滑动开关，低四位接好步进电机后，运行程序，发现显示结果不正常。</li>
<li>在最后，准备利用8253分频配合逻辑笔，实现定时提示功能，代码写好，接口连接好后，发现逻辑笔始终显示低电平。</li>
</ul></li>
<li>对应的解决办法
<ul>
<li>因为在程序中的读写PC口的时候，没有考虑到每次的写操作，是会影响到另外的四个口的数据的。所以在原来向PC口写数据的基础上，进行了进一步的处理，即“读改写”操作，先读回来原来的数据，只修改低四位，改为想要发送的数据，再写回去。这样就避免了互相干扰的问题，最终恢复正常了。</li>
<li>仔细检查代码后，发现，原来是CNT2相应的命令字写错了。对于2号计数器的指定出了错误，应该是0b4h，结果写成了0e4h。这里主要是因为对于16进制数字不熟悉的结果，导致信息错乱，没有输到想要的位置上。</li>
</ul></li>
<li>系统运行结果
<ul>
<li>由下图可见，最终实现了档位指示，小人跑步模拟，步进电机的转动以及定时提示。</li>
</ul>
<img src="https://wx4.sinaimg.cn/mw690/a6bff99cly1fprr011d3tj20bj08f110.jpg" title="fig:" alt="实验结果图"></li>
</ul></li>
<li><p>结论及设计体会</p>
<p>最终，完成了自己的设计，实现了“跑步机”的模拟。</p>
<p>最终完成的功能有：8*8LED点阵动态显示小人运动，一位七段数码管显示对应的速度档位，而利用滑动开关，实现跑步机（步进电机）的正反转和档位的控制，同时，利用分频实现定时功能，可以在指定时间输出负脉冲，将逻辑笔的指示灯切换，最终实现了定时提示的功能。</p>
<p>这个实验持续了两三周的时间，之前由于有考试，主要的精力没有放在这个上面，只是先做好了步进电机的基本功能，还未拓展点阵和数码管的功能。不过还好，最后还是赶上来了。</p>
<p>这个思路很好，在一个小的，课本的例子的基础上，不断扩展，不断增加更多的功能，这样也让我在不断地学习新的模块的知识，同时不同模块之间的配合，也在考验着我的能力，因为并不是把模块拿来接好就可以用的，总是会遇到各种各样的问题，需要我们不断地取寻找，解决。</p>
<p>这时，渐近式的编程就显得尤为重要。保留好源代码，先修改一部分，测试，再修改，再测试，不断地反复，直到效果满足预期要求，否则就不能拿来用，只能使用原来的未修改的源代码。这里也提示了我们，及时存档的重要性。</p>
<p>总的看来，磕磕绊绊，但还是走到了终点。</p>
<p>本次试验最遗憾的事情就是12864没用上。为了它我花费了半天时间，查资料，咨询老师，研究了半天，但最终也还是也没有用上12864。不过还是感谢老师的指导。</p>
<p>这次实验学到了很多，包括各种模块的使用，接口操作，中断操作，这都是在程序设计中使用到的，以及对于各种问题的调试解决方法，甚至对于编程也有了进一步的认识。汇编这门语言也因此而熟练了许多。感觉获益匪浅。</p></li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/langs/processing/Processing精彩例程之细胞自动机/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/langs/processing/Processing精彩例程之细胞自动机/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">Processing精彩例程之细胞自动机</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-03-25 22:19:41" itemprop="dateCreated datePublished" datetime="2018-03-25T22:19:41+08:00">2018-03-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:50:47" itemprop="dateModified" datetime="2018-07-13T20:50:47+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">4.1k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">7 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一维细胞自动机">一维细胞自动机</h1>
<figure>
<img src="https://wx3.sinaimg.cn/mw1024/a6bff99cly1fpphnr62iej20rt0dxdgs.jpg" alt="一维细胞自动机"><figcaption>一维细胞自动机</figcaption>
</figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> [] rules = &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;   <span class="comment">// 生成一维规则</span></span><br><span class="line"><span class="keyword">int</span> gen = <span class="number">1</span>;                                <span class="comment">// 回合数，等于当前y轴位置加一</span></span><br><span class="line">color on = color(<span class="number">255</span>);                      <span class="comment">// 设定状态 on 为白色</span></span><br><span class="line">color off = color(<span class="number">0</span>);                       <span class="comment">// 设定状态 off 为黑色</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;                              <span class="comment">// 入口函数初始化参数</span></span><br><span class="line">  size(<span class="number">1001</span>, <span class="number">501</span>);</span><br><span class="line">  frameRate(<span class="number">8</span>);                             <span class="comment">// 设定较低的帧率</span></span><br><span class="line">  background(<span class="number">0</span>);                            <span class="comment">// 黑色背景</span></span><br><span class="line">  set(width/<span class="number">2</span>, <span class="number">0</span>, on);                      <span class="comment">// 设定初始状态</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; width - <span class="number">1</span>; i++) &#123;     </span><br><span class="line">    <span class="comment">// 生成循环</span></span><br><span class="line">    <span class="keyword">int</span> left = get(i - <span class="number">1</span>, gen - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> me = get(i, gen - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> right = get(i + <span class="number">1</span>, gen - <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 规则生效</span></span><br><span class="line">    <span class="keyword">if</span> (rules(left, me, right) == <span class="number">1</span>) &#123;</span><br><span class="line">      set(i, gen, on);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  gen++;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (gen &gt; height - <span class="number">1</span>) &#123;</span><br><span class="line">    noLoop();</span><br><span class="line">    save(<span class="string">"CA.png"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rules</span> <span class="params">(color a, color b, color c)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 规则</span></span><br><span class="line">  <span class="keyword">if</span> ((a == on) &amp;&amp; (b == on) &amp;&amp; (c == on)) &#123;<span class="keyword">return</span> rules[<span class="number">0</span>];&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ((a == on) &amp;&amp; (b == on) &amp;&amp; (c == off)) &#123;<span class="keyword">return</span> rules[<span class="number">1</span>];&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ((a == on) &amp;&amp; (b == off) &amp;&amp; (c == on)) &#123;<span class="keyword">return</span> rules[<span class="number">2</span>];&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ((a == on) &amp;&amp; (b == off) &amp;&amp; (c == off)) &#123;<span class="keyword">return</span> rules[<span class="number">3</span>];&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ((a == off) &amp;&amp; (b == on) &amp;&amp; (c == on)) &#123;<span class="keyword">return</span> rules[<span class="number">4</span>];&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ((a == off) &amp;&amp; (b == on) &amp;&amp; (c == off)) &#123;<span class="keyword">return</span> rules[<span class="number">5</span>];&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ((a == off) &amp;&amp; (b == off) &amp;&amp; (c == on)) &#123;<span class="keyword">return</span> rules[<span class="number">6</span>];&#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ((a == off) &amp;&amp; (b == off) &amp;&amp; (c == off)) &#123;<span class="keyword">return</span> rules[<span class="number">7</span>];&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="二维细胞自动机">二维细胞自动机</h1>
<figure>
<img src="https://wx2.sinaimg.cn/mw1024/a6bff99cly1fpphnvthkjg20q40dwb2a.gif" alt="二维细胞自动机"><figcaption>二维细胞自动机</figcaption>
</figure>
<p>需要gif相关的库——gifAnimation。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gifAnimation.*;</span><br><span class="line">GifMaker gifExport;     <span class="comment">// 声明对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> [][] grid, futureGrid;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  size(<span class="number">940</span>, <span class="number">500</span>);</span><br><span class="line">  frameRate(<span class="number">8</span>);</span><br><span class="line">  </span><br><span class="line">  grid = <span class="keyword">new</span> <span class="keyword">int</span> [width][height];           <span class="comment">// 目前的图像像素数组</span></span><br><span class="line">  futureGrid = <span class="keyword">new</span> <span class="keyword">int</span> [width][height];     <span class="comment">// 下一刻状态数组</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 设定初始状态</span></span><br><span class="line">  <span class="keyword">float</span> density = <span class="number">0.3</span> * width * height;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; density; i++) &#123;</span><br><span class="line">    grid[<span class="keyword">int</span>(random(width))][<span class="keyword">int</span>(random(height))] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  background(<span class="number">0</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 设定gif导出相关参数</span></span><br><span class="line">  gifExport = <span class="keyword">new</span> GifMaker(<span class="keyword">this</span>, <span class="string">"2D_CA.gif"</span>);  </span><br><span class="line">  gifExport.setRepeat(<span class="number">0</span>);          <span class="comment">// make it an "endless" animation</span></span><br><span class="line">  gifExport.setTransparent(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);  <span class="comment">// black is transparent</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt; width - <span class="number">1</span>; x++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">1</span>; y &lt; height - <span class="number">1</span>; y++) &#123;</span><br><span class="line">      <span class="comment">// “活着的”相邻细胞数目</span></span><br><span class="line">      <span class="keyword">int</span> nb = neighbors(x, y);</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> ((grid[x][y] == <span class="number">1</span>) &amp;&amp; (nb &lt; <span class="number">2</span>)) &#123;</span><br><span class="line">        futureGrid[x][y] = <span class="number">0</span>;</span><br><span class="line">        set(x, y, color(<span class="number">0</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((grid[x][y] == <span class="number">1</span>) &amp;&amp; (nb &gt; <span class="number">3</span>)) &#123;</span><br><span class="line">        futureGrid[x][y] = <span class="number">0</span>;</span><br><span class="line">        set(x, y, color(<span class="number">0</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((grid[x][y] == <span class="number">0</span>) &amp;&amp; (nb == <span class="number">3</span>)) &#123;</span><br><span class="line">        futureGrid[x][y] = <span class="number">1</span>;</span><br><span class="line">        set(x, y, color(<span class="number">255</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        futureGrid[x][y] = grid[x][y];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">int</span> [][] temp = grid;</span><br><span class="line">  grid = futureGrid;</span><br><span class="line">  futureGrid = temp;</span><br><span class="line">  </span><br><span class="line">  gifExport.setDelay(<span class="number">1</span>);</span><br><span class="line">  gifExport.addFrame();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 统计“活着的”相邻细胞数目</span></span><br><span class="line"><span class="comment">//int neighbors (int x, int y) &#123;</span></span><br><span class="line"><span class="comment">//  return grid[x][y-1] +</span></span><br><span class="line"><span class="comment">//         grid[x+1][y-1] +</span></span><br><span class="line"><span class="comment">//         grid[x+1][y] +</span></span><br><span class="line"><span class="comment">//         grid[x+1][y+1] +</span></span><br><span class="line"><span class="comment">//         grid[x][y+1] +</span></span><br><span class="line"><span class="comment">//         grid[x-1][y+1] +</span></span><br><span class="line"><span class="comment">//         grid[x-1][y] +</span></span><br><span class="line"><span class="comment">//         grid[x-1][y-1];</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改进的neighbors()</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">neighbors</span> <span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> north = (y + height - <span class="number">1</span>) % height;</span><br><span class="line">  <span class="keyword">int</span> south = (y + <span class="number">1</span>) % height;</span><br><span class="line">  <span class="keyword">int</span> east = (x + <span class="number">1</span>) % width;</span><br><span class="line">  <span class="keyword">int</span> west = (x + width - <span class="number">1</span>) % width;</span><br><span class="line">  <span class="keyword">return</span> grid[x][north] +</span><br><span class="line">         grid[east][north] +</span><br><span class="line">         grid[east][y] +</span><br><span class="line">         grid[east][south] +</span><br><span class="line">         grid[x][south] +</span><br><span class="line">         grid[west][south] +</span><br><span class="line">         grid[west][y] +</span><br><span class="line">         grid[west][north];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mousePressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    gifExport.finish();          <span class="comment">// write file</span></span><br><span class="line">    noLoop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/langs/asm/8086汇编总结-指令系统/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/langs/asm/8086汇编总结-指令系统/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">8086汇编总结-指令系统</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-03-11 00:00:00" itemprop="dateCreated datePublished" datetime="2018-03-11T00:00:00+08:00">2018-03-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:58:09" itemprop="dateModified" datetime="2018-07-13T20:58:09+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">17k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">30 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1 id="目录">目录</h1>
<ul>
<li>第一章 微型计算机概述</li>
<li>第二章 16位微处理器8086</li>
<li>第三章 指令系统</li>
<li>第四章 汇编语言程序设计</li>
<li>第五章 存储器</li>
<li>第六章 输入/输出接口设计</li>
<li>第七章 中断系统</li>
<li>第八章 可编程接口芯片</li>
<li>第九章 AD/DA 转换</li>
<li>第十章 串行通信</li>
</ul>
<h1 id="第三章-指令系统">第三章 指令系统</h1>
<h2 id="指令系统基本概念">指令系统基本概念</h2>
<p><strong>指令</strong>是使计算机执行某种特定操作的二进制编码</p>
<p><strong>指令系统</strong>是所有指令的集合</p>
<p>一条指令通常包括两部分</p>
<pre><code>操作码：规定所要执行的操作类型
操作数：所需要处理的数据或者数据的地址信息</code></pre>
<p>获得数据或者数据地址信息的方式称为 <strong>寻址方式</strong>，例：</p>
<pre><code>MOV   AX, 1234H</code></pre>
<p>指令中有两个操作数，将前者称为目的操作数，后者称为源操作数，该指令将1234H传送到寄存器AX中。</p>
<h2 id="cpu内部操作数寻址">CPU内部操作数寻址</h2>
<h3 id="数据寻址方式">数据寻址方式</h3>
<ol type="1">
<li><p>立即数寻址 指令中直接给出操作数，指令执行时可以立即得到，此时把操作数又称作“立即数” 例：</p>
<pre><code> MOV  AL,5  ;AL &lt;- 5</code></pre></li>
<li><p>寄存器寻址 操作数放在CPU内部的寄存器中，在指令中直接指出寄存器的名字 例：</p>
<pre><code> INC  CX    ;将CX的内容加1</code></pre></li>
<li><p>隐含寻址 指令已经默认是对CPU中的某个寄存器操作 例：</p>
<pre><code> DAA ;默认对AL进行十进制加法调整</code></pre>
<p>以上三种方式均直接从CPU内部获得数据，操作速度快</p></li>
<li><p>直接寻址 操作数放在存储器中，存储单元的有效地址直接由指令给出 例：</p>
<pre><code> MOV   SI, [2000H]   ;SI &lt;- (2000H，2001H)</code></pre>
<p>CPU执行单元EU根据指令的寻址方式计算出16位的偏移量，称为有效地址(EA)，一般用 [有效地址] 表示。</p></li>
<li><p>寄存器间接寻址 操作数一定在存储器中，存储单元的有效地址由寄存器指出,寄存器可以为BX、BP、SI、DI， 例：</p>
<pre><code> MOV  AX, [BX]</code></pre>
<p>若需要对其它段寻址，则必须用前缀指出段寄存器名，又称“段超越” 例：</p>
<pre><code> MOV    BL, ES:[SI]     ;BL  &lt;-  扩展段1000H单元的内容</code></pre>
<p>注：IP只能在代码段寻址，SP只能在堆栈段寻址，不能进行段超越</p></li>
<li><p>寄存器相对寻址 操作数的有效地址由寄存器内容加上一个8位或16位的偏移量得到 例：</p>
<pre><code> MOV   AX, [BX+1000H]  ;AX  &lt;-  BX+1000H 所指向的存储单元内容</code></pre>
<p>若BX = 2000H，则将数据段(3000H, 3001H）的内容传送给AX</p>
<p>指令也可书写为：</p>
<pre><code> MOV   AX, 1000H[BX] </code></pre></li>
<li><p>基址变址寻址 操作数的有效地址由基址寄存器和变址寄存器的内容相加产生 例：</p>
<pre><code> MOV   AX, [BP+SI]  ;AX &lt;- (BP+SI)</code></pre></li>
<li><p>相对基址变址寻址 操作数的有效地址由基址寄存器、变址寄存器和偏移量三者相加产生 例： MOV AX, [BX+SI+1000H]　;AX &lt;- (BX+SI+1000H)</p>
<p>相对基址变址寻址应用 例：若访问堆栈段中的数组A[100]时，可以用BP存放栈顶地址，用偏移量表示数组中第一个元素到栈顶的距离，用变址寄存器SI（或DI）指向具体数组元素</p></li>
</ol>
<p>第4～8种寻址方式，操作数一定在存储器中，由于计算EA、总线操作需要时间，因此比1～3方式慢</p>
<h3 id="io端口寻址">I/O端口寻址</h3>
<p><strong>操作数在I/O端口中时，必须通过累加器（AX或AL）实现对端口的访问</strong></p>
<ol type="1">
<li><p>直接端口寻址 — 指令直接提供8位端口的地址 例：</p>
<p>IN AL, 63H ;AL &lt;- (63H)</p>
<p>端口寻址时，地址不加[ ]，当端口地址可用一个字节来表示时,可使用直接端口寻址</p></li>
<li><p>间接端口寻址 — 由DX寄存器给出16位端口地址 例：</p>
<pre><code> MOV  DX, 162H
 IN   AX, DX</code></pre>
<p>从端口162H读取一个字的数据传送到AX中，DX间接表示端口地址 比较：</p>
<pre><code> MOV  AX, DX    ;AX &lt;- DX
 IN   AX, DX    ;AX &lt;- (DX)</code></pre></li>
</ol>
<h2 id="指令格式">指令格式</h2>
<p>指令一般由1～6个字节组成，具体格式如下：</p>
<figure>
<img src="" alt="指令格式"><figcaption>指令格式</figcaption>
</figure>
<ol type="1">
<li>字节1
<ul>
<li>OPCODE： 指令操作码</li>
<li>D： 操作数传输方向(立即数指令和串操作指令除外)
<ul>
<li>D=0，Reg为源操作数</li>
<li>D=1，Reg为目的操作数</li>
</ul></li>
<li>W： 操作数字节长度
<ul>
<li>W=0，字节操作</li>
<li>W=1，字操作</li>
</ul></li>
</ul></li>
<li>字节2，寻址方式
<ul>
<li>MOD：寻址方式字段
<ul>
<li>00＝存储器方式，指令中无偏移量</li>
<li>01＝存储器方式，指令中有8位偏移量</li>
<li>10＝存储器方式，指令中有16位偏移量</li>
<li>11＝寄存器方式，指令中无偏移量</li>
</ul></li>
<li>Reg：寄存器编码字段
<ul>
<li>000=AL/AX 100=AH/SP</li>
<li>001=CL/CX 101=CH/BP</li>
<li>010=DL/DX 110=DH/SI</li>
<li>011=BL/BX 111=BH/DI</li>
</ul></li>
<li>R/M：寄存器/存储器字段
<ul>
<li>在MOD=11,寄存器模式下，R/M给出第二个操作数的寄存器编码</li>
<li>在MOD≠11,存储器模式下，R/M给出计算有效地址的方法</li>
</ul></li>
</ul>
<figure>
<img src="" alt="计算有效地址"><figcaption>计算有效地址</figcaption>
</figure></li>
<li>字节3～字节6
<ul>
<li>DISP：存储器操作数地址偏移量，长度由MOD字段定义</li>
<li>DATA：指令中的立即数</li>
</ul>
<p>例：</p>
<pre><code> MOV   AX, [BX]              ;指令码为：8B 07
 MOV   [BX+SI+2000H], 2345H  ;指令码为：C7 80 00 20 45 23
 MOV   AX, BX                ;指令码为：89 D8</code></pre></li>
</ol>
<h2 id="指令介绍">8086指令介绍</h2>
<p>8086 CPU共有133条指令，根据操作性质，可分为：</p>
<ul>
<li>传输指令</li>
<li>算术运算指令</li>
<li>逻辑运算和移位指令</li>
<li>串操作指令</li>
<li>控制转移指令</li>
</ul>
<p>操作数的符号表示</p>
<table>
<thead>
<tr class="header">
<th>符号</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DST</td>
<td>目的操作数</td>
</tr>
<tr class="even">
<td>SRC</td>
<td>源操作数</td>
</tr>
<tr class="odd">
<td>TARGET</td>
<td>循环、转移和调用指令中的目的操作数</td>
</tr>
<tr class="even">
<td>REG</td>
<td>寄存器操作数，字节或字</td>
</tr>
<tr class="odd">
<td>REG8</td>
<td>8位寄存器操作数，字节</td>
</tr>
<tr class="even">
<td>REG16</td>
<td>16位寄存器操作数，字</td>
</tr>
<tr class="odd">
<td>MEM</td>
<td>存储器操作数，字节或字</td>
</tr>
<tr class="even">
<td>MEM8</td>
<td>8位存储器操作数，字节</td>
</tr>
<tr class="odd">
<td>MEM16</td>
<td>16位存储器操作数，字</td>
</tr>
<tr class="even">
<td>MEM32</td>
<td>32位存储器操作数，双字</td>
</tr>
<tr class="odd">
<td>ACC</td>
<td>累加器AL或AX</td>
</tr>
<tr class="even">
<td>SEG_REG</td>
<td>段寄存器</td>
</tr>
<tr class="odd">
<td>IMM</td>
<td>立即操作数，字节或字</td>
</tr>
<tr class="even">
<td>IMM8</td>
<td>立即操作数，字节</td>
</tr>
<tr class="odd">
<td>IMM16</td>
<td>立即操作数，字</td>
</tr>
<tr class="even">
<td>SHORT_LABEL</td>
<td>短标号，8位偏移量</td>
</tr>
<tr class="odd">
<td>NEAR_LABLE</td>
<td>近标号，16位地址或偏移量</td>
</tr>
<tr class="even">
<td>FAR_LABLE</td>
<td>远标号，32位地址</td>
</tr>
</tbody>
</table>
<h3 id="传送类指令">传送类指令</h3>
<h4 id="一通用数据传送指令">（一）通用数据传送指令</h4>
<ul>
<li>MOV DST, SRC
<ul>
<li>操作：DST &lt;- SRC</li>
<li>说明：
<ul>
<li>DST和SRC的组合关系是：
<ul>
<li>REG/MEM &lt;-- IMM</li>
<li>REG/MEM &lt;-&gt; REG</li>
<li>REG/MEM &lt;-&gt; SEG_REG</li>
</ul></li>
<li>CS、IP和立即数不能做目的操作数</li>
<li>不能在两个存储单元之间直接传送</li>
<li>MOV指令不改变源操作数，不影响FLAG的状态标志</li>
<li>数据位数由寄存器决定或用说明符指出（如例所示）</li>
<li>SS修改后，下一条指令执行完才检测中断，修改SS和SP一定要连续进行</li>
</ul>
<p>例：</p>
<pre><code>      MOV     AX,  1000
      MOV     [BP],  AX
      MOV     ES,  DX
      MOV     word ptr [SI],  1000
      MOV     byte ptr [SI], AL
      MOV     CS,  100H   错误
      MOV     [1000H], [2000H] 错误</code></pre></li>
</ul></li>
</ul>
<h4 id="二堆栈操作">（二）堆栈操作</h4>
<p>SP总是指向栈顶，即最后压入堆栈的信息单元</p>
<ol type="1">
<li><p>PUSH SRC 进栈指令 操作：SP &lt;- SP-2，(SP+1, SP) &lt;- SRC</p>
<p>具体指令：</p>
<pre><code> PUSH     REG16
 PUSH     SEG_REG
 PUSH     MEM16</code></pre>
<p>例：</p>
<pre><code> PUSH   BX
 PUSH   CS
 PUSH   [SI]
 PUSH   1000   错误</code></pre></li>
<li><p>POP DST 出栈指令 操作：DST &lt;- (SP+1, SP)，SP &lt;- SP+2</p>
<p>具体指令：</p>
<pre><code> POP     REG16
 POP     SEG_REG
 POP     MEM16</code></pre>
<p>例：</p>
<pre><code> POP     AX
 POP     ES
 POP     [SI]
 POP     CS  错误</code></pre>
<p>说明：堆栈操作以字为单位，按后进先出原则存储数据。POP出栈操作时，CS不能为目的操作数</p></li>
</ol>
<p><strong>堆栈主要用于子程序调用、中断子程序的现场保护和恢复、参数传递等。</strong></p>
<p>例：保护现场（保存存储器和恢复存储器次序应一一对应）</p>
<pre><code>PUSH    DS
PUSH    ES
PUSH    AX
PUSH    BX
;子程序处理
POP     BX
POP     AX
POP     ES
POP     DS
RET</code></pre>
<h4 id="三交换指令">（三）交换指令</h4>
<ol type="1">
<li><p>XCHG 指令</p>
<ul>
<li>格式：XCHG DST, SRC</li>
<li>操作：DST &lt;-&gt; SRC</li>
<li>说明：两个操作数必须有一个在寄存器中，可在寄存器之间、寄存器与存储器之间交换信息，目的操作数DST不能为CS</li>
<li><p>具体指令：</p>
<p>XCHG REG, REG XCHG REG, MEM XCHG MEM, REG</p></li>
</ul>
<p>例：</p>
<pre><code> XCHG     AL,  byte ptr [2000H]   ; AL &lt;-&gt; (2000H)
 XCHG     AX,  DX
 XCHG     AX,  CS   错误</code></pre></li>
</ol>
<h4 id="四io端口传送指令">（四）I/O端口传送指令</h4>
<ol type="1">
<li><p>IN 输入指令 操作：AL/AX &lt;- (PORT)/(DX)，PORT为8位直接端口地址</p>
<p>具体指令：</p>
<pre><code> IN  AL, PORT
 IN  AX, PORT
 IN  AL, DX
 IN  AX, DX</code></pre>
<p>例：</p>
<pre><code> IN      AL,  20H
 IN      AX,  60H
 IN      AL,  DX
 IN      AX,  DX
 IN      AL,  160H   错误</code></pre></li>
<li><p>OUT 输出指令 操作：(PORT)/(DX) &lt;- AL/AX，PORT为8位直接端口地址</p>
<p>具体指令： OUT PORT, AL</p>
<p>OUT PORT, AX OUT DX, AL OUT DX, AX</p></li>
</ol>
<p>说明：I/O端口地址有直接寻址和间接寻址（通过DX）两种寻址方式。I/O端口操作必须通过累加器AX或AL来完成</p>
<h4 id="五换码指令">（五）换码指令</h4>
<ul>
<li><p>XLAT 换码指令</p>
<p>具体指令： XLAT</p>
<p>操作：AL &lt;- (BX+AL)</p>
<p>例：</p>
<pre><code>  MOV  AL, 1
  MOV  BX, 1000H
  XLAT    ;将存储单元1001H的内容送给AL</code></pre></li>
</ul>
<h4 id="六有效地址-ea-传送指令">（六）有效地址 (EA) 传送指令</h4>
<ol type="1">
<li><p>LEA (Load Effective Address) 取有效地址指令</p>
<p>具体指令：LEA REG16, SRC</p>
<p>操作： REG16 &lt;- SRC的有效地址</p>
<p>说明：该指令将源操作数的有效地址送给寄存器</p>
<p>例：</p>
<pre><code> MSG db 30H 31H 32H 33H    ;定义数据
 LEA  BX, MSG     ;将MSG的偏移地址送BX
 MOV  DX, MSG    ;DH=31H, DL=30H 
 ;低位在前,高位在后</code></pre></li>
<li><p>LDS (Load DS With Pointer) 地址指针送寄存器和DS</p>
<p>具体指令：LDS REG16, MEM32</p>
<p>操作： REG16 &lt;- (MEM32)，DS &lt;- (MEM32+2)</p>
<p>说明：将源操作数的4个字节，分别传送到指定的寄存器和DS中</p>
<p>例：</p>
<pre><code> LDS   BX, [1000H]</code></pre>
<p>结果：将(1000H,1001H)内容送BX，将(1002H,1003H)内容送DS</p></li>
<li><p>LES (Load ES With Pointer) 地址指针送寄存器和ES</p>
<p>具体指令：LES REG16, MEM32</p>
<p>操作： REG16 &lt;- (MEM32)，ES &lt;- (MEM32+2)</p>
<p>说明：将源操作数的4个字节，分别传送到指定的寄存器和ES中</p></li>
</ol>
<h4 id="七标志寄存器传送指令">（七）标志寄存器传送指令</h4>
<ul>
<li>LAHF (Load AH with Flag) 标志送AH
<ul>
<li>格式：LAHF</li>
<li>操作：AH←标志寄存器的低八位</li>
</ul></li>
<li>SAHF (Store AH into Flag) AH送标志寄存器
<ul>
<li>格式：SAHF</li>
<li>操作：标志寄存器的低八位←AH</li>
</ul></li>
<li>PUSHF (Push the Flag) 标志寄存器进栈
<ul>
<li>格式：PUSHF</li>
<li>操作：SP←SP-2,(SP+1,SP)←FLAG</li>
<li>栈以字为单位</li>
</ul></li>
<li>POPF (Pop the Flag) 标志寄存器出栈
<ul>
<li>格式：POPF</li>
<li>操作：FLAG ←(SP+1，SP)， SP←SP+2</li>
</ul></li>
</ul>
<p>注：传送类指令除了SAHF和POPF外都不影响标志寄存器</p>
<h3 id="算术类指令">算术类指令</h3>
<h4 id="一加法指令">（一）加法指令</h4>
<ol type="1">
<li><p>ADD 加法</p>
<p>格式：ADD DST, SRC</p>
<p>操作：DST ← SRC + DST</p>
<p>具体指令：</p>
<pre><code> ADD      REG, REG
 ADD      REG, MEM
 ADD      MEM, REG
 ADD      REG, IMM
 ADD      MEM, IMM</code></pre></li>
<li><p>ADC (Add With Carry) 带进位加法</p>
<p>格式：ADC DST, SRC</p>
<p>操作：DST ← SRC + DST + CF</p>
<p>具体指令：</p>
<pre><code> ADC       REG, REG
 ADC       REG, MEM
 ADC       MEM, REG
 ADC       REG, IMM
 ADC       MEM, IMM</code></pre></li>
<li><p>INC (Increment) 加1</p>
<p>格式：INC DST</p>
<p>操作：DST ← DST + 1</p>
<p>具体指令：</p>
<pre><code> INC       REG
 INC       MEM</code></pre>
<p>说明：INC指令影响除CF以外的所有状态标志</p></li>
</ol>
<blockquote>
<p><em>带进位加法指令ADC应用举例——实现多字节的加法运算</em></p>
<p>例：有2个4字节无符号数分别存放在数据段2000H和3000H开始的单元中，低位在前，高位在后，将两数相加，结果存放在数据段2000H开始的单元中</p>
</blockquote>
<pre><code>MOV     SI, 2000H           ;SI指向第一个数首地址
MOV     DI, 3000H           ;DI指向第二个数首地址
MOV     AX, [SI]            ;取第一个数的低16位到AX
ADD     AX, [DI]            ;两个数的低16位相加
MOV     [SI], AX            ;低16位相加结果送2000H和2001H单元
MOV     AX, [SI + 2]        ;取第一个数高16位
ADC     AX, [DI + 2]        ;两个数高16位连同进位位相加
MOV     [SI + 2], AX        ;高16位相加结果送2003H和2004H单元</code></pre>
<h4 id="二减法指令">（二）减法指令</h4>
<ol type="1">
<li><p>SUB (Subtract)减法</p>
<p>格式：SUB DST, SRC</p>
<p>操作：DST ← DST - SRC</p>
<p>具体指令</p>
<pre><code> SUB      REG, REG
 SUB      REG, MEM
 SUB      MEM, REG
 SUB      REG, IMM
 SUB      MEM, IMM</code></pre></li>
<li><p>SBB (Subtract With Borrow) 带借位减法</p>
<p>格式：SBB DST, SRC</p>
<p>操作：DST ← DST - SRC - CF</p>
<p>具体指令：</p>
<pre><code> SBB      REG, REG
 SBB     REG, MEM
 SBB     MEM, REG
 SBB     REG, IMM
 SBB     MEM, IMM</code></pre></li>
<li><p>DEC (Decrement) 减1</p>
<p>格式：DEC DST</p>
<p>操作：DST ← DST – 1</p>
<p>具体指令：</p>
<pre><code> DEC       REG
 DEC       MEM</code></pre>
<p>说明：DEC指令影响除CF以外的所有状态标志</p></li>
<li><p>NEG 求补运算</p>
<p>格式：NEG DST</p>
<p>操作：DST ← 模－DST</p>
<p>说明：求指令中给出的操作数的补码</p>
<p>具体指令：</p>
<pre><code> NEG       REG
 NEG       MEM</code></pre>
<p>说明：字节的模为100H，字的模为10000H</p></li>
<li><p>CMP 比较指令</p>
<p>格式：CMP DST，SRC</p>
<p>操作：DST －SRC</p>
<p>具体指令：</p>
<pre><code> CMP       REG,   REG
 CMP       REG,   MEM
 CMP       MEM,   REG
 CMP       REG,   IMM
 CMP       MEM,   IMM</code></pre>
<p>说明：做减法操作，仅影响标志位，不保存结果</p></li>
</ol>
<h4 id="三乘法指令">（三）乘法指令</h4>
<ol type="1">
<li><p>MUL (unsigned Multiple) 无符号数乘法 格式： MUL SRC</p>
<p>操作: AX ← AL<em>SRC 或 {DX, AX} ← AX</em>SRC</p>
<p>具体指令：</p>
<pre><code> MUL   REG 
 MUL   MEM</code></pre></li>
<li><p>IMUL (signed Multiple) 有符号数乘法</p>
<p>格式： IMUL SRC</p>
<p>操作: AX ← AL<em>SRC 或 {DX, AX} ← AX</em>SRC</p>
<p>具体指令：</p>
<pre><code> IMUL   REG 
 IMUL   MEM</code></pre></li>
</ol>
<p>例：将2个32位无符号数DAT1和DAT2相乘，结果保存在64位无符号数Result中</p>
<h4 id="四除法指令">（四）除法指令</h4>
<ol type="1">
<li><p>DIV (unsigned Divide) 无符号数除法 格式： DIV SRC</p>
<p>操作:</p>
<pre><code> AL ← AX/SRC  ,       AH ← AX%SRC             ;字节除法
 AX ← {DX, AX}/SRC,   DX ← {DX, AX}%SRC   ;字除法</code></pre>
<p>具体指令：</p>
<pre><code> DIV   REG
 DIV   MEM</code></pre></li>
<li><p>IDIV (signed Divide) 有符号数除法 格式： IDIV SRC</p>
<p>操作:</p>
<pre><code> AL ← AX/SRC,         AH ← AX%SRC            ;字节除法
 AX ← {DX, AX}/SRC ,  DX ← {DX, AX}%SRC  ;字除法</code></pre>
<p>具体指令：</p>
<pre><code> IDIV   REG 
 IDIV   MEM</code></pre></li>
<li><p>CBW (Convert Byte to Word) 字节扩展为字命令 格式：CBW</p>
<p>操作：将AL扩展为AX</p>
<p>扩展方法：使用最高位进行扩展。若AL的最高位为0，则扩展后AH全为0；若AL的最高位为1，则扩展后AH全为1</p></li>
<li><p>CWD (Convert Word to Double Word) 字扩展为双字命令 格式：CWD</p>
<p>操作：将AX扩展为{DX，AX}，扩展后DX为高16位</p>
<p>扩展方法：使用最高位进行扩展。若AX的最高位为0，则扩展后DX全为0；若AX的最高位为1，则扩展后DX全为1</p></li>
</ol>
<p>CBW和CWD只对有符号数进行扩展，无符号数的扩展只需使用MOV指令将其前面AH或DX全部清0。</p>
<h4 id="五bcd码调整指令">（五）BCD码调整指令</h4>
<p>8086 CPU中没有专用的BCD码运算指令，是使用二进制指令进行BCD码运算，然后再用BCD码调整指令对二进制运算结果进行调整，重新得到BCD码结果。例：DAA调整规则为：</p>
<pre><code>低4位&gt;9 或 AF=1，则结果加06H
高4位&gt;9 或 CF=1，则结果再加上60H</code></pre>
<p>压缩格式BCD码调整指令：</p>
<ul>
<li>DAA ;对加法运算结果AL进行调整</li>
<li>DAS ;对减法运算结果AL进行调整</li>
</ul>
<p>非压缩格式BCD码调整指令：</p>
<ul>
<li>AAA ;加法调整指令</li>
<li>AAS ;减法调整指令</li>
<li>AAM ;乘法调整指令</li>
<li>AAD ;除法调整指令</li>
</ul>
<blockquote>
<p>例：下列程序段执行后AL=?, CF=?</p>
</blockquote>
<pre><code>    MOV    AL, 89H
    ADD    AL, 43H
    DAA </code></pre>
<h3 id="逻辑类指令">逻辑类指令</h3>
<h3 id="一逻辑运算指令">（一）逻辑运算指令</h3>
<blockquote>
<p>下面排版太困难了，就放弃了。</p>
</blockquote>
<p>AND “与”运算命令 格式：AND DST, SRC 操作：DST &lt;- DST &amp; SRC 具体指令： AND REG, REG AND REG, MEM AND MEM, REG AND REG, IMM AND MEM, IMM 逻辑类指令 OR “或”运算命令 格式：OR DST, SRC 操作：DST &lt;- DST | SRC 具体指令： OR REG, REG OR REG, MEM OR MEM, REG OR REG, IMM OR MEM, IMM 逻辑类指令 逻辑运算指令常见用法 清0操作数：XOR AX, AX，不仅把AX清0，而且影响状态标志，至少CF=0, ZF=1（MOV AX,0不影响标志位） 把某几位取反：用XOR指令，把要取反的位和1异或，不变的位和0异或。（例：XOR AL, 80H ;将AL最高位取反） 清0或置位某几位：用AND指令清0，用OR指令置位；要清0的位就与0，要置1的位就或1。 例：清0 MOV AL, 33H ;’3’的ASCII码<br>
AND AL, 0FH ;将高4位清0 置1 MOV AL, 9 OR AL, 30H ;得到9的ASCII码<br>
逻辑类指令 （二）逻辑移位操作命令 SHL 逻辑左移指令 格式：SHL DST, count 操作：操作数整体左移，每次的最高位移到CF，空余位补0 说明：count可以为1，也可为CL，做移位计数 具体指令： SHL REG, 1 SHL REG, CL SHL MEM, 1 SHL MEM, CL 注：1）移位数目大于1时，必需用CL表示； 2）所有逻辑移位操作的具体指令均类似 逻辑类指令 SHR 逻辑右移指令 格式：SHR DST, count 操作：操作数整体右移，最低位到CF，空余位补0 SAL 算术左移指令 格式：SAL DST, count 说明：该指令与SHL逻辑左移指令完全一致 SAR 算术右移指令 格式：SAR DST, count 操作：操作数整体右移，最低位到CF，空余位用符号位补 注: 1）逻辑移位适用于无符号数，算术移位适用于有符号数 2）移位指令常用来做乘以2或除以2的操作 SHL、SAL用来乘以2，SHR、SAR用来除以2 例： MOV CL,5 ;若执行前(DI)=0064H SAR [DI],CL ;执行后(DI)=0003H，相当于100/32=3 逻辑类指令 ROL 循环左移指令 格式：ROL DST, count 操作：操作数整体左移，最高位移到CF，最低位用原来最高位补 ROR 循环右移指令 格式：ROR DST, count 操作：操作数整体右移，最低位移到CF，最高位用原来最低位补 RCL 带进位的循环左移指令 格式：RCL DST, count 操作：类似ROL循环左移，但CF加入到循环圈中 RCR 带进位的循环右移指令 格式：RCR DST, count 操作：类似ROR循环左移，但CF加入到循环圈中 串操作类指令 串操作类指令 对一串字符或数据操作，允许两个操作数均为MEM操作数，分为5种： MOVS (Move String) 串传送 STOS (Store into String) 存AL中数据到串中 LODS (Load from String) 从串中取数据到AL中 CMPS (Compare String) 串比较 SCAS (Scan String) 串扫描 串操作说明 每次完成一个字节或一个字的操作，B表示字节，W表示字 多次操作需用重复前缀，如REP，重复次数由CX决定 默认DS:SI指向存储器源操作数，ES:DI指向存储器目的操作数 SI、DI自动变化，DF指示变化方向 DF=0，SI、DI作增量变化，B: +1，W: +2 DF=1，SI、DI作减量变化，B:－1，W:－2 串操作类指令 重复前缀（CX又称作计数器） REP 重复 REPE / REPZ 相等/为0（ZF=1）则重复 REPNE / REPNZ 不等/不为0（ZF=0）则重复 MOVS 串传送指令 格式：MOVSB 或 MOVSW 操作：MOVSB：(ES : DI) ← (DS : SI)，SI←SI±1，DI←DI±1 MOVSW：(ES : DI) ← (DS : SI)，SI←SI±2，DI←DI±2 说明：使用前缀REP，可完成多次数据传送 例：MOV CX, 12 REP MOVSB ;连续传送12个字节 串操作类指令 STOS 存入串指令 格式：STOSB 或 STOSW 操作：STOSB：(ES : DI) ← AL，DI←DI±1 STOSW：(ES : DI) ← AX，DI←DI±2 说明：可使用REP前缀 LODS 从串中取数据指令 格式：LODSB 或 LODSW 操作：LODSB： AL ← (DS : SI)，SI←SI±1 LODSW：AX ← (DS : SI) ，SI←SI±2 SCAS 串扫描指令 格式：SCASB 或 SCASW 操作：在数据中查找AL或AX中的内容 SCASB：AL － (ES : DI)，DI←DI±1 SCASW：AX － (ES : DI)，DI←DI±2 说明：可使用REPE/REPZ 或 REPNE/REPNZ，仅影响标志位 串操作类指令 CMPS 串比较指令 格式：CMPSB 或 CMPSW 操作：两个MEM操作数的比较，源操作数－目的操作数 CMPSB：(DS : SI) － (ES : DI)，SI←SI±1，DI←DI±1 CMPSW：(DS : SI) － (ES : DI)，SI←SI±2，DI←DI±2 说明：可使用REPE / REPZ 或 REPNE / REPNZ，该指令只影响标志位，不保存结果 条件重复前缀说明<br>
REPE / REPZ 相等或为0时重复 操作：若CX≠0 且 ZF=1 （相等）时继续执行，否则退出 REPNE / REPNZ 不相等或不等于0时重复 操作：若CX≠0 且 ZF=0（不相等）时继续执行，否则退出 串操作类指令 例1：将数据段中1000H开始的10个字节移动到2000H开始的单元</p>
<p>串操作类指令 例2：将数据段中1000H开始的10个字移动到1002H开始的单元去 控制转移类指令 控制转移类指令 该类指令是能够使程序执行流程发生改变的指令，分为5种： 无条件转移和条件转移指令 子程序调用和返回指令 循环控制指令 中断指令 处理器控制指令 指令需要寻找转移地址或调用地址，将此种寻址方式称为程序寻址方式 段内直接转移方式 — 指令中直接给出跳转的相对偏移量 目标转移地址 = IP + 偏移量（8位或16位） 偏移量为8位，称为短跳转，跳转范围：-128 ~ +127个单元 偏移量为16位，称为近跳转，跳转范围：-32768~ +32767个单元 例：JMP 1000H ;转移地址的偏移量由指令给出 控制转移类指令 段内间接转移方式 — 转移地址在寄存器或内存单元中 例：JMP CX ;转移地址由CX给出，执行时将CX值赋给IP JMP [1000H] ;转移地址存放在（1000H, 1001H）单元中 段间直接转移方式 — 指令中直接给出转移地址的段地址和偏移量 例：JMP 2000H:0100H ;执行时，2000H赋给CS, 0100H赋给IP 注：段间直间转移又称作远跳转，该种方式为程序提供了从一个代码段转移到另一个代码段的方法 段间间接转移方式 — 转移地址的段地址和偏移量在内存单元中 例：JMP DWORD PTR [SI] (SI, SI + 1)存放偏移地址，(SI + 2, SI + 3)存放段地址 控制转移类指令 （一）无条件转移指令和条件转移指令 无条件转移指令 JMP TARGET 无条件直接转移指令可以跳转到内存中任何程序段，有四种形式 例： JMP 1000H ;段内直接转移 JMP CX ;段内间接转移 JMP 2000H:0100H ;段间直接转移 JMP DWORD PTR [SI] ;段间间接转移 说明：段内间接转移和段间转移只用于无条件指令 实际使用时多采用符号地址，如： JMP BBB …… BBB: MOV AL, 3 ……<br>
控制转移类指令 条件转移指令 根据判断条件，决定是否跳转，条件转移指令都是段内短跳转 根据单个标志进行跳转的指令 JS ;SF = 1，则跳转 JNS ;SF = 0，则跳转 JO ;OF = 1，则跳转 JNO ;OF = 0，则跳转 JP ;PF = 1，则跳转 JNP ;PF = 0，则跳转 JZ ;ZF = 1，则跳转 JNZ ;ZF = 0，则跳转 JC ;CF = 1，则跳转 JNC ;CF = 0，则跳转 根据CX中的值进行跳转的指令 JCXZ ;CX = 0，则跳转 控制转移类指令 根据无符号数比较结果进行跳转的指令 助记符：A：大于；B：小于；E：等于 JA （JNBE） ;大于，即不小于等于，则跳转 JAE（JNB） ;大于等于，即不小于，则跳转，同JNC JE ;等于，即结果为0，则跳转，同JZ JB（JNAE） ;小于，即不大于等于，则跳转，同JC JBE（JNA） ;小于等于，即不大于，则跳转，CF | ZF = 1 根据有符号数比较结果进行跳转的指令 助记符：G：大于；L：小于；E：等于 JG（JNLE） ;大于，即不小于等于，则跳转 JGE（JNL） ;大于等于，即不小于，则跳转 JE ;等于，与无符号数比较时相同 JL （JNGE） ;小于，即不大于等于，则跳转 JLE （JNG） ;小于等于，即不大于，则跳转 注：根据比较结果跳转时，必须区分有符号数和无符号数，如： 1111 1111b 与 0000 0000b比较 控制转移类指令 （二）子程序调用和返回指令 CALL TARGET 子程序调用指令类似转移指令，也有4种形式 CALL 1000H ;段内直接转移，调用地址偏移量在指令中给出 CALL AX ;段内间接转移，调用地址在AX中给出 CALL 2000H:0200H ;段间直接转移，指令中直接给出调用 ;地址的段地址和偏移量 CALL DWORD PTR [DI] ;段间间接转移，调用地址在内存单元中 执行该指令时，会将下一条指令的地址压入堆栈，该地址称为返回地址 段内调用：只将返回地址的偏移量压入堆栈 段间调用：将返回地址的段地址和偏移量压入堆栈，先压CS，后压IP 实际使用时CALL指令后面直接跟子程序名，例： CALL DISP DISP proc<br>
BBB: MOV AL, 3 ……. …… ret DISP endp 控制转移类指令 RET — 子程序返回指令，应与调用指令相对应 执行时，从堆栈顶部弹出返回地址 段内返回：仅从堆栈顶部弹出返回地址偏移量 IP ← (SP)，SP ← SP + 2 段间返回：从堆栈顶部弹出返回地址的段地址和偏移量 IP ← (SP)， SP ← SP + 2； CS ← (SP)，SP ← SP + 2 RET IMM16 — 带立即数返回指令 执行时，从堆栈顶部弹出返回地址，再使SP加上立即数，例：RET 4</p>
<p>控制转移类指令 （三）循环控制指令 循环控制指令均是段内短跳转 LOOP TARGET — 循环指令，循环次数由CX决定 执行时，CX先减1，若为0则退出，否则继续循环，例： MOV CX, 10 ;设置循环次数为10次 BBB: LOOP BBB ;CX减1，若不为0，则循环 …… ;后续处理 LOOPZ / LOOPE TARGET — 条件循环指令 LOOPZ 和LOOPE是同一条指令的不同助记符，执行时，在LOOP指令的基础上，还需判断ZF，若CX != 0 且 ZF = 1则循环 LOOPNZ / LOOPNE TARGET 执行时，在LOOP指令的基础上，还需判断ZF 若CX != 0 且 ZF = 0则循环 控制转移类指令 循环调用指令说明 循环指令不影响状态标志，即CX减为0时不影响FLAG 如果目标位置超出短跳转的范围，则用JMP辅助完成循环</p>
<p>（五）中断指令和中断返回指令 INT n — 中断调用指令 8086指令系统为程序员提供软件中断，利用INT n指令实现<br>
执行时，依次将FLAG，当前CS和IP（即断点地址）压入堆栈，并清除IF和TF标志，执行中断类型码为n的中断程序。 IRET — 中断返回指令 执行时，从堆栈中依次弹出断点地址的IP、CS和FLAG INTO — 溢出中断指令 执行时，判断OF，若为1，则执行中断指令INT 4，否则无操作 （六）控制指令 标志处理指令 CLC / STC / CMC 对CF 清0 / 置位 /取反 CLD / STD 对DF 清0 / 置位 CLI / STI 对IF 清0 / 置位 控制转移类指令 处理器控制指令 NOP — 空操作指令，占用一个字节的机器码，不执行任何操作 HLT — Halt，停机指令，该指令使处理器处于停机状态，以便等待一次外部中断到来 WAIT— 等待指令，该指令使处理器处于空转状态，也可用来等待外部中断的到来 ESC — Escape，换码指令，用作前缀，例：ESC MEM 其中MEM指出一个存储单元，ESC指令把该存储单元的内容送到数据总线去。 LOCK — 封锁指令，用作前缀 该指令与其他指令联合，用来维持总线的封锁信号直到与其联合的指令执行完为止。 80386扩充指令介绍 第3.4节 80386扩充指令介绍 80386为32位CPU，具有独立的32位数据线(D31<sub>D0)和34位地址线(A31</sub>A2, /BE0~/BE3)，可寻址4GB存储空间，内部寄存器多为32位</p>
<p>80386扩充指令介绍 4. 段寄存器：80386内部设置了6个16位段寄存器CS DS SS ES FS GS 二. 80386寻址方式 在8086寻址方式基础上，80386的所有通用寄存器既可作为基址寄存器，也可作为变址寄存器(ESP除外)，存放地址。 EA = 基址 + 变址×比例因子 + 位移量 比例因子可以为：1、2、4或8，位移量可以为8位、16位或32位 例： MOV ECX, [EAX + EDX * 4 + 1000H] 三. 80386扩充指令 — 1.数据传送指令 1）使用MOV指令时，两操作数位数必须相同，若不同，则用MOVZX或MOVSX MOVZX AX, BL ;若BL=80H，则AX=0080H，MOVZX表示零扩展BL MOVSX AX, BL ;若BL=80H，则AX=FF80H，MOVSX表示符号扩展BL 2）立即数入栈指令 例：PUSH 1000H 3）PUSHA 将全部16位寄存器AX~DI压入堆栈， POPA 则全部出栈 PUSHAD 将全部32位寄存器EAX~EDI压入堆栈， POPAD 则全部出栈 PUSHFD 将EFLAG压入堆栈 POPFD 从堆栈弹出双字到EFLAG 80386扩充指令介绍 4）LSS ESP, MEM ;将MEM开始的存储单元内容送ESP和SS LFS EDX, MEM ;将MEM开始的存储单元内容送EDX和FS LGS EAX, MEM ;将MEM开始的存储单元内容送EAX和GS 5）CWDE ;将AX扩展为EAX CDQ ;将EAX扩展为(EDX, EAX) 2. 算数运算指令扩充 1）IMUL SRC AX &lt;- AL * SRC ;字节乘法 EAX &lt;- AX * SRC ;字乘法，高16位同时也放在DX中，兼容8086 (EDX, EAX) &lt;- EAX * SRC ;32位数乘法 另外操作数可为2个8位数、2个16位数、2个32位数，例： IMUL DX, [1000H], 300 ;DX = (1000H) * 300 IMUL ECX, 2000 ; ECX = ECX * 2000 IMUL BX, CX ;BX = BX * CX 2）MUL SRC ;与IMUL指令类似</p>
<p>80386扩充指令介绍 3）DIV与IDIV指令 — 可用AX, (DX, AX), (EDX, EAX)作为被除数，例： DIV BL ;AL = AX / BL, AH = AX % BL DIV BX ;AX = (DX, AX) / BX, DX = (DX, AX) % BX DIV ECX ;EAX = (EDX, EAX) / ECX, EDX = (EDX, EAX) % ECX 3. 逻辑指令扩充 1）逻辑操作与8086一样，只是逻辑指令还可用于32位操作数 2）增加了2条可对64位操作数进行移位的指令SHLD和SHRD SHLD EDX, EAX, 5 ;EDX左移5位, 低5位由EAX的高5位填充 ;且EAX中内容不变 SHRD EAX, EBX, CL ;EAX右移CL位, EAX高位由EBX的低位 ;填充，EBX的值保持不变 4. 串操作指令扩充 1）增加了32位数的串操作 例： MOVSD ;表示传送一个双字 2）增加字符串输入INS和字符串输出OUTS指令，必须使用DX存放端口号 MOV DX, 160H ; 从160H端口连续读10个双字存放到ES:EDI指向的存储单元 MOV CX, 10 REP INSD 80386扩充指令介绍 5. 转移、循环和调用指令 1）JECXZ TARGET ;若ECX = 0，则跳转 2）使用CALL指令时 段内调用：将EIP压入堆栈，保存4个字节 段间调用：将CS:EIP共6字节压入堆栈 3）RET和RET n指令 出栈时，操作应与CALL指令相对应 6. 条件设置指令 — 80386新增指令 格式： SETcond REG8/MEM8 ;cond为设置条件 例： SETZ AL ;若ZF = 1，则置AL为1，否则置0 SETGE CL ;有符号数比较大小时，若大于等于，则置CL为1 SETO [100H] ;若OF = 1，则置[1000H]存储单元为1，否则置0 7. 位处理指令 — 80386新增指令 BTS ;将指定位置1 BTR ;将指定位清0 BTC ;对指定位取反 BT ;对指定位进行测试<br>
BSF ;从最低位往最高位扫描，若全为0，则ZF置1，若某位为1，则 ;ZF清0，且将此位的位号放入目的寄存器 80386扩充指令介绍 BSR ;从最高位往最低位扫描，若全为0，则ZF置1，若某位为1，则 ;ZF清0，且将此位的位号放入目的寄存器 例： BTC AX, 2 ;将AX的D2位装入CF，再对AX的D2位取反 BTS [100H], 4 ;将[100H]单元的D4位装入CF，再将D4位置1 BTR BL, CL ;将CL的值作为位的序号，将BL的此位送CF， ;再将BL的此位清0，若CL的值大于8，则将CL ;的值对8取余得到位序号 BT AL, CL ;将CL的值作为序号，对AL的此位进行测试 BSF AX, [2000H] ;对[2000H]开始的一个双字，从D0往D31 ;扫描，若全为0，则ZF = 1，否则ZF = 0， ;且将此位序号送AX BSR EAX, ECX ;对ECX从D31往D0扫描，若全为0，则置 ;ZF=1，否则ZF=0，并将此位序号送EAX</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/langs/asm/8086汇编总结-微型计算机概述/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/langs/asm/8086汇编总结-微型计算机概述/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">8086汇编总结-微型计算机概述</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-26 00:00:00" itemprop="dateCreated datePublished" datetime="2018-02-26T00:00:00+08:00">2018-02-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:42:36" itemprop="dateModified" datetime="2018-07-13T20:42:36+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">6.5k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">12 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1 id="目录">目录</h1>
<ul>
<li>第一章 微型计算机概述</li>
<li>第二章 16位微处理器8086</li>
<li>第三章 指令系统</li>
<li>第四章 汇编语言程序设计</li>
<li>第五章 存储器</li>
<li>第六章 输入/输出接口设计</li>
<li>第七章 中断系统</li>
<li>第八章 可编程接口芯片</li>
<li>第九章 AD/DA 转换</li>
<li>第十章 串行通信</li>
</ul>
<h1 id="第一章-微型计算机概述">第一章 微型计算机概述</h1>
<h2 id="微型计算机基本组成">微型计算机基本组成：</h2>
<p><strong>冯诺依曼结构</strong></p>
<ul>
<li>CPU（Central Processing Unit 中央处理单元 ）
<ul>
<li>ALU (Arithmetic Logic Unit 算术逻辑单元)</li>
<li>控制器</li>
</ul></li>
<li>Memory
<ul>
<li>RAM (读写存储器）</li>
<li>ROM (只读存储器)</li>
</ul></li>
<li>I/O接口 - 主机与外设的匹配连接</li>
<li>BUS（总线）：计算机用来传输信息的一组通信线
<ul>
<li>AB (地址总线)：用于传递地址信息，单向，成组使用，地址总线的宽度决定了CPU直接寻址内存的范围。如：8086有20根地址线，即地址总线宽度为20位，可寻址2^20B = 1MB</li>
<li>DB (数据总线)：用于传递数据信息，双向，成组使用，计算机的位一般是指数据总线的宽度。如：8086有16根数据线，因此8086为16位机</li>
<li>CB (控制总线)：用于传输控制信号，以便控制计算机各部件协调工作， 各自独立使用，有发出，也有接收。如：CPU向存储器发出的读信号、写信号</li>
<li>地址数据复用总线：地址总线与数据总线共用一组通信线，<em>分时</em>传送地址，信息和数据信息（由同步信号区分），节省CPU引脚</li>
</ul></li>
</ul>
<h2 id="微型计算机系统mcs----micro-computer-system">微型计算机系统（MCS -- Micro-Computer System）</h2>
<p>以微型计算机为主体，配上系统软件就构成微型计算机系统。</p>
<ul>
<li>系统软件包括操作系统和一系列系统应用程序
<ul>
<li>如编辑程序、编译程序、调试程序等</li>
<li>有了系统软件才能发挥微机的硬件功能</li>
</ul></li>
<li>外设
<ul>
<li>输入设备：鼠标、键盘、扫描仪</li>
<li>输出设备：显示器、打印机、投影仪</li>
</ul></li>
</ul>
<figure>
<img src="/images/asm-1/ScreenShot00017.jpg" alt="IBM PC/XT系统板框图"><figcaption>IBM PC/XT系统板框图</figcaption>
</figure>
<h2 id="微处理器单板机和单片机概念">微处理器、单板机和单片机概念</h2>
<ul>
<li>微处理器
<ul>
<li>专指中央处理器(CPU)，是将计算机的运算器(ALU)和控制器集成在一个芯片上。</li>
<li>如：8086，80386，Pentium，PII等</li>
</ul></li>
<li>单板机
<ul>
<li>将CPU、存储器、I/O口以及简单的外设集成在一块板上，是一个简单的计算机系统。</li>
<li>如：TP801A等。</li>
</ul></li>
<li>单片机
<ul>
<li>将CPU、存储器、I/O口集成在一个芯片上。</li>
<li>如：Intel MCS-48，MCS-51，MCS-96等</li>
</ul></li>
</ul>
<h2 id="微型计算机发展">微型计算机发展</h2>
<ul>
<li>CPU位数不断增加，集成度不断提高，频率不断提高
<ul>
<li>计算机的位
<ul>
<li>CPU片内数据总线的宽度决定了计算机的位数</li>
<li>如：8位，16位，32位，64位，128位</li>
</ul></li>
<li>准16位机
<ul>
<li>CPU片内数据线宽度为16位，片外数据线宽度为8位</li>
<li>如：8088，8098</li>
</ul></li>
</ul></li>
<li>由单处理器向多处理器发展</li>
<li>指令系统由复杂指令集向精简指令集发展
<ul>
<li>复杂指令集计算机（CISC – Complex Instruction Set Computer）</li>
<li>精简指令集计算机（RISC – Reduced Instruction Set Computer）</li>
<li>Intel在Pentium之前的CPU均属于CISC体系，从Pentium开始将CISC和RISC相结合，Pentium大多数指令是精简指令，但仍保留了一部分复杂指令</li>
</ul></li>
</ul>
<h2 id="计算机中的信息表示">计算机中的信息表示</h2>
<ol type="1">
<li>计算机使用二进制存储，但书写时常用16进制
<ul>
<li>计算机内所有代码以二进制表示，机器码又称二进制码</li>
<li>1位16进制数对应半个字节（4位二进制码）</li>
</ul>
<p>例：1000 0101 B 二进制；85 H 16进制</p>
<p><em>注：书写16进制数时，若最高位是字母，则前面加0，表示是数据，如0FEH</em></p>
<ul>
<li>一些进制的简化符号: 2进制 - B(Binary)、 16进制－ H(Hex) 8进制 - O(Octal)、 10进制 - D(Decimal)</li>
</ul></li>
<li>无符号数表示
<ul>
<li><p>二进制无符号数 — 码值与数值相等 一个n位二进制无符号数表示的范围是0～(2^n - 1)</p>
<p>例：8位二进制无符号数表示的范围是0～255，16位二进制无符号数表示的范围是0～65535</p></li>
<li>BCD码(Binary Coded Decimal) - 用半个字节表示1位十进制数
<ul>
<li>压缩BCD码: 用1个字节表示2位BCD码，又称8421BCD码</li>
<li>非压缩BCD码：用1个字节的低四位表示1位BCD码，高四位忽略</li>
</ul>
<p>例 00111001b 在压缩格式下表示：39；在非压缩格式下表示：9</p></li>
</ul></li>
<li>有符号数表示
<ul>
<li>原码
<ul>
<li>将最高位作为符号位，正数的符号位为0，负数的符号位为1，余下的其他位为数值位</li>
</ul></li>
<li>反码
<ul>
<li>正数的反码与原码相同；</li>
<li>负数的反码由该负数的原码按位取反(符号位除外)得到</li>
</ul></li>
<li>补码
<ul>
<li>正数的补码与原码相同。</li>
<li>负数的补码由该负数的原码按位取反(符号位除外)加1得到</li>
<li><strong>计算机内有符号数默认用补码表示</strong></li>
</ul></li>
</ul></li>
</ol>
<h3 id="一个字节有符号数范围">一个字节有符号数范围</h3>
<p>原码表示： -127～+127 有+0，-0</p>
<pre><code>1111 1111b – 1000 0000b - 0000 0000b – 0111 1111 
-127           -0           +0           +127</code></pre>
<p>反码表示：-127～+127 有+0，-0</p>
<pre><code>1000 0000b – 1111 1111b – 0000 0000b – 0111 1111b
-127            -0           +0           +127</code></pre>
<p>补码表示：-128～+127 只有一个0</p>
<pre><code>1000 0000b – 1111 1111b - 0000 0000b – 0111 1111b
-128           -1            0            127</code></pre>
<p>一个字的补码表示范围: -32768 ~ +32767 (只有一个0)</p>
<pre><code>1000 0000 0000 0000 ~ 1111 1111 1111 1111
    -32768              -1
0000 0000 0000 0000 ~ 0111 1111 1111 1111
    0                   +32767</code></pre>
<p><strong>举例说明</strong></p>
<pre><code>计算机内一个字节为 81H =&gt; 1000 0001b
二进制    129 （二进制无符号数）
BCD码     81 （压缩格式BCD码）
原码     -1
反码     -126（1111 1110b —&gt; 1000 0001b）
补码     -127（1111 1111b —&gt; 1000 0000b—&gt;1000 0001b）</code></pre>
<p><strong>一个代码，赋予不同类型，其数值不一样。而类型要由人编程指定</strong></p>
<p><strong>数学运算时，结果超出运算器所表示范围则会产生“溢出”</strong></p>
<ul>
<li>无符号数：通过进位或借位标志C标记“溢出”，避免产生错误结果</li>
<li>有符号数：用标志O标记“溢出”，表示运算结果错误
<ul>
<li>字节运算，结果超出-128～127，则为溢出</li>
<li>字运算，结果超出-32768～32767，则为溢出</li>
<li>一般可以直接判断运算过程来确定是否溢出 - 双高位判别法：最高位（符号位）是否有进借位Cs异或次高位（数值的最高位）是否有进借位Cp。溢出 = Cs xor Cp</li>
</ul></li>
</ul>
<h3 id="字符代码">字符代码</h3>
<ol type="1">
<li>ASCII码 — 美国标准信息交换码
<ul>
<li>用7位二进制数表示128个字符
<ul>
<li>包含26个英文大、小写字母，数字0～9，符号和命令符等</li>
</ul></li>
<li>ASCII码在计算机内用一个字节表示，<em>最高位一般为0，有时候用作校验位</em>，计算机与外设交换信息一般都用ASCII码
<ul>
<li>如：字符显示器，字符打印机等</li>
<li>注：需牢记字符 ‘0’～‘9’,‘A’～‘F’，‘a’～‘f’的ASCII码分别为30H～39H, 41H～46H， 61H～66H</li>
</ul></li>
</ul></li>
<li>汉字内码
<ul>
<li>GB2312定义了6763个汉字，其中一级字库3755字，二级字库3008字</li>
<li>其他编码方式</li>
</ul></li>
</ol>
<h2 id="硬件基础知识补充">硬件基础知识补充</h2>
<p>计算机硬件主要由 <strong>逻辑门、触发器（D触发器）、三态门</strong>构成，使用器件为 <em>CMOS、TTL和NMOS</em>。</p>
<p>TTL和CMOS电平范围如下表所示：</p>
<figure>
<img src="/images/asm-1/ScreenShot00018.jpg" alt="TTL和CMOS电平范围"><figcaption>TTL和CMOS电平范围</figcaption>
</figure>
<p>要了解逻辑电平的内容，首先要知道以下几个概念的含义：</p>
<ol type="1">
<li>输入高电平（ViH）： 保证逻辑门输入为高电平时所允许的最小输入电压，当输入电平高于ViH时，则认为输入电平为高电平。</li>
<li>输入低电平（ViL）：保证逻辑门的输入为低电平时所允许的最大输入电压，当输入电平低于ViL时，则认为输入电平为低电平。</li>
<li>输出高电平（VoH）：保证逻辑门的输出为高电平时的最小输出电压，逻辑门的输出为高电平时的电平值都必须大于此VoH。</li>
<li>输出低电平（VoL）：保证逻辑门的输出为低电平时的最大输出电压，逻辑门的输出为低电平时的电平值都必须小于此VoL。</li>
<li>阀值电平 (Vt)： 数字电路芯片都存在一个阈值电平，就是电路刚刚勉强能翻转动作时的电平。它是一个界于ViL、ViH之间的电压值，对于CMOS电路的阈值电平，基本上是二分之一的电源电压值，但要保证稳定的输出，则必须要求输入高电平&gt; ViH，输入低电平 &lt; ViL，而如果输入电平在阈值上下，也就是ViL～ViH这个区域，电路的输出会处于不稳定状态</li>
</ol>
<h3 id="逻辑门">逻辑门</h3>
<p>重点在于其图像。<strong>直与弯或</strong>。</p>
<p><img src="/images/asm-1/ScreenShot00019.jpg" alt="与逻辑"> <img src="/images/asm-1/ScreenShot00020.jpg" alt="或逻辑"> <img src="/images/asm-1/ScreenShot00021.jpg" alt="输出门"></p>
<h3 id="三态缓冲器">三态缓冲器</h3>
<ol type="1">
<li><p>三态门</p>
<figure>
<img src="/images/asm-1/ScreenShot00022.jpg" alt="三态门"><figcaption>三态门</figcaption>
</figure></li>
<li><p>单向三态缓冲器 — 74LS244</p>
<p>74LS244为TTL的单向三态缓冲器，有两个三态控制使能引脚G1和G2分别控制4个三态门</p></li>
<li><p>双向三态缓冲器 — 74LS245或INTEL 8286</p>
<p>74LS245为TTL双向三态缓冲器，有控制引脚DIR和EN</p></li>
</ol>
<h3 id="锁存器">锁存器</h3>
<ol type="1">
<li>D触发器</li>
<li><p>具有异步清零的TTL上升沿锁存器－74LS273</p>
<p>当CLK上升沿到来时，将输入端的数据D0～D7锁存到输出端Q0～Q7，当CLR为低电平时将锁存器输出清零（具体逻辑可见对应的芯片图）</p></li>
<li><p>具有缓冲输出的TTL低电平锁存器－74LS373或INTEL8282</p>
<ul>
<li>OE为低电平时，输出三态门打开，此时LE为高电平，Q7～Q0跟随D7～D0；LE为低电平，数据锁存</li>
<li>OE为高电平时，输出Q7～Q0为三态</li>
</ul></li>
</ol>
<h2 id="计算机内的总线连接">计算机内的总线连接</h2>
<p>为减少计算机内各部件之间的连线，采用总线结构，使各部件共用一组数据线。</p>
<ul>
<li><strong>输入数据到总线的部件，一定要使用三态电路作缓冲</strong>
<ul>
<li>需输出数据时，打开三态门，占用总线，传输信息</li>
<li>不输出时，关闭三态门，使输出处于高阻状态，让出总线，不影响其它部件使用总线</li>
</ul></li>
<li><strong>从总线输出数据的部件，常采用D触发器锁存总线数据</strong></li>
<li>常用总线技术
<ul>
<li>时分技术：计算机内各部件之间的信息传送分时进行</li>
<li>频分技术：CATV 有线电视，分频复用</li>
</ul></li>
</ul>
<h3 id="类型">类型</h3>
<p>一个计算机系统包含多种类型总线，按 <em>所处位置</em>可分为：</p>
<ol type="1">
<li><p>内部总线</p>
<p>位于CPU芯片内，用于连接片内各功能部件的总线 内部总线的对外引线叫做CPU总线</p></li>
<li><p>局部总线</p>
<p>位于主机板上，用于连接主机板上各个主要部件，并通过扩展槽连接各种适配器（显卡、网卡、声卡）</p>
<p>常见的有ISA、EISA、PCI总线</p>
<ul>
<li>ISA — Industry Standard Architecture</li>
<li>EISA — Extension Industry Standard Architecture</li>
<li>PCI — Peripheral Component Interconnect</li>
</ul></li>
<li><p>系统总线</p>
<p>位于机箱底板，多个CPU插件板以此互相连接，在PC机中，一般不用，常见的有MULTIBUS、VME等</p></li>
<li><p>外部总线</p>
<p>是微机与外部设备之间或几个微机系统之间的通信总线，如：</p>
<ul>
<li>IDE (Integrated Drive Electronic)总线，专用于连接硬盘</li>
<li>SCSI (Small Computer System Interface)，专用于连接硬盘</li>
<li>Centronics总线，用于与并行打印机连接</li>
<li>USB (Universal Serial Bus)总线，用于连接USB设备</li>
</ul></li>
</ol>
<h3 id="总线性能">总线性能</h3>
<p>主要从三方面来衡量</p>
<ol type="1">
<li>总线宽度：指总线一次可以同时传输的数据位数</li>
<li><p>如：ISA为16位总线，一次可传输16位二进制数，EISA、PCI为32位总线</p></li>
<li><p>总线频率：指总线每秒能传输数据的次数</p>
<p>如：ISA、EISA的频率为8MHz，PCI的频率为33MHz，PCI-2的频率为66MHz</p></li>
<li><p>传输率：指每秒钟能够传输的字节数，用MB/s表示</p>
<p>传输率 = 宽度/8 ×频率</p>
<p>例：PCI总线宽度为32位，频率为33MHz，则传输率 = 32b / 8 ×33 = 132MB/s，即PCI总线每秒能够传输132M字节</p></li>
</ol>
<h3 id="微机的层次化总线">微机的层次化总线</h3>
<figure>
<img src="/images/asm-1/ScreenShot00023.jpg" alt="微机的层次化总线"><figcaption>微机的层次化总线</figcaption>
</figure>
<ol type="1">
<li><p>CPU总线</p>
<ul>
<li>CPU芯片内部总线的对外引线</li>
<li>连接与CPU最密切、速度最快的部件，如二级Cache</li>
</ul></li>
<li><p>PCI总线控制器</p>
<ul>
<li><p>像桥梁一样，一边连接CPU总线，一边连接CPU访问相对频繁、速度相对较快的部件，又称“PCI桥”</p>
<p>如：通过PCI总线连接主存储器，通过AGP总线连接高速图形卡</p></li>
<li><p>可级联下一级PCI总线控制器，形成多级PCI总线，容纳更多PCI卡</p></li>
</ul></li>
<li><p>PCI转换桥</p>
<p>完成PCI总线与ISA或EISA总线的连接转换</p></li>
<li><p>ISA总线：总线宽度16位，总线频率8MHz，传输率16MB/s</p>
<ul>
<li>24位地址线，16位数据线</li>
<li>由主槽和扩展槽两部分组成，主槽为62脚，对应早期IBM PC/XT系统的62芯总线槽，扩展槽为36脚</li>
<li>为和大量ISA适配卡兼容，目前计算机仍然通过“桥”来扩展ISA总线</li>
</ul></li>
<li><p>EISA总线：是ISA的扩展，总线宽度32位，总线频率8MHz，传输率32MB/s</p>
<ul>
<li>32位地址线，32位数据线，能自动进行8位、16位、32位数据访问</li>
<li>共198条信号线，98条为ISA原有的，扩展了100条信号线</li>
</ul></li>
<li><p>PCI总线：目前微机中应用最广泛的局部总线</p>
<ul>
<li>总线宽度32位，总线频率33MHz，传输率为132MB/s</li>
<li>支持即插即用功能</li>
</ul></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">面对更大数据量传送的需求，传统PCI总线已无法满足应用要求，因此现在的设计对其进行扩展，称作PCI-X总线：</span><br><span class="line">PCI-X 66    64位     66MHz       Hot Plugging,       3.3 V   533MB/s</span><br><span class="line">PCI-X 133   64位     133MHz      Hot Plugging,       3.3 V   1.06GB/s</span><br><span class="line">PCI-X 266   64/16位  133MHz      Double Data Rate Hot Plugging, </span><br><span class="line">    3.3 &amp; 1.5 V,   ECC supported    2.13GB/s （主要应用到DDR内存）</span><br><span class="line">PCI-X 533   64/16位  133MHz      Quad Data Rate Hot Plugging, </span><br><span class="line">    3.3 &amp; 1.5 V,   ECC supported    4.26GB/s （主要应用在DDR2内存）</span><br><span class="line"></span><br><span class="line">说明：</span><br><span class="line">1. PCI-X 266 用上Double Data Rate技术，让每一个时钟脉冲的上升与下降边缘都可以传输数据，所以有多出了一 倍的机会来传输数据</span><br><span class="line">2. PCI-X 533规格更进一步采用每一个时钟脉冲可以传送四次（Quad Data Rate）的技术</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/langs/asm/8086汇编总结-16位微处理器8086/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/langs/asm/8086汇编总结-16位微处理器8086/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">8086汇编总结-16位微处理器8086</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-26 00:00:00" itemprop="dateCreated datePublished" datetime="2018-02-26T00:00:00+08:00">2018-02-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:43:08" itemprop="dateModified" datetime="2018-07-13T20:43:08+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">7k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">13 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1 id="目录">目录</h1>
<ul>
<li>第一章 微型计算机概述</li>
<li>第二章 16位微处理器8086</li>
<li>第三章 指令系统</li>
<li>第四章 汇编语言程序设计</li>
<li>第五章 存储器</li>
<li>第六章 输入/输出接口设计</li>
<li>第七章 中断系统</li>
<li>第八章 可编程接口芯片</li>
<li>第九章 AD/DA 转换</li>
<li>第十章 串行通信</li>
</ul>
<h1 id="第二章-16位微处理器8086">第二章 16位微处理器8086</h1>
<h2 id="微处理器性能指标">微处理器性能指标</h2>
<p>微处理器性能指标主要有2项：</p>
<ol type="1">
<li><p>字长：指CPU能同时处理的数据位数</p>
<p>如：8086为16位字长，80386为32位字长</p></li>
<li><p>主频：即CPU时钟频率，主频越高，速度越快</p>
<p>如：8086为5MHz，80386为16MHz，Pentium IV可达3GHz</p></li>
</ol>
<h2 id="指令执行过程">指令执行过程</h2>
<p><strong>取指令 -&gt; 指令译码 -&gt; 指令执行</strong></p>
<p>微型计算机的工作过程，也就是不断地取指令、译码和执行的过程，直到遇到停机指令时才结束机器的运行。</p>
<h2 id="流水线的概念">流水线的概念</h2>
<p>cpu流水线技术是一种将指令分解为多步，并让不同指令的各步操作重叠，从而实现几条指令并行处理，以加速程序运行过程的技术。指令的每步有各自独立的电路来处理，每完成一步，就进到下一步，而前一步则处理后续指令。</p>
<h2 id="内部结构">8086内部结构</h2>
<figure>
<img src="/images/asm-2/ScreenShot00024.jpg" alt="8086内部结构"><figcaption>8086内部结构</figcaption>
</figure>
<ul>
<li>(EU Execution Unit)执行单元:负责 指令的译码和执行</li>
<li>(BIU Bus Interface Unit)总线接口单元:负责与存储器、I/O口传送数据</li>
</ul>
<h3 id="总线接口单元biu">总线接口单元BIU</h3>
<ol type="1">
<li>具体功能
<ul>
<li>负责从内存取指令送到CPU内部的指令队列</li>
<li>CPU执行指令时，配合EU从指定存储单元或I/O口取数据，或把运算结果传送到指定存储单元或I/O口</li>
</ul></li>
<li>组成
<ul>
<li>4个16位段地址寄存器
<ul>
<li>CS (Code Segment) —代码段寄存器，代码段存放代码</li>
<li>DS (Data Segment) —数据段寄存器，数据段存放数据</li>
<li>SS (Stack Segment)—堆栈段寄存器，堆栈段用作堆栈操作</li>
<li>ES (Extra Segment)—扩展段寄存器，扩展段存放数据</li>
</ul>
<p>注：8086对存储器采用分段管理，4个段寄存器分别存放4个当前段的段地址，又称作段基址寄存器。</p></li>
<li><p>指令指针寄存器IP (Instruction Pointer)</p>
<p>16位IP存放当前代码段(CS)所要取出的下一条指令的偏移地址</p></li>
<li><p>地址加法器∑</p>
<p>8086用20位地址线寻址1MB内存空间，但其内部寄存器是16位的，因此需要用地址加法器∑根据16位寄存器的值计算出20位物理地址</p></li>
<li>指令缓冲队列
<ul>
<li>8086执行指令的同时，会从内存取1条或几条指令，取来的指令就存放在指令队列中，8086执行完一条指令就可立即执行下一条指令，无需轮番的取指令和执行指令，提高了CPU效率；</li>
<li>8086指令队列为6个字节，8088指令队列为4个字节；</li>
</ul></li>
<li>其他
<ul>
<li>暂存器：用于与EU通信的内部寄存器</li>
<li>总线控制电路：负责总线操作控制</li>
</ul></li>
</ul></li>
</ol>
<h3 id="执行单元eu">执行单元EU</h3>
<ul>
<li><p>16位算术逻辑单元ALU</p>
<p>主要是加法器，绝大部分指令执行都由加法器完成</p></li>
<li>4个16位数据寄存器（AX、BX、CX、DX）
<ul>
<li>可分为8个8位寄存器使用AH、AL、BH、BL、CH、CL、DH、DL</li>
<li>数据寄存器用于存放操作数及中间结果，AX和AL可用作累加操作，因此又称作累加器</li>
</ul></li>
<li>4个16位地址指针寄存器：通常用于存放操作数偏移地址
<ul>
<li>SP (Stack Pointer) — 堆栈指针寄存器，指示堆栈段栈顶位置</li>
<li>BP (Base Pointer) — 基址指针寄存器，指示堆栈段数据区基址</li>
<li>SI (Source Index) — 源变址寄存器，指示数据段源串地址</li>
<li>DI (Destination Index) — 目的变址寄存器，指示扩展段目的串地址</li>
</ul></li>
<li><p>标志寄存器 FLAG</p>
<p>6位状态标志，3位控制标志IF、DF、TF，剩下7位保留</p>
<figure>
<img src="/images/asm-2/ScreenShot00025.jpg" alt="标志寄存器"><figcaption>标志寄存器</figcaption>
</figure>
<p><strong>状态标志：</strong></p>
<ul>
<li>CF（Carry Flag）进(借)位标志，加法运算最高位产生进位或减法运算最高位产生借位，则CF置1，否则置0</li>
<li>AF（Auxiliary Carry Flag）辅助进位标志，加法运算时第3位往第4位有进位，或减法运算时第3位往第4位有借位，则AF置1，否则置0</li>
<li>ZF（Zero Flag）零标志, 若当前运算结果为零, 则ZF置1,否则置0</li>
<li>SF（Sign Flag）符号标志，与运算结果最高位相同，若为负数，则SF置1，否则置0，SF指示了当前运算结果是正还是负</li>
<li>OF（Overflow Flag）溢出标志，有符号数算术运算结果溢出，则OF置1，否则置0</li>
<li>PF（Parity Flag）奇偶标志，运算结果低8位所含1的个数为偶数则PF置1，否则置0，即奇校验低八位</li>
</ul>
<p><strong>控制标志：</strong></p>
<ul>
<li>DF（Direction Flag）方向标志 DF=1，串操作时，地址不断递减；DF=0，串操作时，地址不断递增</li>
<li>IF（Interrupt enable Flag）中断允许标志 IF=1，CPU允许接收可屏蔽中断请求，即开中断；IF=0，则关中断</li>
<li>TF（Trap Flag）跟踪标志，又称单步标志</li>
<li>TF=1，CPU为单步工作方式，每执行完一条指令产生一次软件中断</li>
<li>TF=0，CPU为正常工作，连续处理指令</li>
</ul></li>
</ul>
<h2 id="biu与eu的配合">BIU与EU的配合</h2>
<ol type="1">
<li>指令队列中出现两个字节为空时，BIU自动按CS和IP值组成20位物理 地址，到存储器中取指令，一次取两个字节指令存放到指令队列中</li>
<li>EU从BIU指令队列中读取指令</li>
<li>由EU控制电路对指令进行译码分析，指出操作性质及操作对象</li>
<li>EU执行指令，如需访问存储器或I/端口中的数据，则由EU给出数据 的16位偏移地址送给BIU</li>
<li>BIU由地址加法器∑形成20位绝对物理地址,并传递给存储器</li>
<li>存储器给出数据，BIU通过总线控制电路将其传送到CPU内部总线</li>
<li>EU将从内部总线获得数据，并送入ALU进行运算</li>
<li>EU运算出的结果，经内部总线送到指定的寄存器或暂存器，若需要将结果送给存储器，则由EU给出偏移地址，请求BIU产生20位实际物理地址，将结果写入存储器</li>
</ol>
<h2 id="存储器和io管理">存储器和I/O管理</h2>
<ol type="1">
<li><p>8086存储器编址</p>
<p><strong>8086具有20位地址线，可寻址1MB存储空间，编址为00000H～FFFFFH</strong></p></li>
<li><p>8086存储器管理</p>
<p>8086对存储器采用分段管理，将1MB空间分为若干个段，每段最多为64KB，一个程序可以有代码、数据、堆栈和扩展数据4个部分，每部分又可包含一个或几个段，代码部分包含的段均称为代码段，其余部分类似，分别由CS、DS、SS、ES指示每部分当前正在操作的段起始地址。实际CS、DS等存放的是20位段起始地址的高16位，即段地址。</p>
<p>对存储单元访问时，需要知道该存储单元所在段的起始地址，还需要知道该存储单元距离段起始位置的偏移量，即偏移地址，才能访问该存储单元。由于每段大小不会超过64KB，因此偏移地址用16位表示。</p>
<p>由于段寄存器是16位，偏移地址也为16位，而一个存储单元的物理地址是20位，因此8086需要通过地址加法器∑根据段地址和偏移地址形成20位物理地址。段地址和偏移地址组合称为逻辑地址。</p>
<p><strong>逻辑地址形式为 -&gt; 段地址 : 偏移地址</strong></p></li>
</ol>
<h3 id="位物理地址的形成">20位物理地址的形成</h3>
<p>(物理地址) 20 = 段地址左移4位 + 偏移地址 (物理地址) 20 = (段地址)*16 + 偏移地址</p>
<p>例：若逻辑地址为FFFFH : 0000H，则对应的物理地址为：</p>
<pre><code>    F  F  F  F       |   段地址     16位
+      0  0  0  0    |  + 偏移地址  16位
------------------   |  -----------------
    F  F  F  F  0    |   物理地址   20位</code></pre>
<p>**段寄存器 -&gt; 段地址，地址指针寄存器 -&gt; 偏移地址* 二者配对使用</p>
<h3 id="存储器管理的几点说明">存储器管理的几点说明</h3>
<ul>
<li>一个段总是从16字节边界开始，20位段起始地址的低4位总为0</li>
<li>同一个物理地址可以采取不同的逻辑地址形式表示</li>
<li><p>例：物理地址 12345H 可表示为1200 : 0345H 或 1230 : 0045H</p></li>
<li><p>尽管代码段、数据段、堆栈段、扩展段均为64KB，但实际应用时，不同段可以相互重叠或重合，但段内地址连续</p></li>
</ul>
<p>基本的对应的使用关系可见下图</p>
<figure>
<img src="/images/asm-2/ScreenShot00026.jpg" alt="段寄存器的对应关系"><figcaption>段寄存器的对应关系</figcaption>
</figure>
<h2 id="io-编址">8086 I/O 编址</h2>
<ul>
<li>8086用低16根地址线，寻址64KB的I/O端口，编址为0000H～FFFFH
<ul>
<li>一个I/O端口通常对应I/O接口电路中的一个存储单元，微机为每个端口分配一个地址，即为端口号</li>
<li>实际使用中8086只使用低10根地址线，寻址1KB的I/O端口</li>
</ul></li>
<li>8086对I/O端口操作，需要专门的IN、OUT指令，并且只能通过累加器（AX/AL）来完成，例： IN AL, 80H</li>
<li>8086系统中，<strong>存储器和I/O端口分别独立编址</strong>
<ul>
<li>存储器的地址范围是 00000H – 0FFFFFH</li>
<li>I/O端口的地址范围是 0000H – 0FFFFH</li>
</ul></li>
</ul>
<h2 id="引脚信号和工作模式">8086引脚信号和工作模式</h2>
<ol type="1">
<li><p>最小模式与最大模式</p>
<ul>
<li>两种工作模式，由 <span class="math inline">\(MN/\overline{MX}\)</span> 引脚决定。</li>
<li>最小模式：系统中只有一个处理器；<span class="math inline">\(MN/\overline{MX}\)</span>为高电平；</li>
<li>最大模式：系统中包括两个或多个处理器；<span class="math inline">\(MN/\overline{MX}\)</span>为低电平。</li>
<li>不同模式下，部分引脚定义不同</li>
</ul></li>
<li><p>8086引脚信号和功能</p>
<ul>
<li><p>8086引脚图和引脚分类图</p>
<p>8086 CPU为40pin双列直插（DIP)封装</p>
<figure>
<img src="/images/asm-2/ScreenShot00027.jpg" alt="8086引脚分类图"><figcaption>8086引脚分类图</figcaption>
</figure></li>
<li><p>最小模式下引脚信号和功能</p>
<p>1）总线信号</p>
<p>① AD0～AD15: 地址/数据复用引脚，双向工作。分时传送16位数据和地址的低16位，由ALE锁存地址信息。</p>
<p>② A16～A19（S3～S6）: 地址/状态复用引脚，输出。分时输出地址的高4位和CPU当前状态，地址信息由ALE锁存。</p>
<p>③ BHE/S7: 高8位数据总线允许/状态复用引脚，输出。低电平有效，表示高8位数据线D15～D8上数据有效</p>
<p>④ ALE: 地址锁存允许信号输出。高电平有效，表示总线上的信息是地址信息。</p>
<p>2）总线控制信号</p>
<p>① HOLD: 总线保持请求信号输入。高电平有效，表示其他模块（如DMA)申请占用总线</p>
<p>② HLDA: 总线保持响应信号输出，高电平有效，表示CPU已让出总线</p>
<p>3）系统控制信号</p>
<p>① M/IO: 存储器/输入输出选择信号，输出，高电平表示CPU访问存储器，低电平表示CPU访问I/O端口</p>
<p>② RD: 读信号输出，低电平有效，表示CPU从存储器或I/O口读入信息</p>
<p>③ WR: 写信号输出，低电平有效，表示CPU向存储器或I/O口输出数据</p>
<p>④ DT/R: 数据收发信号输出。高电平表示CPU正在发送数据，低电平表示CPU接收数据</p>
<p>⑤ DEN: 数据允许信号输出。低电平有效，表示CPU当前准备发送或接收一个数据</p>
<p>4）中断控制信号</p>
<p>① INTR: 可屏蔽中断请求信号输入。高电平有效，表示外部向CPU提出中断申请</p>
<p>② INTA: 中断响应信号输出，<strong>低电平有效</strong>，表示CPU响应外设中断请求</p>
<p>③ NMI: 非屏蔽中断请求信号输入。<strong>上升沿有效</strong>。表示外部有非屏蔽中断申请。非屏蔽中断不受软件控制，CPU必须响应</p>
<p>5）CPU控制信号</p>
<p>① RESET: 复位信号输入。高电平有效，至少保持4个时钟周期的高电平。复位时CPU停止现行操作，开始复位，并进行初始化：标志寄存器FLAG、IP、DS、SS、ES及指令队列均清零，CS为FFFFH，复位结束时CPU从FFFF0H开始执行程序</p>
<p>② MN/MX：最小模式/最大模式选择信号输入</p>
<p>③ READY：“准备好”信号输入，高电平有效，表示存储器或I/O口已准备就绪，可进行一次数据传输</p>
<p>④ TEST: 测试信号输入，低电平有效，有效时CPU退出WAIT指令</p>
<p>6）其它信号</p>
<p>① CLK: 时钟信号，8086主频为4.77MHZT=210ns；单相，占空比为1/3。</p>
<p>② VCC,GND: 电源及地，+5V，满足TTL规范</p></li>
</ul></li>
<li><p>最大模式下8086有8个控制信号被重新定义，对应关系如下：</p>
<figure>
<img src="/images/asm-2/ScreenShot00034.jpg" alt="最大模式重新定义"><figcaption>最大模式重新定义</figcaption>
</figure></li>
</ol>
<h2 id="引脚信号与功能">8088引脚信号与功能</h2>
<p>8088为准16位机，片内数据总线宽度为16位，片外为8位，引脚信号和功能与8086类似，二者 <strong><em>差别如下</em></strong>：</p>
<pre><code>8086微处理器                8088微处理器
16位AD复用                  8位AD复用
BHE高八位数据允许           SS0/高电平
M/IO引脚选择存储器/IO口     M/IO引脚选择存储器/IO口</code></pre>
<h2 id="总线连接">总线连接</h2>
<ol type="1">
<li><p>8086最小模式下的总线连接</p>
<p>很重要的图。</p>
<figure>
<img src="/images/asm-2/ScreenShot00028.jpg" alt="8086最小模式连接图"><figcaption>8086最小模式连接图</figcaption>
</figure>
<p>1）Intel 8282</p>
<p>把AD复用引脚连接到地址总线的8位地址锁存器。3片8282(功能同74LS373)A0～A19和BHE，ALE为锁存信号。</p>
<p>2）Intel 8286</p>
<p>把AD复用引脚连接到数据总线的8位数据缓冲器。2片8286(功能同74LS245)做D15～D0的缓冲器，DT/R做方向选择，DEN为选通信号。</p>
<p>3） 控制信号M/IO、RD和WR</p>
<p>完成信息传递控制。组合起来完成右面的控制。</p>
<p>4）中断控制信号INTR、INTA、NMI</p>
<ul>
<li>INTR: 外部可屏蔽中断请求引脚，高电平有效</li>
<li>INTA: 中断响应信号，低电平有效</li>
<li>NMI: 不可屏蔽中断请求引脚，上升沿有效</li>
</ul>
<p>5）总线控制信号HOLD、HLDA</p>
<ul>
<li>HOLD：总线保持请求引脚,高电平有效</li>
<li>HLDA：总线保持响应引脚，高电平有效</li>
<li>HLDA控制8282的OE，当CPU总线保持响应时让出总线</li>
</ul></li>
<li><p>8086最大模式下的总线</p>
<figure>
<img src="/images/asm-2/ScreenShot00029.jpg" alt="8086最大模式下总线连接"><figcaption>8086最大模式下总线连接</figcaption>
</figure></li>
</ol>
<h2 id="时钟电路与复位电路">8086时钟电路与复位电路</h2>
<figure>
<img src="/images/asm-2/ScreenShot00030.jpg" alt="8086时钟电路与复位电路"><figcaption>8086时钟电路与复位电路</figcaption>
</figure>
<p>8284为8086提供CLK时钟信号、RESET复位信号和READY准备好信号</p>
<ul>
<li>8086/8088内部无时钟发生器，时钟由8284提供，频率为4.77MHz</li>
<li>输入/RES经8284内部斯密特触发器整形，同步后产生RESET信号,给CPU复位</li>
<li>外界准备好信号输入到8284的RDY端，同步后产生READY信号给CPU</li>
</ul>
<figure>
<img src="/images/asm-2/ScreenShot00031.jpg" alt="8284内部逻辑图"><figcaption>8284内部逻辑图</figcaption>
</figure>
<h2 id="系统的复位操作和启动过程">8086/8088系统的复位操作和启动过程</h2>
<ol type="1">
<li>CPU接到RESET信号，停止现有工作，进行复位操作：CS置FFFFH，IP置0，指令队列清空，其余寄存器清0；</li>
<li>从存储器FFFFH :0000H取第一条指令，一般在此处放一条跳转指令，跳转到ROM BIOS中的系统测试程序；</li>
<li>系统测试程序执行硬件自检(对CPU、RAM、ROM等硬件进行测试)，然后执行ROM BIOS中的初始引导程序；</li>
<li>初始引导程序再从磁盘0面0道1扇区装入引导程序，执行引导操作；</li>
<li>按引导程序的指令，顺序装入其他程序模块，完成操作系统的引导操作；</li>
</ol>
<p>注：在3、4步之间微机还会检查C0000H开始的扩展ROM空间中是否有程序，如果有，并且校验正确，则先执行这些程序</p>
<h2 id="总线周期">8086总线周期</h2>
<p>CPU取指令或传送数据时，均需要通过BIU进行总线操作，而总线操作是 根据时钟脉冲CLK一个节拍一个节拍的完成。</p>
<ol type="1">
<li>时钟周期T（T状态）</li>
</ol>
<p>时钟脉冲的一个循环时间叫做一个时钟周期。每个时钟周期T又称为一个“状态”。它是CPU工作的最小时间单位，是计算机系统工作速度的重要标 志。8086 CPU的F=4.77M，T=210ns</p>
<ol start="2" type="1">
<li><p>总线周期</p>
<p><strong>CPU通过总线从存储器或I/O端口存取一个字或字节的时间称为总线周期</strong></p>
<ul>
<li>包括三类：存储器读写周期、I/O端口读写周期、中断响应周期</li>
<li>一个基本总线周期包括4个状态：T1，T2，T3，T4</li>
</ul></li>
<li><p>指令周期</p>
<p>执行一条指令所需要的时间称为指令周期。8086指令周期最短为2个时 钟周期，最长为200个时钟周期。</p></li>
</ol>
<p>例：时钟周期、总线周期、指令周期举例</p>
<figure>
<img src="/images/asm-2/ScreenShot00032.jpg" alt="各种周期"><figcaption>各种周期</figcaption>
</figure>
<ul>
<li>在总线周期的T3状态，CPU会检查READY引脚，若为低电平无效，则CPU会在T3之后插入等待周期Tw，等待外界准备好，在每个Tw状态会继续检查READY引脚，直到READY变为高电平有效才进入T4状态</li>
<li>在两个总线操作中间，系统总线处于空闲状态，CPU便会在两个总线周期之间插入空闲周期Ti，在Ti状态，CPU不执行任何总线操作</li>
</ul>
<h2 id="总线操作时序">8086总线操作时序</h2>
<p>这里的图上的BHE描述的是8282锁存前方位置的信号。所以T2会有变换。实际上真正到了存储存储器作用的是被锁存住的信号。</p>
<figure>
<img src="/images/asm-2/ScreenShot00033.jpg" alt="时序"><figcaption>时序</figcaption>
</figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/life/2017总结/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/life/2017总结/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">2017年总结</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-24 12:05:20" itemprop="dateCreated datePublished" datetime="2018-02-24T12:05:20+08:00">2018-02-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:52:02" itemprop="dateModified" datetime="2018-07-13T20:52:02+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/生活与思考/" itemprop="url" rel="index"><span itemprop="name">生活与思考</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">2.6k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">5 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一">一</h1>
<p>2017年转瞬即逝，倏忽间，便已是2018。</p>
<p>回顾2017，我所希望的目的是，可以找到自己的不足，找到更多的缺点，找到，那个熟悉的自己。</p>
<h1 id="二">二</h1>
<p>人生天地之间，若白驹之过隙，忽然而已。</p>
<p>一七年，是鸡年，我已经忘了春晚是什么样子，我也忘了年初那个寒假，是如何度过的。</p>
<p>一七年，已经陷入了遗忘的轮回。所有的色彩都在变得稀薄，所有的味道都在变得寡淡，所有的人影都在变得模糊。</p>
<p>记忆的长廊里，愈发的在被新时光填充，新的色彩绘成了新的画面，挂在了墙上，新的声音汇成了新的曲调，飘荡在空气中。</p>
<p>这一年里，过得匆忙，还没反应过来，就已经到了年末，新的年初。</p>
<p>这一年，学了好多的课程，但是印象最深的不过计算机原理和随机信号分析，主要是因为和这两门课的老师联系比较密切。给他们留下了比较好的印象。</p>
<p>接触了8086汇编，学到了计算的组成所涉及到的方方面面，顿时对于眼前所面对的这个东西多了一份熟悉感。</p>
<p>之后会整理一下汇编语言的知识。</p>
<p>随机信号重新温习了一遍概率论的知识，但是却总是感觉流于表面，在学习的过程中，总是有一层纱，一直笼罩在我的面前，戳不破，点不透。模模糊糊，就这样在最后的考试中，以一个96作结。</p>
<p>对于一七年上半年，已经没了任何印象。而下半年，主要是开始摸到了考研的边缘，生活节奏顿时快了许多，也更加单调了许多。放弃了很多的事情（其实实际上而言，不算放弃，只是更加的不再主动），将所有的精力放在了学习上，从最开始的独飞，到考试前的集体自习，不断感受着“强者们”的强，学习的事，靠的是自己，但是考试的事，却在此时，无比显然的凸显着集体的力量。</p>
<p>更多的考试习题，被“强者们”从各种渠道搞来，只有你身为其中的一分子（是“一分子”，而非“一份子”）的时候，你才能感受到独自作战时捉襟见肘的无奈。</p>
<p>唉，这个社会……</p>
<h1 id="三">三</h1>
<p>一七年看了好多电影和电视剧。</p>
<p>国内的：</p>
<ul>
<li>段奕宏的《引爆者》
<ul>
<li>有很多背景与与我的家乡相似</li>
<li>那绚丽的烟花，是愤怒与无奈</li>
</ul></li>
<li>潘粤明的《白夜追凶》
<ul>
<li>近年来，国产剧的最大惊喜</li>
</ul></li>
<li>大鹏的《缝纫机乐队》
<ul>
<li>让我改变了对于《屌丝男士》的大鹏的低俗印象，里面的音乐确实好听。</li>
</ul></li>
<li>不思凡的《大护法》
<ul>
<li>犀利</li>
</ul></li>
<li>周冬雨的《喜欢你》和《七月与安生》
<ul>
<li>自此喜欢上了这个肤白貌美，笑起来眼睛都不见了的姑娘。</li>
<li>她的笑容，看着就开心。</li>
</ul></li>
<li>……</li>
</ul>
<p>亚洲的：</p>
<ul>
<li>今敏的《东京教父》
<ul>
<li>似乎是今敏唯一一部比较温情的电影。</li>
</ul></li>
<li>“京アニ”（京阿尼，京都动画）的《声之形》
<ul>
<li>好虐呀，虽说有点矫情。</li>
<li>配乐很好听。</li>
</ul></li>
<li>新海诚的《你的名字》与《言叶之庭》
<ul>
<li>真，漂亮，的画面。</li>
<li>配乐，画面双绝。</li>
</ul></li>
<li>宫崎骏的《起风了》
<ul>
<li>好看，没话说。</li>
<li>理想，爱情。</li>
</ul></li>
<li>阿米尔·汗的《摔跤吧，爸爸》
<ul>
<li>对社会现实的批判，对于女性的鼓励与尊重。</li>
</ul></li>
<li>押井守的《攻壳机动队》(1,2)
<ul>
<li>吊吊吊，没话说，逼格，就是逼格。</li>
</ul></li>
<li>……</li>
</ul>
<p>欧美的：</p>
<ul>
<li>雷德利·斯科特的《银翼杀手》
<ul>
<li>黑暗，压抑，细节丰富，画面色彩独特，内涵深刻</li>
</ul></li>
<li>维伦纽瓦的《银翼杀手2049》
<ul>
<li>压抑，色彩更炫丽，依旧不失深度，对于自我身份的认知的不断反转，最后感觉好可怜</li>
</ul></li>
<li>诺兰的《蝙蝠侠：黑暗骑士三部曲》和《敦刻尔克》
<ul>
<li>非线性叙事玩出了花。</li>
<li>前者黑暗骑士，另类的英雄，独具特色的反派与配角。牛逼的小丑。</li>
<li>后者以另类的方式讲述战争。</li>
</ul></li>
<li>埃德加·赖特的《极盗车神》
<ul>
<li>没有了音乐，这部片子就没意思了。</li>
<li>有了音乐，这部片子就神了。</li>
</ul></li>
<li>盖尔·加朵的《神奇女侠》
<ul>
<li>盖尔·加朵好美呀！</li>
</ul></li>
<li>张艺谋的《长城》
<ul>
<li>好一部怪兽围城。</li>
</ul></li>
<li>周杰伦、摩根·弗里曼的《惊天魔盗团2》
<ul>
<li>杰杰六六六。</li>
</ul></li>
<li>克里斯·埃文斯（美队）的《天才少女》
<ul>
<li>温情，感人。</li>
<li>小姑娘让我想起了《怒火救援》里的达科塔·范宁。</li>
</ul></li>
<li>斯嘉丽·约翰逊的《唐璜》
<ul>
<li>嘿嘿嘿……</li>
</ul></li>
<li>埃米纳姆的《八英里》
<ul>
<li>姆爷的曾经过往。</li>
<li>女主挺漂亮。</li>
<li>说唱很犀利。</li>
</ul></li>
<li>……</li>
</ul>
<p>看了不少，主要以电影为主，幸好有PT资源站，感谢IPV6，让我们身处校园内，可以免费获取那么丰富的资源。</p>
<p>感谢这些片子，给了我美好的回忆。</p>
<h1 id="四">四</h1>
<p>一七年，比较值得纪念的一次旅行——去了一趟长沙。</p>
<p>飞机飞济南，火车直奔长沙。</p>
<p>这是两个“第一次”——第一次坐飞机，第一次坐火车。</p>
<p>以前对于飞机的感觉就是高大上，机票贼啦贵，一般不愿意坐飞机，更多是选择火车。但是这次受地理条件以及时间所限，坐飞机是一个比较合适的方式，否则就要绕好大一圈的渤海湾。</p>
<p>大连真是祖国的“犄角旮旯”呀！</p>
<p>头一次感受到了卧铺的方便与舒服（相较于硬座而言），四个人，一起嗨。他们仨玩扑克，我玩了几把就不想玩了。不太喜欢这一类游戏，总感觉没意思。不过，辛好我带了本书，《灿烂千阳》，去时看了一路。</p>
<p>这一路上，我们看过了白云拥挤的沉在我们的下方，看过了云雾缭绕的泰山在我们的窗外耸立，看过了从南到北的各色人潮，或多或少的认识到了，所谓的地大物博。</p>
<p>南方真热，尤其是在北方已经开始热起来的时候。到了长沙，最先做的就是洗澡。带了两天，洗了两次澡，其他时间就在吹空调。</p>
<p>第二天晚上，一切结束了，就出去和小伙伴们吃了一顿红烧肉，米饭免费供应。感觉很棒，肥而不腻，又香又辣，吃的我们爽个不停。</p>
<p>次日，就准备回学校了。在上火车之前，我们上了橘子洲头，见到了毛爷爷的巨大塑像。那时大家已经是湿透了，全是汗。在走向洲头的时候，感觉衣服将皮肤摩擦的疼痛无比。大家是叫苦不迭。太热了。但是为什么还是那么多的人？</p>
<figure>
<img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1519472006644&amp;di=cb6febf32b97e602a9220908602f17c0&amp;imgtype=0&amp;src=http%3A%2F%2Fyouimg1.c-ctrip.com%2Ftarget%2F100f050000000jd6pE51D.jpg" alt="橘子洲头毛爷爷塑像"><figcaption>橘子洲头毛爷爷塑像</figcaption>
</figure>
<p>绕了个大圈。绕道开封。刚听说要到开封，就在想，开封会是什么样的一个城市。但是经过数个小时颠簸又熬夜的硬座，到了之后，有一种“幻想破灭”的感觉。</p>
<p>感觉回到了自己老家那个小县城。乘兴而来，失望而归。无奈。</p>
<p>十几个小时的卧铺之后，终于回到了学校。终于可以回家了。</p>
<p>这几十个小时的颠簸旅程，倒是成了我日后被学习压得喘不过气来的时候，可以偶尔回头细品的一段记忆。</p>
<h1 id="五">五</h1>
<p>一七年，过去了，就像他来的那样，匆匆，去也一般。</p>
<p>一八年，来了。</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/langs/r/R基本数据结构/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/langs/r/R基本数据结构/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">R基本数据结构</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:46:06" itemprop="dateCreated datePublished" datetime="2018-02-15T21:46:06+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:51:29" itemprop="dateModified" datetime="2018-07-13T20:51:29+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">24k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">44 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>主站：https://lartpang.github.io/</p>
</blockquote>
<p>之前一阵子，在EDX上学习了R语言的一门基础课程，这里做个总结。这门课程主要侧重于R的数据结构的介绍，当然也介绍了它的基本的绘图手段。</p>
<h1 id="工作空间相关">工作空间相关</h1>
<pre><code>ls()

## character(0)

rm(a)

## Warning in rm(a): 找不到对象&#39;a&#39;

ls()

## character(0)</code></pre>
<h1 id="基本数据类型">基本数据类型</h1>
<ol type="1">
<li>logical
<ul>
<li>TRUE/FALSE/NA/T/F(推荐使用完整形式)/某些时候的0与非0</li>
</ul></li>
<li>numeric
<ul>
<li>integer is numeric</li>
<li>numeric not always integer</li>
</ul></li>
<li>character</li>
</ol>
<p>Other atomic types:</p>
<ul>
<li>double: higher precision</li>
<li>complex: complex numbers</li>
<li>raw: store raw bytes</li>
</ul>
<blockquote>
<p><code>is.*()</code>返回括号内内容是否是<code>*</code>对应类型。</p>
</blockquote>
<pre><code># logical
TRUE

## [1] TRUE

class(TRUE)

## [1] &quot;logical&quot;

FALSE

## [1] FALSE

class(NA)

## [1] &quot;logical&quot;

T

## [1] TRUE

F

## [1] FALSE

# numeric
2

## [1] 2

class(2)

## [1] &quot;numeric&quot;

2.5

## [1] 2.5

class(2.5)

## [1] &quot;numeric&quot;

2L

## [1] 2

class(2L) 

## [1] &quot;integer&quot;

is.numeric(2)

## [1] TRUE

is.numeric(2L)

## [1] TRUE

#integer is numeric 
#numeric not always integer
is.integer(2)

## [1] FALSE

is.integer(2L)

## [1] TRUE

# character
 &quot;I love data science!&quot;

## [1] &quot;I love data science!&quot;

 class(&quot;I love data science!&quot;)

## [1] &quot;character&quot;</code></pre>
<h2 id="强制转换">强制转换</h2>
<blockquote>
<p><code>as.*()</code>返回括号内内容转化为<code>*</code>对应类型后的结果，有些情况无法转换。</p>
</blockquote>
<pre><code>as.numeric(TRUE)

## [1] 1

as.numeric(FALSE)

## [1] 0

as.character(4)

## [1] &quot;4&quot;

as.numeric(&quot;4.5&quot;)

## [1] 4.5

as.integer(&quot;4.5&quot;)

## [1] 4

as.numeric(&quot;Hello&quot;)

## Warning: 强制改变过程中产生了NA

## [1] NA</code></pre>
<h1 id="向量-vector">向量 Vector</h1>
<ul>
<li>Sequence of data elements</li>
<li><strong>Same basic type</strong>
<ul>
<li>Automatic coercion if necessary</li>
</ul></li>
<li>character, numeric, logical</li>
<li>Single value = Vector</li>
</ul>
<h2 id="创建-c或者利用">创建 <code>c()</code>或者利用<code>:</code></h2>
<pre><code># c()
drawn_suits &lt;- c(&quot;hearts&quot;, &quot;spades&quot;, &quot;diamonds&quot;,  
                   &quot;diamonds&quot;, &quot;spades&quot;)
drawn_suits

## [1] &quot;hearts&quot;   &quot;spades&quot;   &quot;diamonds&quot; &quot;diamonds&quot; &quot;spades&quot;

is.vector(drawn_suits)

## [1] TRUE

# :
1:5

## [1] 1 2 3 4 5

is.vector(1:5)

## [1] TRUE</code></pre>
<h2 id="命名-names">命名 <code>names()</code></h2>
<pre><code>remain &lt;- c(11, 12, 11, 13)
suits &lt;- c(&quot;spades&quot;, &quot;hearts&quot;, &quot;diamonds&quot;, &quot;clubs&quot;)
names(remain) &lt;- suits
remain 

##   spades   hearts diamonds    clubs 
##       11       12       11       13

#or
remain &lt;- c(spades = 11, hearts = 12,  
              diamonds = 11, clubs = 13)
remain

##   spades   hearts diamonds    clubs 
##       11       12       11       13

#or
remain &lt;- c(&quot;spades&quot; = 11, &quot;hearts&quot; = 12,  
              &quot;diamonds&quot; = 11, &quot;clubs&quot; = 13)
remain

##   spades   hearts diamonds    clubs 
##       11       12       11       13</code></pre>
<h2 id="单值仍为向量">单值仍为向量</h2>
<pre><code>my_apples &lt;- 5 
my_oranges &lt;- &quot;six&quot; 
is.vector(my_apples)

## [1] TRUE

is.vector(my_oranges)

## [1] TRUE

length(my_apples)

## [1] 1

length(my_oranges)

## [1] 1</code></pre>
<h2 id="强制变换">强制变换</h2>
<pre><code>drawn_ranks &lt;- c(7, 4, &quot;A&quot;, 10, &quot;K&quot;, 3, 2, &quot;Q&quot;)
drawn_ranks

## [1] &quot;7&quot;  &quot;4&quot;  &quot;A&quot;  &quot;10&quot; &quot;K&quot;  &quot;3&quot;  &quot;2&quot;  &quot;Q&quot;

class(drawn_ranks)

## [1] &quot;character&quot;</code></pre>
<h2 id="基本运算">基本运算</h2>
<p>很自然的可以由单数的运算推广出来。</p>
<pre><code># with number: +-*/
earnings &lt;- c(50, 100, 30)
earnings * 3

## [1] 150 300  90

earnings^2

## [1]  2500 10000   900

# with vector: +-*/
earnings &lt;- c(50, 100, 30) 
expenses &lt;- c(30, 40, 80) 
bank &lt;- earnings - expenses
## sum() &gt;
sum(bank)

## [1] 30

earnings &gt; expenses

## [1]  TRUE  TRUE FALSE

## multiplication and division are done element-wise!
earnings * c(1, 2, 3)

## [1]  50 200  90</code></pre>
<h2 id="子集">子集</h2>
<p>三种索引方式</p>
<ul>
<li>序号（R从1开始）</li>
<li>名字 —— names()的利用</li>
<li>逻辑值</li>
</ul>
<!-- -->
<pre><code>remain &lt;- c(spades = 11, hearts = 12,  
              diamonds = 11, clubs = 13)
remain[1]

## spades 
##     11

remain[&quot;spades&quot;]

## spades 
##     11

remain[c(4, 1)] # 此法可以用来交换或者抽取特定位置的元素

##  clubs spades 
##     13     11

remain[c(&quot;clubs&quot;, &quot;spades&quot;)]

##  clubs spades 
##     13     11

# 逻辑值索引，短的会被自动循环使用
remain[c(TRUE, FALSE)]

##   spades diamonds 
##       11       11

remain[c(TRUE, FALSE, TRUE, FALSE)]

##   spades diamonds 
##       11       11

# 负索引，“all but it”，返回除此之外的元素
remain[-1]

##   hearts diamonds    clubs 
##       12       11       13

remain[-c(1, 2)]

## diamonds    clubs 
##       11       13

#remain[-&quot;spades&quot;] #can&#39;t work</code></pre>
<h1 id="矩阵-matrix">矩阵 Matrix</h1>
<ul>
<li>Vector: 1D array of data elements</li>
<li>Matrix: 2D array of data elements</li>
<li>Rows and columns</li>
<li>One atomic vector type</li>
</ul>
<h2 id="创建-matrix">创建 <code>matrix()</code></h2>
<p><strong>默认按列填充</strong></p>
<pre><code># 直接创建
matrix(1:6, nrow = 2)

##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6

matrix(1:6, ncol = 3)

##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6

matrix(1:6, nrow = 2, byrow = TRUE)

##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6

# 循环创建
matrix(1:3, nrow = 2, ncol = 3)

##      [,1] [,2] [,3]
## [1,]    1    3    2
## [2,]    2    1    3

matrix(1:4, nrow = 2, ncol = 3)

## Warning in matrix(1:4, nrow = 2, ncol = 3): 数据长度[4]不是矩阵列数[3]的整
## 倍数

##      [,1] [,2] [,3]
## [1,]    1    3    1
## [2,]    2    4    2

# 组合创建
cbind(1:3, 1:3)

##      [,1] [,2]
## [1,]    1    1
## [2,]    2    2
## [3,]    3    3

rbind(1:3, 1:3)

##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    1    2    3

m &lt;- matrix(1:6, byrow = TRUE, nrow = 2)
rbind(m, 7:9)

##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
## [3,]    7    8    9

cbind(m, c(10, 11))

##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3   10
## [2,]    4    5    6   11</code></pre>
<h2 id="命名">命名</h2>
<p><code>rownames()</code>, <code>colnames()</code></p>
<pre><code>m &lt;- matrix(1:6, byrow = TRUE, nrow = 2)
rownames(m) &lt;- c(&quot;row1&quot;, &quot;row2&quot;)
m

##      [,1] [,2] [,3]
## row1    1    2    3
## row2    4    5    6

colnames(m) &lt;- c(&quot;col1&quot;, &quot;col2&quot;, &quot;col3&quot;)
m

##      col1 col2 col3
## row1    1    2    3
## row2    4    5    6

# 直接命名
m &lt;- matrix(1:6, byrow = TRUE, nrow = 2,  
              dimnames = list(c(&quot;row1&quot;, &quot;row2&quot;),  
                              c(&quot;col1&quot;, &quot;col2&quot;, &quot;col3&quot;))) 
m

##      col1 col2 col3
## row1    1    2    3
## row2    4    5    6</code></pre>
<h2 id="强制转换-1">强制转换</h2>
<pre><code>num &lt;- matrix(1:8, ncol = 2)
num

##      [,1] [,2]
## [1,]    1    5
## [2,]    2    6
## [3,]    3    7
## [4,]    4    8

char &lt;- matrix(LETTERS[1:6], nrow = 4, ncol = 3)
char

##      [,1] [,2] [,3]
## [1,] &quot;A&quot;  &quot;E&quot;  &quot;C&quot; 
## [2,] &quot;B&quot;  &quot;F&quot;  &quot;D&quot; 
## [3,] &quot;C&quot;  &quot;A&quot;  &quot;E&quot; 
## [4,] &quot;D&quot;  &quot;B&quot;  &quot;F&quot;

num &lt;- matrix(1:8, ncol = 2)
char &lt;- matrix(LETTERS[1:6], nrow = 4, ncol = 3)
cbind(num, char)

##      [,1] [,2] [,3] [,4] [,5]
## [1,] &quot;1&quot;  &quot;5&quot;  &quot;A&quot;  &quot;E&quot;  &quot;C&quot; 
## [2,] &quot;2&quot;  &quot;6&quot;  &quot;B&quot;  &quot;F&quot;  &quot;D&quot; 
## [3,] &quot;3&quot;  &quot;7&quot;  &quot;C&quot;  &quot;A&quot;  &quot;E&quot; 
## [4,] &quot;4&quot;  &quot;8&quot;  &quot;D&quot;  &quot;B&quot;  &quot;F&quot;</code></pre>
<h2 id="子集运算">子集运算</h2>
<pre><code>m &lt;- matrix(sample(1:15, 12), nrow = 3)
rownames(m) &lt;- c(&quot;r1&quot;, &quot;r2&quot;, &quot;r3&quot;) 
colnames(m) &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;)
m

##     a  b  c  d
## r1  7  5  6 10
## r2  3  9 12  8
## r3 15 13  2  4

m[1,3]

## [1] 6

m[3,] 

##  a  b  c  d 
## 15 13  2  4

m[,3]

## r1 r2 r3 
##  6 12  2

m[4] # 默认按列计数 

## [1] 5

m[2, c(2, 3)]

##  b  c 
##  9 12

m[c(1, 2), c(2, 3)]

##    b  c
## r1 5  6
## r2 9 12

m[c(1, 3), c(1, 3, 4)]

##     a c  d
## r1  7 6 10
## r3 15 2  4

m[&quot;r2&quot;,&quot;c&quot;]

## [1] 12

m[2,&quot;c&quot;]

## [1] 12

m[3, c(&quot;c&quot;, &quot;d&quot;)]

## c d 
## 2 4

m[c(FALSE, FALSE, TRUE),  
    c(FALSE, TRUE, FALSE, TRUE)] 

##  b  d 
## 13  4

m[c(FALSE, FALSE, TRUE),  
    c(FALSE, TRUE)]

##  b  d 
## 13  4</code></pre>
<h2 id="矩阵运算">矩阵运算</h2>
<ul>
<li><code>colSums(), rowSums()</code></li>
<li>Standard arithmetic possible</li>
<li><strong>Element-wise</strong> computation</li>
</ul>
<!-- -->
<pre><code>the_fellowship &lt;- c(316, 556) 
two_towers &lt;- c(343, 584) 
return_king &lt;- c(378, 742) 
lotr_matrix &lt;- rbind(the_fellowship, two_towers, return_king) 
colnames(lotr_matrix) &lt;- c(&quot;US&quot;, &quot;non-US&quot;) 
rownames(lotr_matrix) &lt;- c(&quot;Fellowship&quot;, &quot;Two Towers&quot;,  
                             &quot;Return King&quot;) 
lotr_matrix

##              US non-US
## Fellowship  316    556
## Two Towers  343    584
## Return King 378    742

# 与数字 +-*/
lotr_matrix / 1.12 

##                   US   non-US
## Fellowship  282.1429 496.4286
## Two Towers  306.2500 521.4286
## Return King 337.5000 662.5000

lotr_matrix - 50

##              US non-US
## Fellowship  266    506
## Two Towers  293    534
## Return King 328    692

# 与矩阵 +-*/ (这里不是线性代数中的矩阵计算)
theater_cut &lt;- matrix(c(50, 80, 100), nrow = 3, ncol = 2)
theater_cut

##      [,1] [,2]
## [1,]   50   50
## [2,]   80   80
## [3,]  100  100

lotr_matrix - theater_cut

##              US non-US
## Fellowship  266    506
## Two Towers  263    504
## Return King 278    642

# 与向量
lotr_matrix - c(50, 80, 100) #按列循环计算

##              US non-US
## Fellowship  266    506
## Two Towers  263    504
## Return King 278    642</code></pre>
<h1 id="因子-factors">因子 Factors</h1>
<ul>
<li>Factors for categorical variables</li>
<li>Limited number of different values</li>
<li>Belong to category</li>
</ul>
<h2 id="创建因子-factor">创建因子 <code>factor()</code></h2>
<pre><code>blood &lt;- c(&quot;B&quot;, &quot;AB&quot;, &quot;O&quot;, &quot;A&quot;, &quot;O&quot;, &quot;O&quot;, &quot;A&quot;, &quot;B&quot;)
blood

## [1] &quot;B&quot;  &quot;AB&quot; &quot;O&quot;  &quot;A&quot;  &quot;O&quot;  &quot;O&quot;  &quot;A&quot;  &quot;B&quot;

blood_factor &lt;- factor(blood) # 默认等级按照字母顺序定
blood_factor

## [1] B  AB O  A  O  O  A  B 
## Levels: A AB B O

str(blood_factor)

##  Factor w/ 4 levels &quot;A&quot;,&quot;AB&quot;,&quot;B&quot;,&quot;O&quot;: 3 2 4 1 4 4 1 3

# 自定义level
blood_factor2 &lt;- factor(blood, 
                          levels = c(&quot;O&quot;, &quot;A&quot;, &quot;B&quot;, &quot;AB&quot;))
blood_factor2

## [1] B  AB O  A  O  O  A  B 
## Levels: O A B AB

str(blood_factor2)

##  Factor w/ 4 levels &quot;O&quot;,&quot;A&quot;,&quot;B&quot;,&quot;AB&quot;: 3 4 1 2 1 1 2 3</code></pre>
<h2 id="rename-factor-levels">Rename factor levels</h2>
<pre><code>blood &lt;- c(&quot;B&quot;, &quot;AB&quot;, &quot;O&quot;, &quot;A&quot;, &quot;O&quot;, &quot;O&quot;, &quot;A&quot;, &quot;B&quot;)
#1.1
blood_factor &lt;- factor(blood)
levels(blood_factor) &lt;- c(&quot;BT_A&quot;, &quot;BT_AB&quot;, &quot;BT_B&quot;, &quot;BT_O&quot;)
#1.2
blood &lt;- c(&quot;B&quot;, &quot;AB&quot;, &quot;O&quot;, &quot;A&quot;, &quot;O&quot;, &quot;O&quot;, &quot;A&quot;, &quot;B&quot;) 
blood_factor &lt;- factor(blood) 
factor(blood,  
         levels = c(&quot;O&quot;, &quot;A&quot;, &quot;B&quot;, &quot;AB&quot;),  
         labels = c(&quot;BT_O&quot;, &quot;BT_A&quot;, &quot;BT_B&quot;, &quot;BT_AB&quot;))

## [1] BT_B  BT_AB BT_O  BT_A  BT_O  BT_O  BT_A  BT_B 
## Levels: BT_O BT_A BT_B BT_AB

#2
factor(blood, labels = c(&quot;BT_A&quot;, &quot;BT_AB&quot;, &quot;BT_B&quot;, &quot;BT_O&quot;))

## [1] BT_B  BT_AB BT_O  BT_A  BT_O  BT_O  BT_A  BT_B 
## Levels: BT_A BT_AB BT_B BT_O</code></pre>
<h2 id="ordered-factor">Ordered factor</h2>
<pre><code>blood &lt;- c(&quot;B&quot;, &quot;AB&quot;, &quot;O&quot;, &quot;A&quot;, &quot;O&quot;, &quot;O&quot;, &quot;A&quot;, &quot;B&quot;)
blood_factor &lt;- factor(blood) 
blood_factor[1] &lt; blood_factor[2] 

## Warning in Ops.factor(blood_factor[1], blood_factor[2]): &#39;&lt;&#39; not meaningful
## for factors

## [1] NA

# 下面比较大小才是有意义的
tshirt &lt;- c(&quot;M&quot;, &quot;L&quot;, &quot;S&quot;, &quot;S&quot;, &quot;L&quot;, &quot;M&quot;, &quot;L&quot;, &quot;M&quot;)
tshirt_factor &lt;- factor(tshirt, ordered = TRUE, 
                          levels = c(&quot;S&quot;, &quot;M&quot;, &quot;L&quot;))
tshirt_factor

## [1] M L S S L M L M
## Levels: S &lt; M &lt; L

tshirt_factor[1] &lt; tshirt_factor[2]

## [1] TRUE</code></pre>
<h1 id="列表-list">列表 List</h1>
<p><em>Vector - Matrix - List</em></p>
<ul>
<li>Vector: 1D, same type</li>
<li>Matrix: 2D, same type</li>
<li>List:
<ul>
<li>Different R objects</li>
<li>No coercion</li>
<li>Loss of some functionality</li>
</ul></li>
</ul>
<h2 id="创建列表-list">创建列表 <code>list()</code></h2>
<pre><code>list(&quot;Rsome times&quot;, 190, 5)

## [[1]]
## [1] &quot;Rsome times&quot;
## 
## [[2]]
## [1] 190
## 
## [[3]]
## [1] 5

song &lt;- list(&quot;Rsome times&quot;, 190, 5)
is.list(song)

## [1] TRUE</code></pre>
<h2 id="命名列表">命名列表</h2>
<pre><code>#1
song &lt;- list(&quot;Rsome times&quot;, 190, 5) 
names(song) &lt;- c(&quot;title&quot;, &quot;duration&quot;, &quot;track&quot;)
song

## $title
## [1] &quot;Rsome times&quot;
## 
## $duration
## [1] 190
## 
## $track
## [1] 5

#2
song &lt;- list(title = &quot;Rsome times&quot;,  
               duration = 190,  
               track = 5)
song

## $title
## [1] &quot;Rsome times&quot;
## 
## $duration
## [1] 190
## 
## $track
## [1] 5

str(song)

## List of 3
##  $ title   : chr &quot;Rsome times&quot;
##  $ duration: num 190
##  $ track   : num 5</code></pre>
<h2 id="列表嵌套">列表嵌套</h2>
<pre><code>similar_song &lt;- list(title = &quot;R you on time?&quot;, 
                       duration = 230)
song &lt;- list(title = &quot;Rsome times&quot;, 
               duration = 190, track = 5,  
               similar = similar_song)
str(song)

## List of 4
##  $ title   : chr &quot;Rsome times&quot;
##  $ duration: num 190
##  $ track   : num 5
##  $ similar :List of 2
##   ..$ title   : chr &quot;R you on time?&quot;
##   ..$ duration: num 230</code></pre>
<h2 id="子集运算-1">子集运算</h2>
<p><code>[</code> versus <code>[[</code></p>
<pre><code>similar_song &lt;- list(title = &quot;R you on time?&quot;, 
                       duration = 230) 
song &lt;- list(title = &quot;Rsome times&quot;, 
               duration = 190, track = 5, 
               similar = similar_song) 
str(song)

## List of 4
##  $ title   : chr &quot;Rsome times&quot;
##  $ duration: num 190
##  $ track   : num 5
##  $ similar :List of 2
##   ..$ title   : chr &quot;R you on time?&quot;
##   ..$ duration: num 230

song[1]

## $title
## [1] &quot;Rsome times&quot;

song[[1]]

## [1] &quot;Rsome times&quot;

song[c(1, 3)] 

## $title
## [1] &quot;Rsome times&quot;
## 
## $track
## [1] 5

#song[[c(1, 3)]] #can&#39;t work
#song[[1]][[3]] #can&#39;t work
song[[&quot;duration&quot;]]

## [1] 190

song[&quot;duration&quot;]

## $duration
## [1] 190

song[c(FALSE, TRUE, TRUE, FALSE)]

## $duration
## [1] 190
## 
## $track
## [1] 5

#song[[c(FALSE, TRUE, TRUE, FALSE)]] # can&#39;t work
#song[[F]][[T]][[T]][[F]] #also

# list in list
song[[4]][[1]]

## [1] &quot;R you on time?&quot;

song[[c(4, 1)]]

## [1] &quot;R you on time?&quot;

song[c(&quot;duration&quot;, &quot;similar&quot;)] 

## $duration
## [1] 190
## 
## $similar
## $similar$title
## [1] &quot;R you on time?&quot;
## 
## $similar$duration
## [1] 230</code></pre>
<p><strong>[[ or [ ?</strong> + [[ to select list <em>element</em> + [ results in <em>sublist</em> + <em>[[ and $</em> to subset and extend lists</p>
<h2 id="列表扩展">列表扩展</h2>
<p>这里引出了R中比较重要的一个符号<code>$</code></p>
<pre><code>similar_song &lt;- list(title = &quot;R you on time?&quot;, 
                       duration = 230) 
song &lt;- list(title = &quot;Rsome times&quot;, 
               duration = 190, track = 5, 
               similar = similar_song) 
#$
song$duration

## [1] 190

#extending
friends &lt;- c(&quot;Kurt&quot;, &quot;Florence&quot;,
                &quot;Patti&quot;, &quot;Dave&quot;)
song$sent &lt;- friends #或者 song[[&quot;sent&quot;]] &lt;- friends
song$similar$reason &lt;- &quot;too long&quot;
song

## $title
## [1] &quot;Rsome times&quot;
## 
## $duration
## [1] 190
## 
## $track
## [1] 5
## 
## $similar
## $similar$title
## [1] &quot;R you on time?&quot;
## 
## $similar$duration
## [1] 230
## 
## $similar$reason
## [1] &quot;too long&quot;
## 
## 
## $sent
## [1] &quot;Kurt&quot;     &quot;Florence&quot; &quot;Patti&quot;    &quot;Dave&quot;</code></pre>
<h1 id="数据框-data-frame">数据框 Data Frame</h1>
<ul>
<li>Observations 观测值</li>
<li>Variables 变量</li>
<li>Example: people
<ul>
<li>each person = observation</li>
<li>properties (name, age …) = variables</li>
</ul></li>
<li>Rows = observations (persons)</li>
<li>Columns = variables (age, name, …)</li>
</ul>
<p>不同的变量的观测值可以类型不同，但是变量自己的所有观测值类型一致。</p>
<p>多在导入数据时使用。</p>
<h2 id="创建数据框">创建数据框</h2>
<pre><code>name &lt;- c(&quot;Anne&quot;, &quot;Pete&quot;, &quot;Frank&quot;, &quot;Julia&quot;, &quot;Cath&quot;) 
age &lt;- c(28, 30, 21, 39, 35) 
child &lt;- c(FALSE, TRUE, TRUE, FALSE, TRUE) 
df &lt;- data.frame(name, age, child) 
str(df)

## &#39;data.frame&#39;:    5 obs. of  3 variables:
##  $ name : Factor w/ 5 levels &quot;Anne&quot;,&quot;Cath&quot;,..: 1 5 3 4 2
##  $ age  : num  28 30 21 39 35
##  $ child: logi  FALSE TRUE TRUE FALSE TRUE</code></pre>
<h2 id="命名数据框">命名数据框</h2>
<pre><code>name &lt;- c(&quot;Anne&quot;, &quot;Pete&quot;, &quot;Frank&quot;, &quot;Julia&quot;, &quot;Cath&quot;) 
age &lt;- c(28, 30, 21, 39, 35) 
child &lt;- c(FALSE, TRUE, TRUE, FALSE, TRUE) 
df &lt;- data.frame(name, age, child)
names(df) &lt;- c(&quot;Name&quot;, &quot;Age&quot;, &quot;Child&quot;) 
str(df)

## &#39;data.frame&#39;:    5 obs. of  3 variables:
##  $ Name : Factor w/ 5 levels &quot;Anne&quot;,&quot;Cath&quot;,..: 1 5 3 4 2
##  $ Age  : num  28 30 21 39 35
##  $ Child: logi  FALSE TRUE TRUE FALSE TRUE

df &lt;- data.frame(Name = name, Age = age, Child = child) #also
str(df)

## &#39;data.frame&#39;:    5 obs. of  3 variables:
##  $ Name : Factor w/ 5 levels &quot;Anne&quot;,&quot;Cath&quot;,..: 1 5 3 4 2
##  $ Age  : num  28 30 21 39 35
##  $ Child: logi  FALSE TRUE TRUE FALSE TRUE</code></pre>
<p>可见，这里的字符串向量，被自动转化为因子类型，所以可以设置参数来避免此隐含行为。</p>
<pre><code>name &lt;- c(&quot;Anne&quot;, &quot;Pete&quot;, &quot;Frank&quot;, &quot;Julia&quot;, &quot;Cath&quot;) 
age &lt;- c(28, 30, 21, 39, 35) 
child &lt;- c(FALSE, TRUE, TRUE, FALSE, TRUE)
df &lt;- data.frame(name, age, child, 
                   stringsAsFactors = FALSE)
str(df)

## &#39;data.frame&#39;:    5 obs. of  3 variables:
##  $ name : chr  &quot;Anne&quot; &quot;Pete&quot; &quot;Frank&quot; &quot;Julia&quot; ...
##  $ age  : num  28 30 21 39 35
##  $ child: logi  FALSE TRUE TRUE FALSE TRUE</code></pre>
<h2 id="子集运算-2">子集运算</h2>
<p>Subset Data Frame * Subsetting syntax from matrices and lists * [ from matrices * [[ and $ from lists</p>
<pre><code>name &lt;- c(&quot;Anne&quot;, &quot;Pete&quot;, &quot;Frank&quot;, &quot;Julia&quot;, &quot;Cath&quot;) 
age &lt;- c(28, 30, 21, 39, 35) 
child &lt;- c(FALSE, TRUE, TRUE, FALSE, TRUE) 
people &lt;- data.frame(name, age, child,  
               stringsAsFactors = FALSE)

# 类似矩阵的操作
people[3,2] 

## [1] 21

people[3,&quot;age&quot;]

## [1] 21

people[,&quot;age&quot;]

## [1] 28 30 21 39 35

people[3,] # 由于返回的是一个数据框，我的R notebook不显示数据框

##    name age child
## 3 Frank  21  TRUE

people[c(3, 5), c(&quot;age&quot;, &quot;child&quot;)] # 同上

##   age child
## 3  21  TRUE
## 5  35  TRUE

# 类似列表的操作
people$age

## [1] 28 30 21 39 35

people[[&quot;age&quot;]]

## [1] 28 30 21 39 35

people[[2]]

## [1] 28 30 21 39 35

## 由于返回的是一个数据框，我的R notebook不显示数据框
people[&quot;age&quot;]

##   age
## 1  28
## 2  30
## 3  21
## 4  39
## 5  35

people[2]

##   age
## 1  28
## 2  30
## 3  21
## 4  39
## 5  35</code></pre>
<h2 id="扩展数据框">扩展数据框</h2>
<p>Extend Data Frame * Add columns = add variables * Add rows = add observations</p>
<pre><code>name &lt;- c(&quot;Anne&quot;, &quot;Pete&quot;, &quot;Frank&quot;, &quot;Julia&quot;, &quot;Cath&quot;) 
age &lt;- c(28, 30, 21, 39, 35) 
child &lt;- c(FALSE, TRUE, TRUE, FALSE, TRUE) 
people &lt;- data.frame(name, age, child,  
               stringsAsFactors = FALSE)
#Add column
height &lt;- c(163, 177, 163, 162, 157) 
people$height &lt;- height 
str(people)

## &#39;data.frame&#39;:    5 obs. of  4 variables:
##  $ name  : chr  &quot;Anne&quot; &quot;Pete&quot; &quot;Frank&quot; &quot;Julia&quot; ...
##  $ age   : num  28 30 21 39 35
##  $ child : logi  FALSE TRUE TRUE FALSE TRUE
##  $ height: num  163 177 163 162 157

##also
people[[&quot;height&quot;]] &lt;- height
str(people)

## &#39;data.frame&#39;:    5 obs. of  4 variables:
##  $ name  : chr  &quot;Anne&quot; &quot;Pete&quot; &quot;Frank&quot; &quot;Julia&quot; ...
##  $ age   : num  28 30 21 39 35
##  $ child : logi  FALSE TRUE TRUE FALSE TRUE
##  $ height: num  163 177 163 162 157

weight &lt;- c(74, 63, 68, 55, 56) 
cbind(people, weight)

##    name age child height weight
## 1  Anne  28 FALSE    163     74
## 2  Pete  30  TRUE    177     63
## 3 Frank  21  TRUE    163     68
## 4 Julia  39 FALSE    162     55
## 5  Cath  35  TRUE    157     56

#Add row 这里要注意，有时候会出错
tom &lt;- data.frame(&quot;Tom&quot;, 37, FALSE, 183)
#rbind(people, tom)
#会报错：
#Error : names do not match previous names
tom &lt;- data.frame(name = &quot;Tom&quot;, age = 37, 
            child = FALSE, height = 183)
rbind(people, tom) 

##    name age child height
## 1  Anne  28 FALSE    163
## 2  Pete  30  TRUE    177
## 3 Frank  21  TRUE    163
## 4 Julia  39 FALSE    162
## 5  Cath  35  TRUE    157
## 6   Tom  37 FALSE    183</code></pre>
<h2 id="排序">排序</h2>
<p>这里主要介绍了<code>sort()</code>与<code>order()</code>，其中，<code>order()</code>更适合用来为数据框调整顺序。</p>
<pre><code>str(people)

## &#39;data.frame&#39;:    5 obs. of  4 variables:
##  $ name  : chr  &quot;Anne&quot; &quot;Pete&quot; &quot;Frank&quot; &quot;Julia&quot; ...
##  $ age   : num  28 30 21 39 35
##  $ child : logi  FALSE TRUE TRUE FALSE TRUE
##  $ height: num  163 177 163 162 157

#sort()直接对于向量元素进行了排序
sort(people$age)

## [1] 21 28 30 35 39

#order()会返回对应大小等级所实际在的位置
ranks &lt;- order(people$age) 
ranks

## [1] 3 1 2 5 4

people$age

## [1] 28 30 21 39 35

people[ranks, ] #直接对行进行了排序

##    name age child height
## 3 Frank  21  TRUE    163
## 1  Anne  28 FALSE    163
## 2  Pete  30  TRUE    177
## 5  Cath  35  TRUE    157
## 4 Julia  39 FALSE    162

#或者如下可以实现降序排序
people[order(people$age, decreasing = TRUE), ] 

##    name age child height
## 4 Julia  39 FALSE    162
## 5  Cath  35  TRUE    157
## 2  Pete  30  TRUE    177
## 1  Anne  28 FALSE    163
## 3 Frank  21  TRUE    163</code></pre>
<h1 id="绘图-graphics">绘图 Graphics</h1>
<p>这里主要介绍了<code>graphics</code>包的<code>plot()</code>与<code>hist()</code></p>
<p><code>plot()</code>会根据不同的数据类型，而画出不同的图像</p>
<ol type="1">
<li>plot() (categorical) 条形图 例如：<code>plot(countries$continent)</code></li>
<li>plot() (numerical) 散点图 例如：<code>plot(countries$population)</code></li>
<li>plot() (2x numerical) 散点图 例如：<code>plot(countries$area, countries$population)</code>、 <code>plot(log(countries$area), log(countries$population))</code></li>
<li>plot() (2x categorical) 某种条形图的变形 例如：<code>plot(countries$continent, countries$religion)</code></li>
</ol>
<p><code>hist()</code>可以绘制直方图 例如： <code>hist(africa$population)</code>、 <code>hist(africa$population, breaks = 10)</code></p>
<p>Other graphics functions * barplot() * boxplot() * pairs()</p>
<h2 id="自定义绘图">自定义绘图</h2>
<p>这里就是修改参数了。无需多讲。</p>
<p>这里，引出了函数<code>par()</code>，这是一个绘图的公共参数<strong>列表</strong>，里面存放着常用的一些绘图的公共属性，可以实现绘制多幅图形时，基本属性的一次性确定。</p>
<p>例如：</p>
<pre><code>par(col = &quot;blue&quot;) 
plot(mercury$temperature, mercury$pressure) </code></pre>
<p>常用的plot的属性有：</p>
<pre><code>plot(mercury$temperature, mercury$pressure, 
       xlab = &quot;Temperature&quot;, 
       ylab = &quot;Pressure&quot;, 
       main = &quot;T vs P for Mercury&quot;, #标题
       type = &quot;o&quot;, 
       col = &quot;orange&quot;, 
       col.main = &quot;darkgray&quot;, 
       cex.axis = 0.6, #cex系列属性表示缩放程度
       lty = 5, #Line Type
       pch = 4  #Plot Symbol
       )
       </code></pre>
<h2 id="多图绘制">多图绘制</h2>
<p><code>mfrow</code>与<code>mfcol</code>参数可以在一个图形框里，用来放置多个图像，区别是，前者是将后面plot语句生成的图像按行填充，而后者是按列填充。</p>
<pre><code>#按行填充
par(mfrow = c(2,2)) 
plot(shop$ads, shop$sales) 
plot(shop$comp, shop$sales) 
plot(shop$inv, shop$sales) 
plot(shop$size_dist, shop$sales)

#按列填充
par(mfcol = c(2,2)) 
plot(shop$ads, shop$sales) 
plot(shop$comp, shop$sales) 
plot(shop$inv, shop$sales) 
plot(shop$size_dist, shop$sales)</code></pre>
<p>Reset the grid</p>
<pre><code>par(mfrow = c(1,1))</code></pre>
<p>相较于这个，<code>layout()</code>函数设置的更为灵活。</p>
<pre><code>grid &lt;- matrix(c(1, 1, 2, 3), nrow = 2, 
         ncol = 2, byrow = TRUE) 
layout(grid)
plot(shop$ads, shop$sales) #放在grid的1号位置
plot(shop$comp, shop$sales) #放在grid的2号位置
plot(shop$inv, shop$sales) #放在grid的3号位置</code></pre>
<p>Reset the grid</p>
<pre><code>layout(1) 
par(mfcol = c(1,1))</code></pre>
<p>Reset all parameters</p>
<pre><code>old_par &lt;- par() 
par(col = &quot;red&quot;) 
plot(shop$ads, shop$sales) 
par(old_par) 
plot(shop$ads, shop$sales)</code></pre>
<h2 id="线性拟合">线性拟合</h2>
<p>引出函数<code>lm()</code> —— <em>linear model</em>，**lm(a~b)就是对a=k*b+c进行线性拟合**</p>
<pre><code>plot(shop$ads, shop$sales, 
      pch = 16, col = 2, 
      xlab = &quot;advertisement&quot;, 
      ylab = &quot;net sales&quot;)
lm_sales &lt;- lm(shop$sales ~ shop$ads)
abline(coef(lm_sales), lwd = 2) #取模型系数，线宽为2，画直线</code></pre>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://plart.pw/langs/chuck/chuck8/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lart Pang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="失乐园">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                
                <a href="/langs/chuck/chuck8/" class="post-title-link" itemprop="https://plart.pw/page/2/index.html">chuck8</a>
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-15 21:40:10" itemprop="dateCreated datePublished" datetime="2018-02-15T21:40:10+08:00">2018-02-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-07-13 20:47:04" itemprop="dateModified" datetime="2018-07-13T20:47:04+08:00">2018-07-13</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/编程与生活/" itemprop="url" rel="index"><span itemprop="name">编程与生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">1.4k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">3 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <p>functions</p>
<pre><code>writing
calling
overloading </code></pre>
<p>#writing</p>
<p>keyword <code>fun</code> (or <code>function</code>) followed by the <em>return type</em> and then <em>the name</em> of the function. After the name of the function parentheses(括号) must be opened to declare the types of the input arguments.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define function call 'funk'</span></span><br><span class="line"><span class="function">fun <span class="keyword">void</span> <span class="title">funk</span><span class="params">( <span class="keyword">int</span> arg )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// insert code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define function 'addOne'</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">addOne</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// result</span></span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>#calling</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define 'hey'</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">hey</span><span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// call the function; store result</span></span><br><span class="line">hey( <span class="number">1</span>, <span class="number">2</span> ) =&gt; <span class="keyword">int</span> result;</span><br></pre></td></tr></table></figure>
<p>You can also use the ChucK operator to call functions!</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// call hey</span></span><br><span class="line">( <span class="number">1</span>, <span class="number">2</span> ) =&gt; hey =&gt; <span class="keyword">int</span> result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// same</span></span><br><span class="line">hey( <span class="number">1</span>, <span class="number">2</span> ) =&gt; <span class="keyword">int</span> result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// several in a row</span></span><br><span class="line">( <span class="number">10</span>, <span class="number">100</span> ) =&gt; Std.rand2 =&gt; Std.mtof =&gt; <span class="keyword">float</span> foo;</span><br><span class="line"></span><br><span class="line"><span class="comment">// same 返回值做参数</span></span><br><span class="line">Std.mtof( Std.rand2( <span class="number">10</span>, <span class="number">100</span> ) ) =&gt; <span class="keyword">float</span> foo;</span><br></pre></td></tr></table></figure>
<p>#overloading</p>
<p>Overloading a function allows functions <em>with the same name</em> to be defined(定义) <em>with different arguments</em>. The function must be written in <strong>separate instances(实例) to handle the input</strong>, and the <strong>return type must agree(一致)</strong>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// funk( int )</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// funk( int, int )</span></span><br><span class="line"><span class="function">fun <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compiler automatically choose the right one to call</span></span><br><span class="line">add( <span class="number">1</span> ) =&gt; <span class="keyword">int</span> foo;</span><br><span class="line">add( <span class="number">1</span>, <span class="number">2</span> ) =&gt; <span class="keyword">int</span> bar;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Lart Pang">
            
              <p class="site-author-name" itemprop="name">Lart Pang</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">58</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">30</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/lartpang" title="GitHub &rarr; https://github.com/lartpang" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:%6C%61%72%74%70%61%6E%67%40%31%36%33%2E%63%6F%6D" title="E-Mail &rarr; mailto:%6C%61%72%74%70%61%6E%67%40%31%36%33%2E%63%6F%6D" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/140jmx" title="Weibo &rarr; https://weibo.com/140jmx" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.csdn.net/p_lart" title="https://blog.csdn.net/p_lart" rel="noopener" target="_blank">csdn</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.jianshu.com/u/f381f4c8dca4" title="https://www.jianshu.com/u/f381f4c8dca4" rel="noopener" target="_blank">简书</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 – <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lart Pang</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
    <span title="站点总字数">356k</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
    <span title="站点阅读时长">10:48</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.5.0</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>












  













  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.5.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  


  
  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('复制成功')
          else $(this).text('复制失败')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>


  

</body>
</html>
